[
  structure_item (lib/shape.ml[16,1080+0]..[64,2398+3])
    Pstr_module
    "Uid" (lib/shape.ml[16,1080+7]..[16,1080+10])
      module_expr (lib/shape.ml[16,1080+13]..[64,2398+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[17,1100+2]..[21,1204+22])
            Pstr_type Rec
            [
              type_declaration "t" (lib/shape.ml[17,1100+7]..[17,1100+8]) (lib/shape.ml[17,1100+2]..[21,1204+22])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (lib/shape.ml[18,1111+4]..[18,1111+32])
                        "Compilation_unit" (lib/shape.ml[18,1111+6]..[18,1111+22])
                        [
                          core_type (lib/shape.ml[18,1111+26]..[18,1111+32])
                            Ptyp_constr "string" (lib/shape.ml[18,1111+26]..[18,1111+32])
                            []
                        ]
                        None
                      (lib/shape.ml[19,1144+4]..[19,1144+44])
                        "Item" (lib/shape.ml[19,1144+6]..[19,1144+10])
                        [
                          (lib/shape.ml[19,1144+16]..[19,1144+34])
                            Immutable
                            "comp_unit" (lib/shape.ml[19,1144+16]..[19,1144+25])                            core_type (lib/shape.ml[19,1144+27]..[19,1144+33])
                              Ptyp_constr "string" (lib/shape.ml[19,1144+27]..[19,1144+33])
                              []
                          (lib/shape.ml[19,1144+35]..[19,1144+42])
                            Immutable
                            "id" (lib/shape.ml[19,1144+35]..[19,1144+37])                            core_type (lib/shape.ml[19,1144+39]..[19,1144+42])
                              Ptyp_constr "int" (lib/shape.ml[19,1144+39]..[19,1144+42])
                              []
                        ]
                        None
                      (lib/shape.ml[20,1189+4]..[20,1189+14])
                        "Internal" (lib/shape.ml[20,1189+6]..[20,1189+14])
                        []
                        None
                      (lib/shape.ml[21,1204+4]..[21,1204+22])
                        "Predef" (lib/shape.ml[21,1204+6]..[21,1204+12])
                        [
                          core_type (lib/shape.ml[21,1204+16]..[21,1204+22])
                            Ptyp_constr "string" (lib/shape.ml[21,1204+16]..[21,1204+22])
                            []
                        ]
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (lib/shape.ml[23,1228+2]..[39,1775+6])
            Pstr_include            module_expr (lib/shape.ml[23,1228+10]..[39,1775+6])
              Pmod_apply
              module_expr (lib/shape.ml[23,1228+10]..[23,1228+27])
                Pmod_ident "Identifiable.Make" (lib/shape.ml[23,1228+10]..[23,1228+27])
              module_expr (lib/shape.ml[23,1228+28]..[39,1775+5])
                Pmod_structure
                [
                  structure_item (lib/shape.ml[24,1263+4]..[24,1263+21])
                    Pstr_type Nonrec
                    [
                      type_declaration "t" (lib/shape.ml[24,1263+16]..[24,1263+17]) (lib/shape.ml[24,1263+4]..[24,1263+21])
                        ptype_params =
                          []
                        ptype_cstrs =
                          []
                        ptype_kind =
                          Ptype_abstract
                        ptype_private = Public
                        ptype_manifest =
                          Some
                            core_type (lib/shape.ml[24,1263+20]..[24,1263+21])
                              Ptyp_constr "t" (lib/shape.ml[24,1263+20]..[24,1263+21])
                              []
                    ]
                  structure_item (lib/shape.ml[26,1286+4]..[26,1286+31])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[26,1286+8]..[26,1286+13])
                          Ppat_var "equal" (lib/shape.ml[26,1286+8]..[26,1286+13])
                        expression (lib/shape.ml[26,1286+14]..[26,1286+31]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[26,1286+14]..[26,1286+21])
                              Nolabel
                              None
                              pattern (lib/shape.ml[26,1286+14]..[26,1286+21])
                                Ppat_constraint
                                pattern (lib/shape.ml[26,1286+15]..[26,1286+16])
                                  Ppat_var "x" (lib/shape.ml[26,1286+15]..[26,1286+16])
                                core_type (lib/shape.ml[26,1286+19]..[26,1286+20])
                                  Ptyp_constr "t" (lib/shape.ml[26,1286+19]..[26,1286+20])
                                  []
                            Pparam_val (lib/shape.ml[26,1286+22]..[26,1286+23])
                              Nolabel
                              None
                              pattern (lib/shape.ml[26,1286+22]..[26,1286+23])
                                Ppat_var "y" (lib/shape.ml[26,1286+22]..[26,1286+23])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[26,1286+26]..[26,1286+31])
                              Pexp_apply
                              expression (lib/shape.ml[26,1286+28]..[26,1286+29])
                                Pexp_ident "=" (lib/shape.ml[26,1286+28]..[26,1286+29])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[26,1286+26]..[26,1286+27])
                                    Pexp_ident "x" (lib/shape.ml[26,1286+26]..[26,1286+27])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[26,1286+30]..[26,1286+31])
                                    Pexp_ident "y" (lib/shape.ml[26,1286+30]..[26,1286+31])
                              ]
                    ]
                  structure_item (lib/shape.ml[27,1318+4]..[27,1318+39])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[27,1318+8]..[27,1318+15])
                          Ppat_var "compare" (lib/shape.ml[27,1318+8]..[27,1318+15])
                        expression (lib/shape.ml[27,1318+16]..[27,1318+39]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[27,1318+16]..[27,1318+23])
                              Nolabel
                              None
                              pattern (lib/shape.ml[27,1318+16]..[27,1318+23])
                                Ppat_constraint
                                pattern (lib/shape.ml[27,1318+17]..[27,1318+18])
                                  Ppat_var "x" (lib/shape.ml[27,1318+17]..[27,1318+18])
                                core_type (lib/shape.ml[27,1318+21]..[27,1318+22])
                                  Ptyp_constr "t" (lib/shape.ml[27,1318+21]..[27,1318+22])
                                  []
                            Pparam_val (lib/shape.ml[27,1318+24]..[27,1318+25])
                              Nolabel
                              None
                              pattern (lib/shape.ml[27,1318+24]..[27,1318+25])
                                Ppat_var "y" (lib/shape.ml[27,1318+24]..[27,1318+25])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[27,1318+28]..[27,1318+39])
                              Pexp_apply
                              expression (lib/shape.ml[27,1318+28]..[27,1318+35])
                                Pexp_ident "compare" (lib/shape.ml[27,1318+28]..[27,1318+35])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[27,1318+36]..[27,1318+37])
                                    Pexp_ident "x" (lib/shape.ml[27,1318+36]..[27,1318+37])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[27,1318+38]..[27,1318+39])
                                    Pexp_ident "y" (lib/shape.ml[27,1318+38]..[27,1318+39])
                              ]
                    ]
                  structure_item (lib/shape.ml[28,1358+4]..[28,1358+37])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[28,1358+8]..[28,1358+12])
                          Ppat_var "hash" (lib/shape.ml[28,1358+8]..[28,1358+12])
                        expression (lib/shape.ml[28,1358+13]..[28,1358+37]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[28,1358+13]..[28,1358+20])
                              Nolabel
                              None
                              pattern (lib/shape.ml[28,1358+13]..[28,1358+20])
                                Ppat_constraint
                                pattern (lib/shape.ml[28,1358+14]..[28,1358+15])
                                  Ppat_var "x" (lib/shape.ml[28,1358+14]..[28,1358+15])
                                core_type (lib/shape.ml[28,1358+18]..[28,1358+19])
                                  Ptyp_constr "t" (lib/shape.ml[28,1358+18]..[28,1358+19])
                                  []
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[28,1358+23]..[28,1358+37])
                              Pexp_apply
                              expression (lib/shape.ml[28,1358+23]..[28,1358+35])
                                Pexp_ident "Hashtbl.hash" (lib/shape.ml[28,1358+23]..[28,1358+35])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[28,1358+36]..[28,1358+37])
                                    Pexp_ident "x" (lib/shape.ml[28,1358+36]..[28,1358+37])
                              ]
                    ]
                  structure_item (lib/shape.ml[30,1397+4]..[34,1606+73])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[30,1397+8]..[30,1397+13])
                          Ppat_var "print" (lib/shape.ml[30,1397+8]..[30,1397+13])
                        expression (lib/shape.ml[30,1397+14]..[34,1606+73]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[30,1397+14]..[30,1397+17])
                              Nolabel
                              None
                              pattern (lib/shape.ml[30,1397+14]..[30,1397+17])
                                Ppat_var "fmt" (lib/shape.ml[30,1397+14]..[30,1397+17])
                          ]
                          None
                          Pfunction_cases (lib/shape.ml[30,1397+20]..[34,1606+73])
                            [
                              <case>
                                pattern (lib/shape.ml[31,1426+8]..[31,1426+16])
                                  Ppat_construct "Internal" (lib/shape.ml[31,1426+8]..[31,1426+16])
                                  None
                                expression (lib/shape.ml[31,1426+20]..[31,1426+59])
                                  Pexp_apply
                                  expression (lib/shape.ml[31,1426+20]..[31,1426+42])
                                    Pexp_ident "Format.pp_print_string" (lib/shape.ml[31,1426+20]..[31,1426+42])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[31,1426+43]..[31,1426+46])
                                        Pexp_ident "fmt" (lib/shape.ml[31,1426+43]..[31,1426+46])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[31,1426+47]..[31,1426+59])
                                        Pexp_constant PConst_string("<internal>",(lib/shape.ml[31,1426+48]..[31,1426+58]),None)
                                  ]
                              <case>
                                pattern (lib/shape.ml[32,1486+8]..[32,1486+19])
                                  Ppat_construct "Predef" (lib/shape.ml[32,1486+8]..[32,1486+14])
                                  Some
                                    []
                                    pattern (lib/shape.ml[32,1486+15]..[32,1486+19])
                                      Ppat_var "name" (lib/shape.ml[32,1486+15]..[32,1486+19])
                                expression (lib/shape.ml[32,1486+23]..[32,1486+60])
                                  Pexp_apply
                                  expression (lib/shape.ml[32,1486+23]..[32,1486+37])
                                    Pexp_ident "Format.fprintf" (lib/shape.ml[32,1486+23]..[32,1486+37])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[32,1486+38]..[32,1486+41])
                                        Pexp_ident "fmt" (lib/shape.ml[32,1486+38]..[32,1486+41])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[32,1486+42]..[32,1486+55])
                                        Pexp_constant PConst_string("<predef:%s>",(lib/shape.ml[32,1486+43]..[32,1486+54]),None)
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[32,1486+56]..[32,1486+60])
                                        Pexp_ident "name" (lib/shape.ml[32,1486+56]..[32,1486+60])
                                  ]
                              <case>
                                pattern (lib/shape.ml[33,1547+8]..[33,1547+26])
                                  Ppat_construct "Compilation_unit" (lib/shape.ml[33,1547+8]..[33,1547+24])
                                  Some
                                    []
                                    pattern (lib/shape.ml[33,1547+25]..[33,1547+26])
                                      Ppat_var "s" (lib/shape.ml[33,1547+25]..[33,1547+26])
                                expression (lib/shape.ml[33,1547+30]..[33,1547+58])
                                  Pexp_apply
                                  expression (lib/shape.ml[33,1547+30]..[33,1547+52])
                                    Pexp_ident "Format.pp_print_string" (lib/shape.ml[33,1547+30]..[33,1547+52])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[33,1547+53]..[33,1547+56])
                                        Pexp_ident "fmt" (lib/shape.ml[33,1547+53]..[33,1547+56])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[33,1547+57]..[33,1547+58])
                                        Pexp_ident "s" (lib/shape.ml[33,1547+57]..[33,1547+58])
                                  ]
                              <case>
                                pattern (lib/shape.ml[34,1606+8]..[34,1606+30])
                                  Ppat_construct "Item" (lib/shape.ml[34,1606+8]..[34,1606+12])
                                  Some
                                    []
                                    pattern (lib/shape.ml[34,1606+13]..[34,1606+30])
                                      Ppat_record Closed
                                      [
                                        "comp_unit" (lib/shape.ml[34,1606+15]..[34,1606+24]) ghost
                                          pattern (lib/shape.ml[34,1606+15]..[34,1606+24])
                                            Ppat_var "comp_unit" (lib/shape.ml[34,1606+15]..[34,1606+24])
                                        "id" (lib/shape.ml[34,1606+26]..[34,1606+28]) ghost
                                          pattern (lib/shape.ml[34,1606+26]..[34,1606+28])
                                            Ppat_var "id" (lib/shape.ml[34,1606+26]..[34,1606+28])
                                      ]
                                expression (lib/shape.ml[34,1606+34]..[34,1606+73])
                                  Pexp_apply
                                  expression (lib/shape.ml[34,1606+34]..[34,1606+48])
                                    Pexp_ident "Format.fprintf" (lib/shape.ml[34,1606+34]..[34,1606+48])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[34,1606+49]..[34,1606+52])
                                        Pexp_ident "fmt" (lib/shape.ml[34,1606+49]..[34,1606+52])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[34,1606+53]..[34,1606+60])
                                        Pexp_constant PConst_string("%s.%d",(lib/shape.ml[34,1606+54]..[34,1606+59]),None)
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[34,1606+61]..[34,1606+70])
                                        Pexp_ident "comp_unit" (lib/shape.ml[34,1606+61]..[34,1606+70])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[34,1606+71]..[34,1606+73])
                                        Pexp_ident "id" (lib/shape.ml[34,1606+71]..[34,1606+73])
                                  ]
                            ]
                    ]
                  structure_item (lib/shape.ml[36,1681+4]..[38,1757+17])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[36,1681+8]..[36,1681+14])
                          Ppat_var "output" (lib/shape.ml[36,1681+8]..[36,1681+14])
                        expression (lib/shape.ml[36,1681+15]..[38,1757+17]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[36,1681+15]..[36,1681+17])
                              Nolabel
                              None
                              pattern (lib/shape.ml[36,1681+15]..[36,1681+17])
                                Ppat_var "oc" (lib/shape.ml[36,1681+15]..[36,1681+17])
                            Pparam_val (lib/shape.ml[36,1681+18]..[36,1681+19])
                              Nolabel
                              None
                              pattern (lib/shape.ml[36,1681+18]..[36,1681+19])
                                Ppat_var "t" (lib/shape.ml[36,1681+18]..[36,1681+19])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[37,1703+6]..[38,1757+17])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[37,1703+10]..[37,1703+13])
                                    Ppat_var "fmt" (lib/shape.ml[37,1703+10]..[37,1703+13])
                                  expression (lib/shape.ml[37,1703+16]..[37,1703+50])
                                    Pexp_apply
                                    expression (lib/shape.ml[37,1703+16]..[37,1703+47])
                                      Pexp_ident "Format.formatter_of_out_channel" (lib/shape.ml[37,1703+16]..[37,1703+47])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[37,1703+48]..[37,1703+50])
                                          Pexp_ident "oc" (lib/shape.ml[37,1703+48]..[37,1703+50])
                                    ]
                              ]
                              expression (lib/shape.ml[38,1757+6]..[38,1757+17])
                                Pexp_apply
                                expression (lib/shape.ml[38,1757+6]..[38,1757+11])
                                  Pexp_ident "print" (lib/shape.ml[38,1757+6]..[38,1757+11])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[38,1757+12]..[38,1757+15])
                                      Pexp_ident "fmt" (lib/shape.ml[38,1757+12]..[38,1757+15])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[38,1757+16]..[38,1757+17])
                                      Pexp_ident "t" (lib/shape.ml[38,1757+16]..[38,1757+17])
                                ]
                    ]
                ]
          structure_item (lib/shape.ml[41,1783+2]..[41,1783+19])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[41,1783+6]..[41,1783+8])
                  Ppat_var "id" (lib/shape.ml[41,1783+6]..[41,1783+8])
                expression (lib/shape.ml[41,1783+11]..[41,1783+19])
                  Pexp_apply
                  expression (lib/shape.ml[41,1783+11]..[41,1783+14])
                    Pexp_ident "ref" (lib/shape.ml[41,1783+11]..[41,1783+14])
                  [
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[41,1783+15]..[41,1783+19])
                        Pexp_constant PConst_int (-1,None)
                  ]
            ]
          structure_item (lib/shape.ml[43,1804+2]..[43,1804+28])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[43,1804+6]..[43,1804+12])
                  Ppat_var "reinit" (lib/shape.ml[43,1804+6]..[43,1804+12])
                expression (lib/shape.ml[43,1804+13]..[43,1804+28]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[43,1804+13]..[43,1804+15])
                      Nolabel
                      None
                      pattern (lib/shape.ml[43,1804+13]..[43,1804+15])
                        Ppat_construct "()" (lib/shape.ml[43,1804+13]..[43,1804+15])
                        None
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[43,1804+18]..[43,1804+28])
                      Pexp_apply
                      expression (lib/shape.ml[43,1804+21]..[43,1804+23])
                        Pexp_ident ":=" (lib/shape.ml[43,1804+21]..[43,1804+23])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[43,1804+18]..[43,1804+20])
                            Pexp_ident "id" (lib/shape.ml[43,1804+18]..[43,1804+20])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[43,1804+24]..[43,1804+28])
                            Pexp_constant PConst_int (-1,None)
                      ]
            ]
          structure_item (lib/shape.ml[45,1834+2]..[47,1875+49])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[45,1834+6]..[45,1834+8])
                  Ppat_var "mk" (lib/shape.ml[45,1834+6]..[45,1834+8])
                expression (lib/shape.ml[45,1834+10]..[47,1875+49]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[45,1834+10]..[45,1834+23])
                      Labelled "current_unit"
                      None
                      pattern (lib/shape.ml[45,1834+11]..[45,1834+23])
                        Ppat_var "current_unit" (lib/shape.ml[45,1834+11]..[45,1834+23])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[46,1860+6]..[47,1875+49])
                      Pexp_sequence
                      expression (lib/shape.ml[46,1860+6]..[46,1860+13])
                        Pexp_apply
                        expression (lib/shape.ml[46,1860+6]..[46,1860+10])
                          Pexp_ident "incr" (lib/shape.ml[46,1860+6]..[46,1860+10])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[46,1860+11]..[46,1860+13])
                              Pexp_ident "id" (lib/shape.ml[46,1860+11]..[46,1860+13])
                        ]
                      expression (lib/shape.ml[47,1875+6]..[47,1875+49])
                        Pexp_construct "Item" (lib/shape.ml[47,1875+6]..[47,1875+10])
                        Some
                          expression (lib/shape.ml[47,1875+11]..[47,1875+49])
                            Pexp_record
                            [
                              "comp_unit" (lib/shape.ml[47,1875+13]..[47,1875+22])
                                expression (lib/shape.ml[47,1875+25]..[47,1875+37])
                                  Pexp_ident "current_unit" (lib/shape.ml[47,1875+25]..[47,1875+37])
                              "id" (lib/shape.ml[47,1875+39]..[47,1875+41])
                                expression (lib/shape.ml[47,1875+44]..[47,1875+47])
                                  Pexp_apply
                                  expression (lib/shape.ml[47,1875+44]..[47,1875+45])
                                    Pexp_ident "!" (lib/shape.ml[47,1875+44]..[47,1875+45])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[47,1875+45]..[47,1875+47])
                                        Pexp_ident "id" (lib/shape.ml[47,1875+45]..[47,1875+47])
                                  ]
                            ]
                            None
            ]
          structure_item (lib/shape.ml[49,1926+2]..[52,2077+36])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[49,1926+6]..[49,1926+28])
                  Ppat_var "of_compilation_unit_id" (lib/shape.ml[49,1926+6]..[49,1926+28])
                expression (lib/shape.ml[49,1926+29]..[52,2077+36]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[49,1926+29]..[49,1926+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[49,1926+29]..[49,1926+31])
                        Ppat_var "id" (lib/shape.ml[49,1926+29]..[49,1926+31])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[50,1960+4]..[52,2077+36])
                      Pexp_sequence
                      expression (lib/shape.ml[50,1960+4]..[51,1998+77])
                        Pexp_ifthenelse
                        expression (lib/shape.ml[50,1960+7]..[50,1960+32])
                          Pexp_apply
                          expression (lib/shape.ml[50,1960+7]..[50,1960+10])
                            Pexp_ident "not" (lib/shape.ml[50,1960+7]..[50,1960+10])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[50,1960+11]..[50,1960+32])
                                Pexp_apply
                                expression (lib/shape.ml[50,1960+12]..[50,1960+28])
                                  Pexp_ident "Ident.persistent" (lib/shape.ml[50,1960+12]..[50,1960+28])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[50,1960+29]..[50,1960+31])
                                      Pexp_ident "id" (lib/shape.ml[50,1960+29]..[50,1960+31])
                                ]
                          ]
                        expression (lib/shape.ml[51,1998+6]..[51,1998+77])
                          Pexp_apply
                          expression (lib/shape.ml[51,1998+6]..[51,1998+23])
                            Pexp_ident "Misc.fatal_errorf" (lib/shape.ml[51,1998+6]..[51,1998+23])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[51,1998+24]..[51,1998+61])
                                Pexp_constant PConst_string("Types.Uid.of_compilation_unit_id %S",(lib/shape.ml[51,1998+25]..[51,1998+60]),None)
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[51,1998+62]..[51,1998+77])
                                Pexp_apply
                                expression (lib/shape.ml[51,1998+63]..[51,1998+73])
                                  Pexp_ident "Ident.name" (lib/shape.ml[51,1998+63]..[51,1998+73])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[51,1998+74]..[51,1998+76])
                                      Pexp_ident "id" (lib/shape.ml[51,1998+74]..[51,1998+76])
                                ]
                          ]
                        None
                      expression (lib/shape.ml[52,2077+4]..[52,2077+36])
                        Pexp_construct "Compilation_unit" (lib/shape.ml[52,2077+4]..[52,2077+20])
                        Some
                          expression (lib/shape.ml[52,2077+21]..[52,2077+36])
                            Pexp_apply
                            expression (lib/shape.ml[52,2077+22]..[52,2077+32])
                              Pexp_ident "Ident.name" (lib/shape.ml[52,2077+22]..[52,2077+32])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[52,2077+33]..[52,2077+35])
                                  Pexp_ident "id" (lib/shape.ml[52,2077+33]..[52,2077+35])
                            ]
            ]
          structure_item (lib/shape.ml[54,2115+2]..[57,2245+26])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[54,2115+6]..[54,2115+18])
                  Ppat_var "of_predef_id" (lib/shape.ml[54,2115+6]..[54,2115+18])
                expression (lib/shape.ml[54,2115+19]..[57,2245+26]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[54,2115+19]..[54,2115+21])
                      Nolabel
                      None
                      pattern (lib/shape.ml[54,2115+19]..[54,2115+21])
                        Ppat_var "id" (lib/shape.ml[54,2115+19]..[54,2115+21])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[55,2139+4]..[57,2245+26])
                      Pexp_sequence
                      expression (lib/shape.ml[55,2139+4]..[56,2176+67])
                        Pexp_ifthenelse
                        expression (lib/shape.ml[55,2139+7]..[55,2139+31])
                          Pexp_apply
                          expression (lib/shape.ml[55,2139+7]..[55,2139+10])
                            Pexp_ident "not" (lib/shape.ml[55,2139+7]..[55,2139+10])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[55,2139+11]..[55,2139+31])
                                Pexp_apply
                                expression (lib/shape.ml[55,2139+12]..[55,2139+27])
                                  Pexp_ident "Ident.is_predef" (lib/shape.ml[55,2139+12]..[55,2139+27])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[55,2139+28]..[55,2139+30])
                                      Pexp_ident "id" (lib/shape.ml[55,2139+28]..[55,2139+30])
                                ]
                          ]
                        expression (lib/shape.ml[56,2176+6]..[56,2176+67])
                          Pexp_apply
                          expression (lib/shape.ml[56,2176+6]..[56,2176+23])
                            Pexp_ident "Misc.fatal_errorf" (lib/shape.ml[56,2176+6]..[56,2176+23])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[56,2176+24]..[56,2176+51])
                                Pexp_constant PConst_string("Types.Uid.of_predef_id %S",(lib/shape.ml[56,2176+25]..[56,2176+50]),None)
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[56,2176+52]..[56,2176+67])
                                Pexp_apply
                                expression (lib/shape.ml[56,2176+53]..[56,2176+63])
                                  Pexp_ident "Ident.name" (lib/shape.ml[56,2176+53]..[56,2176+63])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[56,2176+64]..[56,2176+66])
                                      Pexp_ident "id" (lib/shape.ml[56,2176+64]..[56,2176+66])
                                ]
                          ]
                        None
                      expression (lib/shape.ml[57,2245+4]..[57,2245+26])
                        Pexp_construct "Predef" (lib/shape.ml[57,2245+4]..[57,2245+10])
                        Some
                          expression (lib/shape.ml[57,2245+11]..[57,2245+26])
                            Pexp_apply
                            expression (lib/shape.ml[57,2245+12]..[57,2245+22])
                              Pexp_ident "Ident.name" (lib/shape.ml[57,2245+12]..[57,2245+22])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[57,2245+23]..[57,2245+25])
                                  Pexp_ident "id" (lib/shape.ml[57,2245+23]..[57,2245+25])
                            ]
            ]
          structure_item (lib/shape.ml[59,2273+2]..[59,2273+45])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[59,2273+6]..[59,2273+34])
                  Ppat_var "internal_not_actually_unique" (lib/shape.ml[59,2273+6]..[59,2273+34])
                expression (lib/shape.ml[59,2273+37]..[59,2273+45])
                  Pexp_construct "Internal" (lib/shape.ml[59,2273+37]..[59,2273+45])
                  None
            ]
          structure_item (lib/shape.ml[61,2320+2]..[63,2381+16])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[61,2320+6]..[61,2320+28])
                  Ppat_var "for_actual_declaration" (lib/shape.ml[61,2320+6]..[61,2320+28])
                expression (lib/shape.ml[61,2320+31]..[63,2381+16])
                  Pexp_function
                  []
                  None
                  Pfunction_cases (lib/shape.ml[61,2320+31]..[63,2381+16])
                    [
                      <case>
                        pattern (lib/shape.ml[62,2360+6]..[62,2360+12])
                          Ppat_construct "Item" (lib/shape.ml[62,2360+6]..[62,2360+10])
                          Some
                            []
                            pattern (lib/shape.ml[62,2360+11]..[62,2360+12])
                              Ppat_any
                        expression (lib/shape.ml[62,2360+16]..[62,2360+20])
                          Pexp_construct "true" (lib/shape.ml[62,2360+16]..[62,2360+20])
                          None
                      <case>
                        pattern (lib/shape.ml[63,2381+6]..[63,2381+7])
                          Ppat_any
                        expression (lib/shape.ml[63,2381+11]..[63,2381+16])
                          Pexp_construct "false" (lib/shape.ml[63,2381+11]..[63,2381+16])
                          None
                    ]
            ]
        ]
  structure_item (lib/shape.ml[66,2403+0]..[95,2985+3])
    Pstr_module
    "Sig_component_kind" (lib/shape.ml[66,2403+7]..[66,2403+25])
      module_expr (lib/shape.ml[66,2403+28]..[95,2985+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[67,2438+2]..[74,2543+16])
            Pstr_type Rec
            [
              type_declaration "t" (lib/shape.ml[67,2438+7]..[67,2438+8]) (lib/shape.ml[67,2438+2]..[74,2543+16])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (lib/shape.ml[68,2449+4]..[68,2449+11])
                        "Value" (lib/shape.ml[68,2449+6]..[68,2449+11])
                        []
                        None
                      (lib/shape.ml[69,2461+4]..[69,2461+10])
                        "Type" (lib/shape.ml[69,2461+6]..[69,2461+10])
                        []
                        None
                      (lib/shape.ml[70,2472+4]..[70,2472+12])
                        "Module" (lib/shape.ml[70,2472+6]..[70,2472+12])
                        []
                        None
                      (lib/shape.ml[71,2485+4]..[71,2485+17])
                        "Module_type" (lib/shape.ml[71,2485+6]..[71,2485+17])
                        []
                        None
                      (lib/shape.ml[72,2503+4]..[72,2503+27])
                        "Extension_constructor" (lib/shape.ml[72,2503+6]..[72,2503+27])
                        []
                        None
                      (lib/shape.ml[73,2531+4]..[73,2531+11])
                        "Class" (lib/shape.ml[73,2531+6]..[73,2531+11])
                        []
                        None
                      (lib/shape.ml[74,2543+4]..[74,2543+16])
                        "Class_type" (lib/shape.ml[74,2543+6]..[74,2543+16])
                        []
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (lib/shape.ml[76,2561+2]..[83,2770+32])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[76,2561+6]..[76,2561+15])
                  Ppat_var "to_string" (lib/shape.ml[76,2561+6]..[76,2561+15])
                expression (lib/shape.ml[76,2561+18]..[83,2770+32])
                  Pexp_function
                  []
                  None
                  Pfunction_cases (lib/shape.ml[76,2561+18]..[83,2770+32])
                    [
                      <case>
                        pattern (lib/shape.ml[77,2588+6]..[77,2588+11])
                          Ppat_construct "Value" (lib/shape.ml[77,2588+6]..[77,2588+11])
                          None
                        expression (lib/shape.ml[77,2588+15]..[77,2588+22])
                          Pexp_constant PConst_string("value",(lib/shape.ml[77,2588+16]..[77,2588+21]),None)
                      <case>
                        pattern (lib/shape.ml[78,2611+6]..[78,2611+10])
                          Ppat_construct "Type" (lib/shape.ml[78,2611+6]..[78,2611+10])
                          None
                        expression (lib/shape.ml[78,2611+14]..[78,2611+20])
                          Pexp_constant PConst_string("type",(lib/shape.ml[78,2611+15]..[78,2611+19]),None)
                      <case>
                        pattern (lib/shape.ml[79,2632+6]..[79,2632+12])
                          Ppat_construct "Module" (lib/shape.ml[79,2632+6]..[79,2632+12])
                          None
                        expression (lib/shape.ml[79,2632+16]..[79,2632+24])
                          Pexp_constant PConst_string("module",(lib/shape.ml[79,2632+17]..[79,2632+23]),None)
                      <case>
                        pattern (lib/shape.ml[80,2657+6]..[80,2657+17])
                          Ppat_construct "Module_type" (lib/shape.ml[80,2657+6]..[80,2657+17])
                          None
                        expression (lib/shape.ml[80,2657+21]..[80,2657+34])
                          Pexp_constant PConst_string("module type",(lib/shape.ml[80,2657+22]..[80,2657+33]),None)
                      <case>
                        pattern (lib/shape.ml[81,2692+6]..[81,2692+27])
                          Ppat_construct "Extension_constructor" (lib/shape.ml[81,2692+6]..[81,2692+27])
                          None
                        expression (lib/shape.ml[81,2692+31]..[81,2692+54])
                          Pexp_constant PConst_string("extension constructor",(lib/shape.ml[81,2692+32]..[81,2692+53]),None)
                      <case>
                        pattern (lib/shape.ml[82,2747+6]..[82,2747+11])
                          Ppat_construct "Class" (lib/shape.ml[82,2747+6]..[82,2747+11])
                          None
                        expression (lib/shape.ml[82,2747+15]..[82,2747+22])
                          Pexp_constant PConst_string("class",(lib/shape.ml[82,2747+16]..[82,2747+21]),None)
                      <case>
                        pattern (lib/shape.ml[83,2770+6]..[83,2770+16])
                          Ppat_construct "Class_type" (lib/shape.ml[83,2770+6]..[83,2770+16])
                          None
                        expression (lib/shape.ml[83,2770+20]..[83,2770+32])
                          Pexp_constant PConst_string("class type",(lib/shape.ml[83,2770+21]..[83,2770+31]),None)
                    ]
            ]
          structure_item (lib/shape.ml[85,2804+2]..[94,2972+12])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[85,2804+6]..[85,2804+25])
                  Ppat_var "can_appear_in_types" (lib/shape.ml[85,2804+6]..[85,2804+25])
                expression (lib/shape.ml[85,2804+28]..[94,2972+12])
                  Pexp_function
                  []
                  None
                  Pfunction_cases (lib/shape.ml[85,2804+28]..[94,2972+12])
                    [
                      <case>
                        pattern (lib/shape.ml[86,2841+6]..[87,2853+27])
                          Ppat_or
                          pattern (lib/shape.ml[86,2841+6]..[86,2841+11])
                            Ppat_construct "Value" (lib/shape.ml[86,2841+6]..[86,2841+11])
                            None
                          pattern (lib/shape.ml[87,2853+6]..[87,2853+27])
                            Ppat_construct "Extension_constructor" (lib/shape.ml[87,2853+6]..[87,2853+27])
                            None
                        expression (lib/shape.ml[88,2884+8]..[88,2884+13])
                          Pexp_construct "false" (lib/shape.ml[88,2884+8]..[88,2884+13])
                          None
                      <case>
                        pattern (lib/shape.ml[89,2898+6]..[93,2952+16])
                          Ppat_or
                          pattern (lib/shape.ml[89,2898+6]..[92,2940+11])
                            Ppat_or
                            pattern (lib/shape.ml[89,2898+6]..[91,2922+17])
                              Ppat_or
                              pattern (lib/shape.ml[89,2898+6]..[90,2909+12])
                                Ppat_or
                                pattern (lib/shape.ml[89,2898+6]..[89,2898+10])
                                  Ppat_construct "Type" (lib/shape.ml[89,2898+6]..[89,2898+10])
                                  None
                                pattern (lib/shape.ml[90,2909+6]..[90,2909+12])
                                  Ppat_construct "Module" (lib/shape.ml[90,2909+6]..[90,2909+12])
                                  None
                              pattern (lib/shape.ml[91,2922+6]..[91,2922+17])
                                Ppat_construct "Module_type" (lib/shape.ml[91,2922+6]..[91,2922+17])
                                None
                            pattern (lib/shape.ml[92,2940+6]..[92,2940+11])
                              Ppat_construct "Class" (lib/shape.ml[92,2940+6]..[92,2940+11])
                              None
                          pattern (lib/shape.ml[93,2952+6]..[93,2952+16])
                            Ppat_construct "Class_type" (lib/shape.ml[93,2952+6]..[93,2952+16])
                            None
                        expression (lib/shape.ml[94,2972+8]..[94,2972+12])
                          Pexp_construct "true" (lib/shape.ml[94,2972+8]..[94,2972+12])
                          None
                    ]
            ]
        ]
  structure_item (lib/shape.ml[97,2990+0]..[124,3788+3])
    Pstr_module
    "Item" (lib/shape.ml[97,2990+7]..[97,2990+11])
      module_expr (lib/shape.ml[97,2990+14]..[124,3788+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[98,3011+2]..[119,3741+5])
            Pstr_module
            "T" (lib/shape.ml[98,3011+9]..[98,3011+10])
              module_expr (lib/shape.ml[98,3011+13]..[119,3741+5])
                Pmod_structure
                [
                  structure_item (lib/shape.ml[99,3031+4]..[99,3031+42])
                    Pstr_type Rec
                    [
                      type_declaration "t" (lib/shape.ml[99,3031+9]..[99,3031+10]) (lib/shape.ml[99,3031+4]..[99,3031+42])
                        ptype_params =
                          []
                        ptype_cstrs =
                          []
                        ptype_kind =
                          Ptype_abstract
                        ptype_private = Public
                        ptype_manifest =
                          Some
                            core_type (lib/shape.ml[99,3031+13]..[99,3031+42])
                              Ptyp_tuple
                              [
                                core_type (lib/shape.ml[99,3031+13]..[99,3031+19])
                                  Ptyp_constr "string" (lib/shape.ml[99,3031+13]..[99,3031+19])
                                  []
                                core_type (lib/shape.ml[99,3031+22]..[99,3031+42])
                                  Ptyp_constr "Sig_component_kind.t" (lib/shape.ml[99,3031+22]..[99,3031+42])
                                  []
                              ]
                    ]
                  structure_item (lib/shape.ml[100,3074+4]..[100,3074+25])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[100,3074+8]..[100,3074+15])
                          Ppat_var "compare" (lib/shape.ml[100,3074+8]..[100,3074+15])
                        expression (lib/shape.ml[100,3074+18]..[100,3074+25])
                          Pexp_ident "compare" (lib/shape.ml[100,3074+18]..[100,3074+25])
                    ]
                  structure_item (lib/shape.ml[102,3101+4]..[102,3101+29])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[102,3101+8]..[102,3101+12])
                          Ppat_var "make" (lib/shape.ml[102,3101+8]..[102,3101+12])
                        expression (lib/shape.ml[102,3101+13]..[102,3101+29]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[102,3101+13]..[102,3101+16])
                              Nolabel
                              None
                              pattern (lib/shape.ml[102,3101+13]..[102,3101+16])
                                Ppat_var "str" (lib/shape.ml[102,3101+13]..[102,3101+16])
                            Pparam_val (lib/shape.ml[102,3101+17]..[102,3101+19])
                              Nolabel
                              None
                              pattern (lib/shape.ml[102,3101+17]..[102,3101+19])
                                Ppat_var "ns" (lib/shape.ml[102,3101+17]..[102,3101+19])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[102,3101+22]..[102,3101+29])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[102,3101+22]..[102,3101+25])
                                  Pexp_ident "str" (lib/shape.ml[102,3101+22]..[102,3101+25])
                                expression (lib/shape.ml[102,3101+27]..[102,3101+29])
                                  Pexp_ident "ns" (lib/shape.ml[102,3101+27]..[102,3101+29])
                              ]
                    ]
                  structure_item (lib/shape.ml[104,3132+4]..[104,3132+58])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[104,3132+8]..[104,3132+13])
                          Ppat_var "value" (lib/shape.ml[104,3132+8]..[104,3132+13])
                        expression (lib/shape.ml[104,3132+14]..[104,3132+58]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[104,3132+14]..[104,3132+16])
                              Nolabel
                              None
                              pattern (lib/shape.ml[104,3132+14]..[104,3132+16])
                                Ppat_var "id" (lib/shape.ml[104,3132+14]..[104,3132+16])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[104,3132+19]..[104,3132+58])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[104,3132+19]..[104,3132+32])
                                  Pexp_apply
                                  expression (lib/shape.ml[104,3132+19]..[104,3132+29])
                                    Pexp_ident "Ident.name" (lib/shape.ml[104,3132+19]..[104,3132+29])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[104,3132+30]..[104,3132+32])
                                        Pexp_ident "id" (lib/shape.ml[104,3132+30]..[104,3132+32])
                                  ]
                                expression (lib/shape.ml[104,3132+34]..[104,3132+58])
                                  Pexp_construct "Sig_component_kind.Value" (lib/shape.ml[104,3132+34]..[104,3132+58])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[105,3191+4]..[105,3191+57])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[105,3191+8]..[105,3191+13])
                          Ppat_var "type_" (lib/shape.ml[105,3191+8]..[105,3191+13])
                        expression (lib/shape.ml[105,3191+14]..[105,3191+57]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[105,3191+14]..[105,3191+16])
                              Nolabel
                              None
                              pattern (lib/shape.ml[105,3191+14]..[105,3191+16])
                                Ppat_var "id" (lib/shape.ml[105,3191+14]..[105,3191+16])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[105,3191+19]..[105,3191+57])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[105,3191+19]..[105,3191+32])
                                  Pexp_apply
                                  expression (lib/shape.ml[105,3191+19]..[105,3191+29])
                                    Pexp_ident "Ident.name" (lib/shape.ml[105,3191+19]..[105,3191+29])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[105,3191+30]..[105,3191+32])
                                        Pexp_ident "id" (lib/shape.ml[105,3191+30]..[105,3191+32])
                                  ]
                                expression (lib/shape.ml[105,3191+34]..[105,3191+57])
                                  Pexp_construct "Sig_component_kind.Type" (lib/shape.ml[105,3191+34]..[105,3191+57])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[106,3249+4]..[106,3249+61])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[106,3249+8]..[106,3249+15])
                          Ppat_var "module_" (lib/shape.ml[106,3249+8]..[106,3249+15])
                        expression (lib/shape.ml[106,3249+16]..[106,3249+61]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[106,3249+16]..[106,3249+18])
                              Nolabel
                              None
                              pattern (lib/shape.ml[106,3249+16]..[106,3249+18])
                                Ppat_var "id" (lib/shape.ml[106,3249+16]..[106,3249+18])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[106,3249+21]..[106,3249+61])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[106,3249+21]..[106,3249+34])
                                  Pexp_apply
                                  expression (lib/shape.ml[106,3249+21]..[106,3249+31])
                                    Pexp_ident "Ident.name" (lib/shape.ml[106,3249+21]..[106,3249+31])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[106,3249+32]..[106,3249+34])
                                        Pexp_ident "id" (lib/shape.ml[106,3249+32]..[106,3249+34])
                                  ]
                                expression (lib/shape.ml[106,3249+36]..[106,3249+61])
                                  Pexp_construct "Sig_component_kind.Module" (lib/shape.ml[106,3249+36]..[106,3249+61])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[107,3311+4]..[107,3311+70])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[107,3311+8]..[107,3311+19])
                          Ppat_var "module_type" (lib/shape.ml[107,3311+8]..[107,3311+19])
                        expression (lib/shape.ml[107,3311+20]..[107,3311+70]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[107,3311+20]..[107,3311+22])
                              Nolabel
                              None
                              pattern (lib/shape.ml[107,3311+20]..[107,3311+22])
                                Ppat_var "id" (lib/shape.ml[107,3311+20]..[107,3311+22])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[107,3311+25]..[107,3311+70])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[107,3311+25]..[107,3311+38])
                                  Pexp_apply
                                  expression (lib/shape.ml[107,3311+25]..[107,3311+35])
                                    Pexp_ident "Ident.name" (lib/shape.ml[107,3311+25]..[107,3311+35])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[107,3311+36]..[107,3311+38])
                                        Pexp_ident "id" (lib/shape.ml[107,3311+36]..[107,3311+38])
                                  ]
                                expression (lib/shape.ml[107,3311+40]..[107,3311+70])
                                  Pexp_construct "Sig_component_kind.Module_type" (lib/shape.ml[107,3311+40]..[107,3311+70])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[108,3382+4]..[109,3417+61])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[108,3382+8]..[108,3382+29])
                          Ppat_var "extension_constructor" (lib/shape.ml[108,3382+8]..[108,3382+29])
                        expression (lib/shape.ml[108,3382+30]..[109,3417+61]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[108,3382+30]..[108,3382+32])
                              Nolabel
                              None
                              pattern (lib/shape.ml[108,3382+30]..[108,3382+32])
                                Ppat_var "id" (lib/shape.ml[108,3382+30]..[108,3382+32])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[109,3417+6]..[109,3417+61])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[109,3417+6]..[109,3417+19])
                                  Pexp_apply
                                  expression (lib/shape.ml[109,3417+6]..[109,3417+16])
                                    Pexp_ident "Ident.name" (lib/shape.ml[109,3417+6]..[109,3417+16])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[109,3417+17]..[109,3417+19])
                                        Pexp_ident "id" (lib/shape.ml[109,3417+17]..[109,3417+19])
                                  ]
                                expression (lib/shape.ml[109,3417+21]..[109,3417+61])
                                  Pexp_construct "Sig_component_kind.Extension_constructor" (lib/shape.ml[109,3417+21]..[109,3417+61])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[110,3479+4]..[111,3499+45])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[110,3479+8]..[110,3479+14])
                          Ppat_var "class_" (lib/shape.ml[110,3479+8]..[110,3479+14])
                        expression (lib/shape.ml[110,3479+15]..[111,3499+45]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[110,3479+15]..[110,3479+17])
                              Nolabel
                              None
                              pattern (lib/shape.ml[110,3479+15]..[110,3479+17])
                                Ppat_var "id" (lib/shape.ml[110,3479+15]..[110,3479+17])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[111,3499+6]..[111,3499+45])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[111,3499+6]..[111,3499+19])
                                  Pexp_apply
                                  expression (lib/shape.ml[111,3499+6]..[111,3499+16])
                                    Pexp_ident "Ident.name" (lib/shape.ml[111,3499+6]..[111,3499+16])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[111,3499+17]..[111,3499+19])
                                        Pexp_ident "id" (lib/shape.ml[111,3499+17]..[111,3499+19])
                                  ]
                                expression (lib/shape.ml[111,3499+21]..[111,3499+45])
                                  Pexp_construct "Sig_component_kind.Class" (lib/shape.ml[111,3499+21]..[111,3499+45])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[112,3545+4]..[113,3569+50])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[112,3545+8]..[112,3545+18])
                          Ppat_var "class_type" (lib/shape.ml[112,3545+8]..[112,3545+18])
                        expression (lib/shape.ml[112,3545+19]..[113,3569+50]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[112,3545+19]..[112,3545+21])
                              Nolabel
                              None
                              pattern (lib/shape.ml[112,3545+19]..[112,3545+21])
                                Ppat_var "id" (lib/shape.ml[112,3545+19]..[112,3545+21])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[113,3569+6]..[113,3569+50])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[113,3569+6]..[113,3569+19])
                                  Pexp_apply
                                  expression (lib/shape.ml[113,3569+6]..[113,3569+16])
                                    Pexp_ident "Ident.name" (lib/shape.ml[113,3569+6]..[113,3569+16])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[113,3569+17]..[113,3569+19])
                                        Pexp_ident "id" (lib/shape.ml[113,3569+17]..[113,3569+19])
                                  ]
                                expression (lib/shape.ml[113,3569+21]..[113,3569+50])
                                  Pexp_construct "Sig_component_kind.Class_type" (lib/shape.ml[113,3569+21]..[113,3569+50])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[115,3621+4]..[118,3699+41])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[115,3621+8]..[115,3621+13])
                          Ppat_var "print" (lib/shape.ml[115,3621+8]..[115,3621+13])
                        expression (lib/shape.ml[115,3621+14]..[118,3699+41]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[115,3621+14]..[115,3621+17])
                              Nolabel
                              None
                              pattern (lib/shape.ml[115,3621+14]..[115,3621+17])
                                Ppat_var "fmt" (lib/shape.ml[115,3621+14]..[115,3621+17])
                            Pparam_val (lib/shape.ml[115,3621+18]..[115,3621+28])
                              Nolabel
                              None
                              pattern (lib/shape.ml[115,3621+18]..[115,3621+28])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[115,3621+19]..[115,3621+23])
                                    Ppat_var "name" (lib/shape.ml[115,3621+19]..[115,3621+23])
                                  pattern (lib/shape.ml[115,3621+25]..[115,3621+27])
                                    Ppat_var "ns" (lib/shape.ml[115,3621+25]..[115,3621+27])
                                ]
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[116,3652+6]..[118,3699+41])
                              Pexp_apply
                              expression (lib/shape.ml[116,3652+6]..[116,3652+20])
                                Pexp_ident "Format.fprintf" (lib/shape.ml[116,3652+6]..[116,3652+20])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[116,3652+21]..[116,3652+24])
                                    Pexp_ident "fmt" (lib/shape.ml[116,3652+21]..[116,3652+24])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[116,3652+25]..[116,3652+33])
                                    Pexp_constant PConst_string("%S[%s]",(lib/shape.ml[116,3652+26]..[116,3652+32]),None)
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[117,3686+8]..[117,3686+12])
                                    Pexp_ident "name" (lib/shape.ml[117,3686+8]..[117,3686+12])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[118,3699+8]..[118,3699+41])
                                    Pexp_apply
                                    expression (lib/shape.ml[118,3699+9]..[118,3699+37])
                                      Pexp_ident "Sig_component_kind.to_string" (lib/shape.ml[118,3699+9]..[118,3699+37])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[118,3699+38]..[118,3699+40])
                                          Pexp_ident "ns" (lib/shape.ml[118,3699+38]..[118,3699+40])
                                    ]
                              ]
                    ]
                ]
          structure_item (lib/shape.ml[121,3748+2]..[121,3748+11])
            Pstr_include            module_expr (lib/shape.ml[121,3748+10]..[121,3748+11])
              Pmod_ident "T" (lib/shape.ml[121,3748+10]..[121,3748+11])
          structure_item (lib/shape.ml[123,3761+2]..[123,3761+26])
            Pstr_module
            "Map" (lib/shape.ml[123,3761+9]..[123,3761+12])
              module_expr (lib/shape.ml[123,3761+15]..[123,3761+26])
                Pmod_apply
                module_expr (lib/shape.ml[123,3761+15]..[123,3761+23])
                  Pmod_ident "Map.Make" (lib/shape.ml[123,3761+15]..[123,3761+23])
                module_expr (lib/shape.ml[123,3761+24]..[123,3761+25])
                  Pmod_ident "T" (lib/shape.ml[123,3761+24]..[123,3761+25])
        ]
  structure_item (lib/shape.ml[126,3793+0]..[126,3793+18])
    Pstr_type Rec
    [
      type_declaration "var" (lib/shape.ml[126,3793+5]..[126,3793+8]) (lib/shape.ml[126,3793+0]..[126,3793+18])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (lib/shape.ml[126,3793+11]..[126,3793+18])
              Ptyp_constr "Ident.t" (lib/shape.ml[126,3793+11]..[126,3793+18])
              []
    ]
  structure_item (lib/shape.ml[127,3812+0]..[135,3976+23])
    Pstr_type Rec
    [
      type_declaration "t" (lib/shape.ml[127,3812+5]..[127,3812+6]) (lib/shape.ml[127,3812+0]..[127,3812+42])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (lib/shape.ml[127,3812+11]..[127,3812+29])
                Immutable
                "uid" (lib/shape.ml[127,3812+11]..[127,3812+14])                core_type (lib/shape.ml[127,3812+16]..[127,3812+28])
                  Ptyp_constr "option" (lib/shape.ml[127,3812+22]..[127,3812+28])
                  [
                    core_type (lib/shape.ml[127,3812+16]..[127,3812+21])
                      Ptyp_constr "Uid.t" (lib/shape.ml[127,3812+16]..[127,3812+21])
                      []
                  ]
              (lib/shape.ml[127,3812+30]..[127,3812+40])
                Immutable
                "desc" (lib/shape.ml[127,3812+30]..[127,3812+34])                core_type (lib/shape.ml[127,3812+36]..[127,3812+40])
                  Ptyp_constr "desc" (lib/shape.ml[127,3812+36]..[127,3812+40])
                  []
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "desc" (lib/shape.ml[128,3855+4]..[128,3855+8]) (lib/shape.ml[128,3855+0]..[135,3976+23])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (lib/shape.ml[129,3866+2]..[129,3866+14])
                "Var" (lib/shape.ml[129,3866+4]..[129,3866+7])
                [
                  core_type (lib/shape.ml[129,3866+11]..[129,3866+14])
                    Ptyp_constr "var" (lib/shape.ml[129,3866+11]..[129,3866+14])
                    []
                ]
                None
              (lib/shape.ml[130,3881+2]..[130,3881+18])
                "Abs" (lib/shape.ml[130,3881+4]..[130,3881+7])
                [
                  core_type (lib/shape.ml[130,3881+11]..[130,3881+14])
                    Ptyp_constr "var" (lib/shape.ml[130,3881+11]..[130,3881+14])
                    []
                  core_type (lib/shape.ml[130,3881+17]..[130,3881+18])
                    Ptyp_constr "t" (lib/shape.ml[130,3881+17]..[130,3881+18])
                    []
                ]
                None
              (lib/shape.ml[131,3900+2]..[131,3900+16])
                "App" (lib/shape.ml[131,3900+4]..[131,3900+7])
                [
                  core_type (lib/shape.ml[131,3900+11]..[131,3900+12])
                    Ptyp_constr "t" (lib/shape.ml[131,3900+11]..[131,3900+12])
                    []
                  core_type (lib/shape.ml[131,3900+15]..[131,3900+16])
                    Ptyp_constr "t" (lib/shape.ml[131,3900+15]..[131,3900+16])
                    []
                ]
                None
              (lib/shape.ml[132,3917+2]..[132,3917+26])
                "Struct" (lib/shape.ml[132,3917+4]..[132,3917+10])
                [
                  core_type (lib/shape.ml[132,3917+14]..[132,3917+26])
                    Ptyp_constr "Item.Map.t" (lib/shape.ml[132,3917+16]..[132,3917+26])
                    [
                      core_type (lib/shape.ml[132,3917+14]..[132,3917+15])
                        Ptyp_constr "t" (lib/shape.ml[132,3917+14]..[132,3917+15])
                        []
                    ]
                ]
                None
              (lib/shape.ml[133,3944+2]..[133,3944+8])
                "Leaf" (lib/shape.ml[133,3944+4]..[133,3944+8])
                []
                None
              (lib/shape.ml[134,3953+2]..[134,3953+22])
                "Proj" (lib/shape.ml[134,3953+4]..[134,3953+8])
                [
                  core_type (lib/shape.ml[134,3953+12]..[134,3953+13])
                    Ptyp_constr "t" (lib/shape.ml[134,3953+12]..[134,3953+13])
                    []
                  core_type (lib/shape.ml[134,3953+16]..[134,3953+22])
                    Ptyp_constr "Item.t" (lib/shape.ml[134,3953+16]..[134,3953+22])
                    []
                ]
                None
              (lib/shape.ml[135,3976+2]..[135,3976+23])
                "Comp_unit" (lib/shape.ml[135,3976+4]..[135,3976+13])
                [
                  core_type (lib/shape.ml[135,3976+17]..[135,3976+23])
                    Ptyp_constr "string" (lib/shape.ml[135,3976+17]..[135,3976+23])
                    []
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (lib/shape.ml[137,4001+0]..[188,5738+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[137,4001+4]..[137,4001+9])
          Ppat_var "print" (lib/shape.ml[137,4001+4]..[137,4001+9])
        expression (lib/shape.ml[137,4001+10]..[188,5738+34]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[137,4001+10]..[137,4001+13])
              Nolabel
              None
              pattern (lib/shape.ml[137,4001+10]..[137,4001+13])
                Ppat_var "fmt" (lib/shape.ml[137,4001+10]..[137,4001+13])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[138,4017+2]..[188,5738+34])
              Pexp_let Nonrec
              [
                <def>
                  pattern (lib/shape.ml[138,4017+6]..[138,4017+19])
                    Ppat_var "print_uid_opt" (lib/shape.ml[138,4017+6]..[138,4017+19])
                  expression (lib/shape.ml[139,4039+4]..[139,4039+75])
                    Pexp_apply
                    expression (lib/shape.ml[139,4039+4]..[139,4039+26])
                      Pexp_ident "Format.pp_print_option" (lib/shape.ml[139,4039+4]..[139,4039+26])
                    [
                      <arg>
                      Nolabel
                        expression (lib/shape.ml[139,4039+27]..[139,4039+75])
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[139,4039+32]..[139,4039+35])
                              Nolabel
                              None
                              pattern (lib/shape.ml[139,4039+32]..[139,4039+35])
                                Ppat_var "fmt" (lib/shape.ml[139,4039+32]..[139,4039+35])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[139,4039+39]..[139,4039+74])
                              Pexp_apply
                              expression (lib/shape.ml[139,4039+39]..[139,4039+53])
                                Pexp_ident "Format.fprintf" (lib/shape.ml[139,4039+39]..[139,4039+53])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[139,4039+54]..[139,4039+57])
                                    Pexp_ident "fmt" (lib/shape.ml[139,4039+54]..[139,4039+57])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[139,4039+58]..[139,4039+64])
                                    Pexp_constant PConst_string("<%a>",(lib/shape.ml[139,4039+59]..[139,4039+63]),None)
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[139,4039+65]..[139,4039+74])
                                    Pexp_ident "Uid.print" (lib/shape.ml[139,4039+65]..[139,4039+74])
                              ]
                    ]
              ]
              expression (lib/shape.ml[141,4120+2]..[188,5738+34])
                Pexp_let Rec
                [
                  <def>
                    pattern (lib/shape.ml[141,4120+10]..[141,4120+13])
                      Ppat_var "aux" (lib/shape.ml[141,4120+10]..[141,4120+13])
                    expression (lib/shape.ml[141,4120+14]..[186,5656+76]) ghost
                      Pexp_function
                      [
                        Pparam_val (lib/shape.ml[141,4120+14]..[141,4120+17])
                          Nolabel
                          None
                          pattern (lib/shape.ml[141,4120+14]..[141,4120+17])
                            Ppat_var "fmt" (lib/shape.ml[141,4120+14]..[141,4120+17])
                        Pparam_val (lib/shape.ml[141,4120+18]..[141,4120+31])
                          Nolabel
                          None
                          pattern (lib/shape.ml[141,4120+18]..[141,4120+31])
                            Ppat_record Closed
                            [
                              "uid" (lib/shape.ml[141,4120+20]..[141,4120+23]) ghost
                                pattern (lib/shape.ml[141,4120+20]..[141,4120+23])
                                  Ppat_var "uid" (lib/shape.ml[141,4120+20]..[141,4120+23])
                              "desc" (lib/shape.ml[141,4120+25]..[141,4120+29]) ghost
                                pattern (lib/shape.ml[141,4120+25]..[141,4120+29])
                                  Ppat_var "desc" (lib/shape.ml[141,4120+25]..[141,4120+29])
                            ]
                      ]
                      None
                      Pfunction_body
                        expression (lib/shape.ml[142,4154+4]..[186,5656+76])
                          Pexp_match
                          expression (lib/shape.ml[142,4154+10]..[142,4154+14])
                            Pexp_ident "desc" (lib/shape.ml[142,4154+10]..[142,4154+14])
                          [
                            <case>
                              pattern (lib/shape.ml[143,4174+6]..[143,4174+12])
                                Ppat_construct "Var" (lib/shape.ml[143,4174+6]..[143,4174+9])
                                Some
                                  []
                                  pattern (lib/shape.ml[143,4174+10]..[143,4174+12])
                                    Ppat_var "id" (lib/shape.ml[143,4174+10]..[143,4174+12])
                              expression (lib/shape.ml[144,4190+8]..[144,4190+66])
                                Pexp_apply
                                expression (lib/shape.ml[144,4190+8]..[144,4190+22])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[144,4190+8]..[144,4190+22])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4190+23]..[144,4190+26])
                                      Pexp_ident "fmt" (lib/shape.ml[144,4190+23]..[144,4190+26])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4190+27]..[144,4190+33])
                                      Pexp_constant PConst_string("%a%a",(lib/shape.ml[144,4190+28]..[144,4190+32]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4190+34]..[144,4190+45])
                                      Pexp_ident "Ident.print" (lib/shape.ml[144,4190+34]..[144,4190+45])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4190+46]..[144,4190+48])
                                      Pexp_ident "id" (lib/shape.ml[144,4190+46]..[144,4190+48])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4190+49]..[144,4190+62])
                                      Pexp_ident "print_uid_opt" (lib/shape.ml[144,4190+49]..[144,4190+62])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4190+63]..[144,4190+66])
                                      Pexp_ident "uid" (lib/shape.ml[144,4190+63]..[144,4190+66])
                                ]
                            <case>
                              pattern (lib/shape.ml[145,4257+6]..[145,4257+17])
                                Ppat_construct "Abs" (lib/shape.ml[145,4257+6]..[145,4257+9])
                                Some
                                  []
                                  pattern (lib/shape.ml[145,4257+10]..[145,4257+17])
                                    Ppat_tuple
                                    [
                                      pattern (lib/shape.ml[145,4257+11]..[145,4257+13])
                                        Ppat_var "id" (lib/shape.ml[145,4257+11]..[145,4257+13])
                                      pattern (lib/shape.ml[145,4257+15]..[145,4257+16])
                                        Ppat_var "t" (lib/shape.ml[145,4257+15]..[145,4257+16])
                                    ]
                              expression (lib/shape.ml[146,4278+8]..[159,4780+67])
                                Pexp_let Rec
                                [
                                  <def>
                                    pattern (lib/shape.ml[146,4278+16]..[146,4278+30])
                                      Ppat_var "collect_idents" (lib/shape.ml[146,4278+16]..[146,4278+30])
                                    expression (lib/shape.ml[146,4278+33]..[151,4467+22])
                                      Pexp_function
                                      []
                                      None
                                      Pfunction_cases (lib/shape.ml[146,4278+33]..[151,4467+22])
                                        [
                                          <case>
                                            pattern (lib/shape.ml[147,4320+12]..[147,4320+45])
                                              Ppat_record Closed
                                              [
                                                "uid" (lib/shape.ml[147,4320+14]..[147,4320+17])
                                                  pattern (lib/shape.ml[147,4320+20]..[147,4320+24])
                                                    Ppat_construct "None" (lib/shape.ml[147,4320+20]..[147,4320+24])
                                                    None
                                                "desc" (lib/shape.ml[147,4320+26]..[147,4320+30])
                                                  pattern (lib/shape.ml[147,4320+33]..[147,4320+43])
                                                    Ppat_construct "Abs" (lib/shape.ml[147,4320+33]..[147,4320+36])
                                                    Some
                                                      []
                                                      pattern (lib/shape.ml[147,4320+36]..[147,4320+43])
                                                        Ppat_tuple
                                                        [
                                                          pattern (lib/shape.ml[147,4320+37]..[147,4320+39])
                                                            Ppat_var "id" (lib/shape.ml[147,4320+37]..[147,4320+39])
                                                          pattern (lib/shape.ml[147,4320+41]..[147,4320+42])
                                                            Ppat_var "t" (lib/shape.ml[147,4320+41]..[147,4320+42])
                                                        ]
                                              ]
                                            expression (lib/shape.ml[148,4369+12]..[149,4419+27])
                                              Pexp_let Nonrec
                                              [
                                                <def>
                                                  pattern (lib/shape.ml[148,4369+16]..[148,4369+27])
                                                    Ppat_tuple
                                                    [
                                                      pattern (lib/shape.ml[148,4369+17]..[148,4369+20])
                                                        Ppat_var "ids" (lib/shape.ml[148,4369+17]..[148,4369+20])
                                                      pattern (lib/shape.ml[148,4369+22]..[148,4369+26])
                                                        Ppat_var "body" (lib/shape.ml[148,4369+22]..[148,4369+26])
                                                    ]
                                                  expression (lib/shape.ml[148,4369+30]..[148,4369+46])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[148,4369+30]..[148,4369+44])
                                                      Pexp_ident "collect_idents" (lib/shape.ml[148,4369+30]..[148,4369+44])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[148,4369+45]..[148,4369+46])
                                                          Pexp_ident "t" (lib/shape.ml[148,4369+45]..[148,4369+46])
                                                    ]
                                              ]
                                              expression (lib/shape.ml[149,4419+12]..[149,4419+27])
                                                Pexp_tuple
                                                [
                                                  expression (lib/shape.ml[149,4419+12]..[149,4419+21])
                                                    Pexp_construct "::" (lib/shape.ml[149,4419+15]..[149,4419+17])
                                                    Some
                                                      expression (lib/shape.ml[149,4419+12]..[149,4419+21]) ghost
                                                        Pexp_tuple
                                                        [
                                                          expression (lib/shape.ml[149,4419+12]..[149,4419+14])
                                                            Pexp_ident "id" (lib/shape.ml[149,4419+12]..[149,4419+14])
                                                          expression (lib/shape.ml[149,4419+18]..[149,4419+21])
                                                            Pexp_ident "ids" (lib/shape.ml[149,4419+18]..[149,4419+21])
                                                        ]
                                                  expression (lib/shape.ml[149,4419+23]..[149,4419+27])
                                                    Pexp_ident "body" (lib/shape.ml[149,4419+23]..[149,4419+27])
                                                ]
                                          <case>
                                            pattern (lib/shape.ml[150,4447+12]..[150,4447+16])
                                              Ppat_var "body" (lib/shape.ml[150,4447+12]..[150,4447+16])
                                            expression (lib/shape.ml[151,4467+12]..[151,4467+22])
                                              Pexp_tuple
                                              [
                                                expression (lib/shape.ml[151,4467+13]..[151,4467+15])
                                                  Pexp_construct "[]" (lib/shape.ml[151,4467+13]..[151,4467+15])
                                                  None
                                                expression (lib/shape.ml[151,4467+17]..[151,4467+21])
                                                  Pexp_ident "body" (lib/shape.ml[151,4467+17]..[151,4467+21])
                                              ]
                                        ]
                                ]
                                expression (lib/shape.ml[153,4501+8]..[159,4780+67])
                                  Pexp_let Nonrec
                                  [
                                    <def>
                                      pattern (lib/shape.ml[153,4501+12]..[153,4501+32])
                                        Ppat_tuple
                                        [
                                          pattern (lib/shape.ml[153,4501+13]..[153,4501+25])
                                            Ppat_var "other_idents" (lib/shape.ml[153,4501+13]..[153,4501+25])
                                          pattern (lib/shape.ml[153,4501+27]..[153,4501+31])
                                            Ppat_var "body" (lib/shape.ml[153,4501+27]..[153,4501+31])
                                        ]
                                      expression (lib/shape.ml[153,4501+35]..[153,4501+51])
                                        Pexp_apply
                                        expression (lib/shape.ml[153,4501+35]..[153,4501+49])
                                          Pexp_ident "collect_idents" (lib/shape.ml[153,4501+35]..[153,4501+49])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[153,4501+50]..[153,4501+51])
                                              Pexp_ident "t" (lib/shape.ml[153,4501+50]..[153,4501+51])
                                        ]
                                  ]
                                  expression (lib/shape.ml[154,4556+8]..[159,4780+67])
                                    Pexp_let Nonrec
                                    [
                                      <def>
                                        pattern (lib/shape.ml[154,4556+12]..[154,4556+21])
                                          Ppat_var "pp_idents" (lib/shape.ml[154,4556+12]..[154,4556+21])
                                        expression (lib/shape.ml[154,4556+22]..[156,4649+61]) ghost
                                          Pexp_function
                                          [
                                            Pparam_val (lib/shape.ml[154,4556+22]..[154,4556+25])
                                              Nolabel
                                              None
                                              pattern (lib/shape.ml[154,4556+22]..[154,4556+25])
                                                Ppat_var "fmt" (lib/shape.ml[154,4556+22]..[154,4556+25])
                                            Pparam_val (lib/shape.ml[154,4556+26]..[154,4556+32])
                                              Nolabel
                                              None
                                              pattern (lib/shape.ml[154,4556+26]..[154,4556+32])
                                                Ppat_var "idents" (lib/shape.ml[154,4556+26]..[154,4556+32])
                                          ]
                                          None
                                          Pfunction_body
                                            expression (lib/shape.ml[155,4591+10]..[156,4649+61])
                                              Pexp_let Nonrec
                                              [
                                                <def>
                                                  pattern (lib/shape.ml[155,4591+14]..[155,4591+20])
                                                    Ppat_var "pp_sep" (lib/shape.ml[155,4591+14]..[155,4591+20])
                                                  expression (lib/shape.ml[155,4591+21]..[155,4591+54]) ghost
                                                    Pexp_function
                                                    [
                                                      Pparam_val (lib/shape.ml[155,4591+21]..[155,4591+24])
                                                        Nolabel
                                                        None
                                                        pattern (lib/shape.ml[155,4591+21]..[155,4591+24])
                                                          Ppat_var "fmt" (lib/shape.ml[155,4591+21]..[155,4591+24])
                                                      Pparam_val (lib/shape.ml[155,4591+25]..[155,4591+27])
                                                        Nolabel
                                                        None
                                                        pattern (lib/shape.ml[155,4591+25]..[155,4591+27])
                                                          Ppat_construct "()" (lib/shape.ml[155,4591+25]..[155,4591+27])
                                                          None
                                                    ]
                                                    None
                                                    Pfunction_body
                                                      expression (lib/shape.ml[155,4591+30]..[155,4591+54])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[155,4591+30]..[155,4591+44])
                                                          Pexp_ident "Format.fprintf" (lib/shape.ml[155,4591+30]..[155,4591+44])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[155,4591+45]..[155,4591+48])
                                                              Pexp_ident "fmt" (lib/shape.ml[155,4591+45]..[155,4591+48])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[155,4591+49]..[155,4591+54])
                                                              Pexp_constant PConst_string(",@ ",(lib/shape.ml[155,4591+50]..[155,4591+53]),None)
                                                        ]
                                              ]
                                              expression (lib/shape.ml[156,4649+10]..[156,4649+61])
                                                Pexp_apply
                                                expression (lib/shape.ml[156,4649+10]..[156,4649+30])
                                                  Pexp_ident "Format.pp_print_list" (lib/shape.ml[156,4649+10]..[156,4649+30])
                                                [
                                                  <arg>
                                                  Labelled "pp_sep"
                                                    expression (lib/shape.ml[156,4649+32]..[156,4649+38])
                                                      Pexp_ident "pp_sep" (lib/shape.ml[156,4649+32]..[156,4649+38])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[156,4649+39]..[156,4649+50])
                                                      Pexp_ident "Ident.print" (lib/shape.ml[156,4649+39]..[156,4649+50])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[156,4649+51]..[156,4649+54])
                                                      Pexp_ident "fmt" (lib/shape.ml[156,4649+51]..[156,4649+54])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[156,4649+55]..[156,4649+61])
                                                      Pexp_ident "idents" (lib/shape.ml[156,4649+55]..[156,4649+61])
                                                ]
                                    ]
                                    expression (lib/shape.ml[158,4722+8]..[159,4780+67])
                                      Pexp_apply
                                      expression (lib/shape.ml[158,4722+8]..[158,4722+22])
                                        Pexp_ident "Format.fprintf" (lib/shape.ml[158,4722+8]..[158,4722+22])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[158,4722+23]..[158,4722+26])
                                            Pexp_ident "fmt" (lib/shape.ml[158,4722+23]..[158,4722+26])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[158,4722+27]..[158,4722+57])
                                            Pexp_constant PConst_string("Abs@[%a@,(@[%a,@ @[%a@]@])@]",(lib/shape.ml[158,4722+28]..[158,4722+56]),None)
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4780+10]..[159,4780+23])
                                            Pexp_ident "print_uid_opt" (lib/shape.ml[159,4780+10]..[159,4780+23])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4780+24]..[159,4780+27])
                                            Pexp_ident "uid" (lib/shape.ml[159,4780+24]..[159,4780+27])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4780+28]..[159,4780+37])
                                            Pexp_ident "pp_idents" (lib/shape.ml[159,4780+28]..[159,4780+37])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4780+38]..[159,4780+58])
                                            Pexp_construct "::" (lib/shape.ml[159,4780+42]..[159,4780+44])
                                            Some
                                              expression (lib/shape.ml[159,4780+39]..[159,4780+57]) ghost
                                                Pexp_tuple
                                                [
                                                  expression (lib/shape.ml[159,4780+39]..[159,4780+41])
                                                    Pexp_ident "id" (lib/shape.ml[159,4780+39]..[159,4780+41])
                                                  expression (lib/shape.ml[159,4780+45]..[159,4780+57])
                                                    Pexp_ident "other_idents" (lib/shape.ml[159,4780+45]..[159,4780+57])
                                                ]
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4780+59]..[159,4780+62])
                                            Pexp_ident "aux" (lib/shape.ml[159,4780+59]..[159,4780+62])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4780+63]..[159,4780+67])
                                            Pexp_ident "body" (lib/shape.ml[159,4780+63]..[159,4780+67])
                                      ]
                            <case>
                              pattern (lib/shape.ml[160,4848+6]..[160,4848+18])
                                Ppat_construct "App" (lib/shape.ml[160,4848+6]..[160,4848+9])
                                Some
                                  []
                                  pattern (lib/shape.ml[160,4848+10]..[160,4848+18])
                                    Ppat_tuple
                                    [
                                      pattern (lib/shape.ml[160,4848+11]..[160,4848+13])
                                        Ppat_var "t1" (lib/shape.ml[160,4848+11]..[160,4848+13])
                                      pattern (lib/shape.ml[160,4848+15]..[160,4848+17])
                                        Ppat_var "t2" (lib/shape.ml[160,4848+15]..[160,4848+17])
                                    ]
                              expression (lib/shape.ml[161,4870+8]..[162,4928+27])
                                Pexp_apply
                                expression (lib/shape.ml[161,4870+8]..[161,4870+22])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[161,4870+8]..[161,4870+22])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4870+23]..[161,4870+26])
                                      Pexp_ident "fmt" (lib/shape.ml[161,4870+23]..[161,4870+26])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4870+27]..[161,4870+43])
                                      Pexp_constant PConst_string("@[%a(@,%a)%a@]",(lib/shape.ml[161,4870+28]..[161,4870+42]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4870+44]..[161,4870+47])
                                      Pexp_ident "aux" (lib/shape.ml[161,4870+44]..[161,4870+47])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4870+48]..[161,4870+50])
                                      Pexp_ident "t1" (lib/shape.ml[161,4870+48]..[161,4870+50])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4870+51]..[161,4870+54])
                                      Pexp_ident "aux" (lib/shape.ml[161,4870+51]..[161,4870+54])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4870+55]..[161,4870+57])
                                      Pexp_ident "t2" (lib/shape.ml[161,4870+55]..[161,4870+57])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[162,4928+10]..[162,4928+23])
                                      Pexp_ident "print_uid_opt" (lib/shape.ml[162,4928+10]..[162,4928+23])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[162,4928+24]..[162,4928+27])
                                      Pexp_ident "uid" (lib/shape.ml[162,4928+24]..[162,4928+27])
                                ]
                            <case>
                              pattern (lib/shape.ml[163,4956+6]..[163,4956+10])
                                Ppat_construct "Leaf" (lib/shape.ml[163,4956+6]..[163,4956+10])
                                None
                              expression (lib/shape.ml[164,4970+8]..[164,4970+72])
                                Pexp_apply
                                expression (lib/shape.ml[164,4970+8]..[164,4970+22])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[164,4970+8]..[164,4970+22])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,4970+23]..[164,4970+26])
                                      Pexp_ident "fmt" (lib/shape.ml[164,4970+23]..[164,4970+26])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,4970+27]..[164,4970+33])
                                      Pexp_constant PConst_string("<%a>",(lib/shape.ml[164,4970+28]..[164,4970+32]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,4970+34]..[164,4970+68])
                                      Pexp_apply
                                      expression (lib/shape.ml[164,4970+35]..[164,4970+57])
                                        Pexp_ident "Format.pp_print_option" (lib/shape.ml[164,4970+35]..[164,4970+57])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[164,4970+58]..[164,4970+67])
                                            Pexp_ident "Uid.print" (lib/shape.ml[164,4970+58]..[164,4970+67])
                                      ]
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,4970+69]..[164,4970+72])
                                      Pexp_ident "uid" (lib/shape.ml[164,4970+69]..[164,4970+72])
                                ]
                            <case>
                              pattern (lib/shape.ml[165,5043+6]..[165,5043+20])
                                Ppat_construct "Proj" (lib/shape.ml[165,5043+6]..[165,5043+10])
                                Some
                                  []
                                  pattern (lib/shape.ml[165,5043+11]..[165,5043+20])
                                    Ppat_tuple
                                    [
                                      pattern (lib/shape.ml[165,5043+12]..[165,5043+13])
                                        Ppat_var "t" (lib/shape.ml[165,5043+12]..[165,5043+13])
                                      pattern (lib/shape.ml[165,5043+15]..[165,5043+19])
                                        Ppat_var "item" (lib/shape.ml[165,5043+15]..[165,5043+19])
                                    ]
                              expression (lib/shape.ml[166,5067+8]..[176,5364+11])
                                Pexp_match
                                expression (lib/shape.ml[166,5067+20]..[166,5067+23])
                                  Pexp_ident "uid" (lib/shape.ml[166,5067+20]..[166,5067+23])
                                [
                                  <case>
                                    pattern (lib/shape.ml[167,5096+10]..[167,5096+14])
                                      Ppat_construct "None" (lib/shape.ml[167,5096+10]..[167,5096+14])
                                      None
                                    expression (lib/shape.ml[168,5114+12]..[170,5181+29])
                                      Pexp_apply
                                      expression (lib/shape.ml[168,5114+12]..[168,5114+26])
                                        Pexp_ident "Format.fprintf" (lib/shape.ml[168,5114+12]..[168,5114+26])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[168,5114+27]..[168,5114+30])
                                            Pexp_ident "fmt" (lib/shape.ml[168,5114+27]..[168,5114+30])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[168,5114+31]..[168,5114+46])
                                            Pexp_constant PConst_string("@[%a@ .@ %a@]",(lib/shape.ml[168,5114+32]..[168,5114+45]),None)
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[169,5161+14]..[169,5161+17])
                                            Pexp_ident "aux" (lib/shape.ml[169,5161+14]..[169,5161+17])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[169,5161+18]..[169,5161+19])
                                            Pexp_ident "t" (lib/shape.ml[169,5161+18]..[169,5161+19])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[170,5181+14]..[170,5181+24])
                                            Pexp_ident "Item.print" (lib/shape.ml[170,5181+14]..[170,5181+24])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[170,5181+25]..[170,5181+29])
                                            Pexp_ident "item" (lib/shape.ml[170,5181+25]..[170,5181+29])
                                      ]
                                  <case>
                                    pattern (lib/shape.ml[171,5211+10]..[171,5211+18])
                                      Ppat_construct "Some" (lib/shape.ml[171,5211+10]..[171,5211+14])
                                      Some
                                        []
                                        pattern (lib/shape.ml[171,5211+15]..[171,5211+18])
                                          Ppat_var "uid" (lib/shape.ml[171,5211+15]..[171,5211+18])
                                    expression (lib/shape.ml[172,5233+12]..[175,5336+27])
                                      Pexp_apply
                                      expression (lib/shape.ml[172,5233+12]..[172,5233+26])
                                        Pexp_ident "Format.fprintf" (lib/shape.ml[172,5233+12]..[172,5233+26])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[172,5233+27]..[172,5233+30])
                                            Pexp_ident "fmt" (lib/shape.ml[172,5233+27]..[172,5233+30])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[172,5233+31]..[172,5233+52])
                                            Pexp_constant PConst_string("@[(%a@ .@ %a)<%a>@]",(lib/shape.ml[172,5233+32]..[172,5233+51]),None)
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[173,5286+14]..[173,5286+17])
                                            Pexp_ident "aux" (lib/shape.ml[173,5286+14]..[173,5286+17])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[173,5286+18]..[173,5286+19])
                                            Pexp_ident "t" (lib/shape.ml[173,5286+18]..[173,5286+19])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[174,5306+14]..[174,5306+24])
                                            Pexp_ident "Item.print" (lib/shape.ml[174,5306+14]..[174,5306+24])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[174,5306+25]..[174,5306+29])
                                            Pexp_ident "item" (lib/shape.ml[174,5306+25]..[174,5306+29])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[175,5336+14]..[175,5336+23])
                                            Pexp_ident "Uid.print" (lib/shape.ml[175,5336+14]..[175,5336+23])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[175,5336+24]..[175,5336+27])
                                            Pexp_ident "uid" (lib/shape.ml[175,5336+24]..[175,5336+27])
                                      ]
                                ]
                            <case>
                              pattern (lib/shape.ml[177,5376+6]..[177,5376+20])
                                Ppat_construct "Comp_unit" (lib/shape.ml[177,5376+6]..[177,5376+15])
                                Some
                                  []
                                  pattern (lib/shape.ml[177,5376+16]..[177,5376+20])
                                    Ppat_var "name" (lib/shape.ml[177,5376+16]..[177,5376+20])
                              expression (lib/shape.ml[177,5376+24]..[177,5376+55])
                                Pexp_apply
                                expression (lib/shape.ml[177,5376+24]..[177,5376+38])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[177,5376+24]..[177,5376+38])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[177,5376+39]..[177,5376+42])
                                      Pexp_ident "fmt" (lib/shape.ml[177,5376+39]..[177,5376+42])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[177,5376+43]..[177,5376+50])
                                      Pexp_constant PConst_string("CU %s",(lib/shape.ml[177,5376+44]..[177,5376+49]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[177,5376+51]..[177,5376+55])
                                      Pexp_ident "name" (lib/shape.ml[177,5376+51]..[177,5376+55])
                                ]
                            <case>
                              pattern (lib/shape.ml[178,5432+6]..[178,5432+16])
                                Ppat_construct "Struct" (lib/shape.ml[178,5432+6]..[178,5432+12])
                                Some
                                  []
                                  pattern (lib/shape.ml[178,5432+13]..[178,5432+16])
                                    Ppat_var "map" (lib/shape.ml[178,5432+13]..[178,5432+16])
                              expression (lib/shape.ml[179,5452+8]..[186,5656+76])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (lib/shape.ml[179,5452+12]..[179,5452+21])
                                      Ppat_var "print_map" (lib/shape.ml[179,5452+12]..[179,5452+21])
                                    expression (lib/shape.ml[179,5452+22]..[184,5631+13]) ghost
                                      Pexp_function
                                      [
                                        Pparam_val (lib/shape.ml[179,5452+22]..[179,5452+25])
                                          Nolabel
                                          None
                                          pattern (lib/shape.ml[179,5452+22]..[179,5452+25])
                                            Ppat_var "fmt" (lib/shape.ml[179,5452+22]..[179,5452+25])
                                      ]
                                      None
                                      Pfunction_body
                                        expression (lib/shape.ml[180,5480+10]..[184,5631+13])
                                          Pexp_apply
                                          expression (lib/shape.ml[180,5480+10]..[180,5480+23])
                                            Pexp_ident "Item.Map.iter" (lib/shape.ml[180,5480+10]..[180,5480+23])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[180,5480+24]..[184,5631+13])
                                                Pexp_function
                                                [
                                                  Pparam_val (lib/shape.ml[180,5480+29]..[180,5480+33])
                                                    Nolabel
                                                    None
                                                    pattern (lib/shape.ml[180,5480+29]..[180,5480+33])
                                                      Ppat_var "item" (lib/shape.ml[180,5480+29]..[180,5480+33])
                                                  Pparam_val (lib/shape.ml[180,5480+34]..[180,5480+35])
                                                    Nolabel
                                                    None
                                                    pattern (lib/shape.ml[180,5480+34]..[180,5480+35])
                                                      Ppat_var "t" (lib/shape.ml[180,5480+34]..[180,5480+35])
                                                ]
                                                None
                                                Pfunction_body
                                                  expression (lib/shape.ml[181,5519+14]..[183,5609+21])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[181,5519+14]..[181,5519+28])
                                                      Pexp_ident "Format.fprintf" (lib/shape.ml[181,5519+14]..[181,5519+28])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[181,5519+29]..[181,5519+32])
                                                          Pexp_ident "fmt" (lib/shape.ml[181,5519+29]..[181,5519+32])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[181,5519+33]..[181,5519+57])
                                                          Pexp_constant PConst_string("@[<hv 2>%a ->@ %a;@]@,",(lib/shape.ml[181,5519+34]..[181,5519+56]),None)
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[182,5577+16]..[182,5577+26])
                                                          Pexp_ident "Item.print" (lib/shape.ml[182,5577+16]..[182,5577+26])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[182,5577+27]..[182,5577+31])
                                                          Pexp_ident "item" (lib/shape.ml[182,5577+27]..[182,5577+31])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[183,5609+16]..[183,5609+19])
                                                          Pexp_ident "aux" (lib/shape.ml[183,5609+16]..[183,5609+19])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[183,5609+20]..[183,5609+21])
                                                          Pexp_ident "t" (lib/shape.ml[183,5609+20]..[183,5609+21])
                                                    ]
                                          ]
                                ]
                                expression (lib/shape.ml[186,5656+8]..[186,5656+76])
                                  Pexp_apply
                                  expression (lib/shape.ml[186,5656+8]..[186,5656+22])
                                    Pexp_ident "Format.fprintf" (lib/shape.ml[186,5656+8]..[186,5656+22])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5656+23]..[186,5656+26])
                                        Pexp_ident "fmt" (lib/shape.ml[186,5656+23]..[186,5656+26])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5656+27]..[186,5656+44])
                                        Pexp_constant PConst_string("{@[<v>%a@,%a@]}",(lib/shape.ml[186,5656+28]..[186,5656+43]),None)
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5656+45]..[186,5656+58])
                                        Pexp_ident "print_uid_opt" (lib/shape.ml[186,5656+45]..[186,5656+58])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5656+59]..[186,5656+62])
                                        Pexp_ident "uid" (lib/shape.ml[186,5656+59]..[186,5656+62])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5656+63]..[186,5656+72])
                                        Pexp_ident "print_map" (lib/shape.ml[186,5656+63]..[186,5656+72])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5656+73]..[186,5656+76])
                                        Pexp_ident "map" (lib/shape.ml[186,5656+73]..[186,5656+76])
                                  ]
                          ]
                ]
                expression (lib/shape.ml[188,5738+2]..[188,5738+34])
                  Pexp_apply
                  expression (lib/shape.ml[188,5738+2]..[188,5738+16])
                    Pexp_ident "Format.fprintf" (lib/shape.ml[188,5738+2]..[188,5738+16])
                  [
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[188,5738+17]..[188,5738+20])
                        Pexp_ident "fmt" (lib/shape.ml[188,5738+17]..[188,5738+20])
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[188,5738+20]..[188,5738+30])
                        Pexp_constant PConst_string("@[%a@]@;",(lib/shape.ml[188,5738+21]..[188,5738+29]),None)
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[188,5738+31]..[188,5738+34])
                        Pexp_ident "aux" (lib/shape.ml[188,5738+31]..[188,5738+34])
                  ]
    ]
  structure_item (lib/shape.ml[190,5774+0]..[192,5853+41])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[190,5774+4]..[190,5774+13])
          Ppat_var "fresh_var" (lib/shape.ml[190,5774+4]..[190,5774+13])
        expression (lib/shape.ml[190,5774+14]..[192,5853+41]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[190,5774+14]..[190,5774+33])
              Optional "name"
              Some
                expression (lib/shape.ml[190,5774+21]..[190,5774+32])
                  Pexp_constant PConst_string("shape-var",(lib/shape.ml[190,5774+22]..[190,5774+31]),None)
              pattern (lib/shape.ml[190,5774+16]..[190,5774+20])
                Ppat_var "name" (lib/shape.ml[190,5774+16]..[190,5774+20])
            Pparam_val (lib/shape.ml[190,5774+34]..[190,5774+37])
              Nolabel
              None
              pattern (lib/shape.ml[190,5774+34]..[190,5774+37])
                Ppat_var "uid" (lib/shape.ml[190,5774+34]..[190,5774+37])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[191,5814+2]..[192,5853+41])
              Pexp_let Nonrec
              [
                <def>
                  pattern (lib/shape.ml[191,5814+6]..[191,5814+9])
                    Ppat_var "var" (lib/shape.ml[191,5814+6]..[191,5814+9])
                  expression (lib/shape.ml[191,5814+12]..[191,5814+35])
                    Pexp_apply
                    expression (lib/shape.ml[191,5814+12]..[191,5814+30])
                      Pexp_ident "Ident.create_local" (lib/shape.ml[191,5814+12]..[191,5814+30])
                    [
                      <arg>
                      Nolabel
                        expression (lib/shape.ml[191,5814+31]..[191,5814+35])
                          Pexp_ident "name" (lib/shape.ml[191,5814+31]..[191,5814+35])
                    ]
              ]
              expression (lib/shape.ml[192,5853+2]..[192,5853+41])
                Pexp_tuple
                [
                  expression (lib/shape.ml[192,5853+2]..[192,5853+5])
                    Pexp_ident "var" (lib/shape.ml[192,5853+2]..[192,5853+5])
                  expression (lib/shape.ml[192,5853+7]..[192,5853+41])
                    Pexp_record
                    [
                      "uid" (lib/shape.ml[192,5853+9]..[192,5853+12])
                        expression (lib/shape.ml[192,5853+15]..[192,5853+23])
                          Pexp_construct "Some" (lib/shape.ml[192,5853+15]..[192,5853+19])
                          Some
                            expression (lib/shape.ml[192,5853+20]..[192,5853+23])
                              Pexp_ident "uid" (lib/shape.ml[192,5853+20]..[192,5853+23])
                      "desc" (lib/shape.ml[192,5853+25]..[192,5853+29])
                        expression (lib/shape.ml[192,5853+32]..[192,5853+39])
                          Pexp_construct "Var" (lib/shape.ml[192,5853+32]..[192,5853+35])
                          Some
                            expression (lib/shape.ml[192,5853+36]..[192,5853+39])
                              Pexp_ident "var" (lib/shape.ml[192,5853+36]..[192,5853+39])
                    ]
                    None
                ]
    ]
  structure_item (lib/shape.ml[194,5896+0]..[194,5896+55])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[194,5896+4]..[194,5896+29])
          Ppat_var "for_unnamed_functor_param" (lib/shape.ml[194,5896+4]..[194,5896+29])
        expression (lib/shape.ml[194,5896+32]..[194,5896+55])
          Pexp_apply
          expression (lib/shape.ml[194,5896+32]..[194,5896+50])
            Pexp_ident "Ident.create_local" (lib/shape.ml[194,5896+32]..[194,5896+50])
          [
            <arg>
            Nolabel
              expression (lib/shape.ml[194,5896+51]..[194,5896+55])
                Pexp_constant PConst_string("()",(lib/shape.ml[194,5896+52]..[194,5896+54]),None)
          ]
    ]
  structure_item (lib/shape.ml[196,5953+0]..[197,5970+35])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[196,5953+4]..[196,5953+7])
          Ppat_var "var" (lib/shape.ml[196,5953+4]..[196,5953+7])
        expression (lib/shape.ml[196,5953+8]..[197,5970+35]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[196,5953+8]..[196,5953+11])
              Nolabel
              None
              pattern (lib/shape.ml[196,5953+8]..[196,5953+11])
                Ppat_var "uid" (lib/shape.ml[196,5953+8]..[196,5953+11])
            Pparam_val (lib/shape.ml[196,5953+12]..[196,5953+14])
              Nolabel
              None
              pattern (lib/shape.ml[196,5953+12]..[196,5953+14])
                Ppat_var "id" (lib/shape.ml[196,5953+12]..[196,5953+14])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[197,5970+2]..[197,5970+35])
              Pexp_record
              [
                "uid" (lib/shape.ml[197,5970+4]..[197,5970+7])
                  expression (lib/shape.ml[197,5970+10]..[197,5970+18])
                    Pexp_construct "Some" (lib/shape.ml[197,5970+10]..[197,5970+14])
                    Some
                      expression (lib/shape.ml[197,5970+15]..[197,5970+18])
                        Pexp_ident "uid" (lib/shape.ml[197,5970+15]..[197,5970+18])
                "desc" (lib/shape.ml[197,5970+20]..[197,5970+24])
                  expression (lib/shape.ml[197,5970+27]..[197,5970+33])
                    Pexp_construct "Var" (lib/shape.ml[197,5970+27]..[197,5970+30])
                    Some
                      expression (lib/shape.ml[197,5970+31]..[197,5970+33])
                        Pexp_ident "id" (lib/shape.ml[197,5970+31]..[197,5970+33])
              ]
              None
    ]
  structure_item (lib/shape.ml[199,6007+0]..[200,6031+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[199,6007+4]..[199,6007+7])
          Ppat_var "abs" (lib/shape.ml[199,6007+4]..[199,6007+7])
        expression (lib/shape.ml[199,6007+8]..[200,6031+33]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[199,6007+8]..[199,6007+12])
              Optional "uid"
              None
              pattern (lib/shape.ml[199,6007+9]..[199,6007+12])
                Ppat_var "uid" (lib/shape.ml[199,6007+9]..[199,6007+12])
            Pparam_val (lib/shape.ml[199,6007+13]..[199,6007+16])
              Nolabel
              None
              pattern (lib/shape.ml[199,6007+13]..[199,6007+16])
                Ppat_var "var" (lib/shape.ml[199,6007+13]..[199,6007+16])
            Pparam_val (lib/shape.ml[199,6007+17]..[199,6007+21])
              Nolabel
              None
              pattern (lib/shape.ml[199,6007+17]..[199,6007+21])
                Ppat_var "body" (lib/shape.ml[199,6007+17]..[199,6007+21])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[200,6031+2]..[200,6031+33])
              Pexp_record
              [
                "uid" (lib/shape.ml[200,6031+4]..[200,6031+7]) ghost
                  expression (lib/shape.ml[200,6031+4]..[200,6031+7])
                    Pexp_ident "uid" (lib/shape.ml[200,6031+4]..[200,6031+7])
                "desc" (lib/shape.ml[200,6031+9]..[200,6031+13])
                  expression (lib/shape.ml[200,6031+16]..[200,6031+31])
                    Pexp_construct "Abs" (lib/shape.ml[200,6031+16]..[200,6031+19])
                    Some
                      expression (lib/shape.ml[200,6031+20]..[200,6031+31])
                        Pexp_tuple
                        [
                          expression (lib/shape.ml[200,6031+21]..[200,6031+24])
                            Pexp_ident "var" (lib/shape.ml[200,6031+21]..[200,6031+24])
                          expression (lib/shape.ml[200,6031+26]..[200,6031+30])
                            Pexp_ident "body" (lib/shape.ml[200,6031+26]..[200,6031+30])
                        ]
              ]
              None
    ]
  structure_item (lib/shape.ml[202,6066+0]..[203,6085+28])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[202,6066+4]..[202,6066+7])
          Ppat_var "str" (lib/shape.ml[202,6066+4]..[202,6066+7])
        expression (lib/shape.ml[202,6066+8]..[203,6085+28]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[202,6066+8]..[202,6066+12])
              Optional "uid"
              None
              pattern (lib/shape.ml[202,6066+9]..[202,6066+12])
                Ppat_var "uid" (lib/shape.ml[202,6066+9]..[202,6066+12])
            Pparam_val (lib/shape.ml[202,6066+13]..[202,6066+16])
              Nolabel
              None
              pattern (lib/shape.ml[202,6066+13]..[202,6066+16])
                Ppat_var "map" (lib/shape.ml[202,6066+13]..[202,6066+16])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[203,6085+2]..[203,6085+28])
              Pexp_record
              [
                "uid" (lib/shape.ml[203,6085+4]..[203,6085+7]) ghost
                  expression (lib/shape.ml[203,6085+4]..[203,6085+7])
                    Pexp_ident "uid" (lib/shape.ml[203,6085+4]..[203,6085+7])
                "desc" (lib/shape.ml[203,6085+9]..[203,6085+13])
                  expression (lib/shape.ml[203,6085+16]..[203,6085+26])
                    Pexp_construct "Struct" (lib/shape.ml[203,6085+16]..[203,6085+22])
                    Some
                      expression (lib/shape.ml[203,6085+23]..[203,6085+26])
                        Pexp_ident "map" (lib/shape.ml[203,6085+23]..[203,6085+26])
              ]
              None
    ]
  structure_item (lib/shape.ml[205,6115+0]..[206,6130+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[205,6115+4]..[205,6115+8])
          Ppat_var "leaf" (lib/shape.ml[205,6115+4]..[205,6115+8])
        expression (lib/shape.ml[205,6115+9]..[206,6130+33]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[205,6115+9]..[205,6115+12])
              Nolabel
              None
              pattern (lib/shape.ml[205,6115+9]..[205,6115+12])
                Ppat_var "uid" (lib/shape.ml[205,6115+9]..[205,6115+12])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[206,6130+2]..[206,6130+33])
              Pexp_record
              [
                "uid" (lib/shape.ml[206,6130+4]..[206,6130+7])
                  expression (lib/shape.ml[206,6130+10]..[206,6130+18])
                    Pexp_construct "Some" (lib/shape.ml[206,6130+10]..[206,6130+14])
                    Some
                      expression (lib/shape.ml[206,6130+15]..[206,6130+18])
                        Pexp_ident "uid" (lib/shape.ml[206,6130+15]..[206,6130+18])
                "desc" (lib/shape.ml[206,6130+20]..[206,6130+24])
                  expression (lib/shape.ml[206,6130+27]..[206,6130+31])
                    Pexp_construct "Leaf" (lib/shape.ml[206,6130+27]..[206,6130+31])
                    None
              ]
              None
    ]
  structure_item (lib/shape.ml[208,6165+0]..[219,6445+36])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[208,6165+4]..[208,6165+8])
          Ppat_var "proj" (lib/shape.ml[208,6165+4]..[208,6165+8])
        expression (lib/shape.ml[208,6165+9]..[219,6445+36]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[208,6165+9]..[208,6165+13])
              Optional "uid"
              None
              pattern (lib/shape.ml[208,6165+10]..[208,6165+13])
                Ppat_var "uid" (lib/shape.ml[208,6165+10]..[208,6165+13])
            Pparam_val (lib/shape.ml[208,6165+14]..[208,6165+15])
              Nolabel
              None
              pattern (lib/shape.ml[208,6165+14]..[208,6165+15])
                Ppat_var "t" (lib/shape.ml[208,6165+14]..[208,6165+15])
            Pparam_val (lib/shape.ml[208,6165+16]..[208,6165+20])
              Nolabel
              None
              pattern (lib/shape.ml[208,6165+16]..[208,6165+20])
                Ppat_var "item" (lib/shape.ml[208,6165+16]..[208,6165+20])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[209,6188+2]..[219,6445+36])
              Pexp_match
              expression (lib/shape.ml[209,6188+8]..[209,6188+14])
                Pexp_field
                expression (lib/shape.ml[209,6188+8]..[209,6188+9])
                  Pexp_ident "t" (lib/shape.ml[209,6188+8]..[209,6188+9])
                "desc" (lib/shape.ml[209,6188+10]..[209,6188+14])
              [
                <case>
                  pattern (lib/shape.ml[210,6208+4]..[210,6208+8])
                    Ppat_construct "Leaf" (lib/shape.ml[210,6208+4]..[210,6208+8])
                    None
                  expression (lib/shape.ml[213,6311+6]..[213,6311+7])
                    Pexp_ident "t" (lib/shape.ml[213,6311+6]..[213,6311+7])
                <case>
                  pattern (lib/shape.ml[214,6319+4]..[214,6319+14])
                    Ppat_construct "Struct" (lib/shape.ml[214,6319+4]..[214,6319+10])
                    Some
                      []
                      pattern (lib/shape.ml[214,6319+11]..[214,6319+14])
                        Ppat_var "map" (lib/shape.ml[214,6319+11]..[214,6319+14])
                  expression (lib/shape.ml[215,6337+6]..[217,6426+9])
                    Pexp_try
                    expression (lib/shape.ml[215,6337+16]..[215,6337+38])
                      Pexp_apply
                      expression (lib/shape.ml[215,6337+16]..[215,6337+29])
                        Pexp_ident "Item.Map.find" (lib/shape.ml[215,6337+16]..[215,6337+29])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[215,6337+30]..[215,6337+34])
                            Pexp_ident "item" (lib/shape.ml[215,6337+30]..[215,6337+34])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[215,6337+35]..[215,6337+38])
                            Pexp_ident "map" (lib/shape.ml[215,6337+35]..[215,6337+38])
                      ]
                    [
                      <case>
                        pattern (lib/shape.ml[216,6376+11]..[216,6376+20])
                          Ppat_construct "Not_found" (lib/shape.ml[216,6376+11]..[216,6376+20])
                          None
                        expression (lib/shape.ml[216,6376+24]..[216,6376+25])
                          Pexp_ident "t" (lib/shape.ml[216,6376+24]..[216,6376+25])
                    ]
                <case>
                  pattern (lib/shape.ml[218,6436+4]..[218,6436+5])
                    Ppat_any
                  expression (lib/shape.ml[219,6445+6]..[219,6445+36])
                    Pexp_record
                    [
                      "uid" (lib/shape.ml[219,6445+8]..[219,6445+11]) ghost
                        expression (lib/shape.ml[219,6445+8]..[219,6445+11])
                          Pexp_ident "uid" (lib/shape.ml[219,6445+8]..[219,6445+11])
                      "desc" (lib/shape.ml[219,6445+13]..[219,6445+17])
                        expression (lib/shape.ml[219,6445+20]..[219,6445+34])
                          Pexp_construct "Proj" (lib/shape.ml[219,6445+20]..[219,6445+24])
                          Some
                            expression (lib/shape.ml[219,6445+25]..[219,6445+34])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[219,6445+26]..[219,6445+27])
                                  Pexp_ident "t" (lib/shape.ml[219,6445+26]..[219,6445+27])
                                expression (lib/shape.ml[219,6445+29]..[219,6445+33])
                                  Pexp_ident "item" (lib/shape.ml[219,6445+29]..[219,6445+33])
                              ]
                    ]
                    None
              ]
    ]
  structure_item (lib/shape.ml[221,6483+0]..[222,6505+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[221,6483+4]..[221,6483+7])
          Ppat_var "app" (lib/shape.ml[221,6483+4]..[221,6483+7])
        expression (lib/shape.ml[221,6483+8]..[222,6505+34]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[221,6483+8]..[221,6483+12])
              Optional "uid"
              None
              pattern (lib/shape.ml[221,6483+9]..[221,6483+12])
                Ppat_var "uid" (lib/shape.ml[221,6483+9]..[221,6483+12])
            Pparam_val (lib/shape.ml[221,6483+13]..[221,6483+14])
              Nolabel
              None
              pattern (lib/shape.ml[221,6483+13]..[221,6483+14])
                Ppat_var "f" (lib/shape.ml[221,6483+13]..[221,6483+14])
            Pparam_val (lib/shape.ml[221,6483+15]..[221,6483+19])
              Labelled "arg"
              None
              pattern (lib/shape.ml[221,6483+16]..[221,6483+19])
                Ppat_var "arg" (lib/shape.ml[221,6483+16]..[221,6483+19])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[222,6505+6]..[222,6505+34])
              Pexp_record
              [
                "uid" (lib/shape.ml[222,6505+8]..[222,6505+11]) ghost
                  expression (lib/shape.ml[222,6505+8]..[222,6505+11])
                    Pexp_ident "uid" (lib/shape.ml[222,6505+8]..[222,6505+11])
                "desc" (lib/shape.ml[222,6505+13]..[222,6505+17])
                  expression (lib/shape.ml[222,6505+20]..[222,6505+32])
                    Pexp_construct "App" (lib/shape.ml[222,6505+20]..[222,6505+23])
                    Some
                      expression (lib/shape.ml[222,6505+24]..[222,6505+32])
                        Pexp_tuple
                        [
                          expression (lib/shape.ml[222,6505+25]..[222,6505+26])
                            Pexp_ident "f" (lib/shape.ml[222,6505+25]..[222,6505+26])
                          expression (lib/shape.ml[222,6505+28]..[222,6505+31])
                            Pexp_ident "arg" (lib/shape.ml[222,6505+28]..[222,6505+31])
                        ]
              ]
              None
    ]
  structure_item (lib/shape.ml[224,6541+0]..[227,6613+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[224,6541+4]..[224,6541+17])
          Ppat_var "decompose_abs" (lib/shape.ml[224,6541+4]..[224,6541+17])
        expression (lib/shape.ml[224,6541+18]..[227,6613+13]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[224,6541+18]..[224,6541+19])
              Nolabel
              None
              pattern (lib/shape.ml[224,6541+18]..[224,6541+19])
                Ppat_var "t" (lib/shape.ml[224,6541+18]..[224,6541+19])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[225,6563+2]..[227,6613+13])
              Pexp_match
              expression (lib/shape.ml[225,6563+8]..[225,6563+14])
                Pexp_field
                expression (lib/shape.ml[225,6563+8]..[225,6563+9])
                  Pexp_ident "t" (lib/shape.ml[225,6563+8]..[225,6563+9])
                "desc" (lib/shape.ml[225,6563+10]..[225,6563+14])
              [
                <case>
                  pattern (lib/shape.ml[226,6583+4]..[226,6583+14])
                    Ppat_construct "Abs" (lib/shape.ml[226,6583+4]..[226,6583+7])
                    Some
                      []
                      pattern (lib/shape.ml[226,6583+8]..[226,6583+14])
                        Ppat_tuple
                        [
                          pattern (lib/shape.ml[226,6583+9]..[226,6583+10])
                            Ppat_var "x" (lib/shape.ml[226,6583+9]..[226,6583+10])
                          pattern (lib/shape.ml[226,6583+12]..[226,6583+13])
                            Ppat_var "t" (lib/shape.ml[226,6583+12]..[226,6583+13])
                        ]
                  expression (lib/shape.ml[226,6583+18]..[226,6583+29])
                    Pexp_construct "Some" (lib/shape.ml[226,6583+18]..[226,6583+22])
                    Some
                      expression (lib/shape.ml[226,6583+23]..[226,6583+29])
                        Pexp_tuple
                        [
                          expression (lib/shape.ml[226,6583+24]..[226,6583+25])
                            Pexp_ident "x" (lib/shape.ml[226,6583+24]..[226,6583+25])
                          expression (lib/shape.ml[226,6583+27]..[226,6583+28])
                            Pexp_ident "t" (lib/shape.ml[226,6583+27]..[226,6583+28])
                        ]
                <case>
                  pattern (lib/shape.ml[227,6613+4]..[227,6613+5])
                    Ppat_any
                  expression (lib/shape.ml[227,6613+9]..[227,6613+13])
                    Pexp_construct "None" (lib/shape.ml[227,6613+9]..[227,6613+13])
                    None
              ]
    ]
  structure_item (lib/shape.ml[229,6628+0]..[450,15237+3])
    Pstr_module
    "Make_reduce" (lib/shape.ml[229,6628+7]..[229,6628+18])
      module_expr (lib/shape.ml[229,6628+18]..[450,15237+3])
        Pmod_functor "Params" (lib/shape.ml[229,6628+19]..[229,6628+25])
        module_type (lib/shape.ml[229,6628+28]..[234,6780+3])
          Pmty_signature
          [
            signature_item (lib/shape.ml[230,6660+2]..[230,6660+10])
              Psig_type Rec
              [
                type_declaration "env" (lib/shape.ml[230,6660+7]..[230,6660+10]) (lib/shape.ml[230,6660+2]..[230,6660+10])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            signature_item (lib/shape.ml[231,6671+2]..[231,6671+16])
              Psig_value
              value_description "fuel" (lib/shape.ml[231,6671+6]..[231,6671+10]) (lib/shape.ml[231,6671+2]..[231,6671+16])
                core_type (lib/shape.ml[231,6671+13]..[231,6671+16])
                  Ptyp_constr "int" (lib/shape.ml[231,6671+13]..[231,6671+16])
                  []
                []
            signature_item (lib/shape.ml[232,6688+2]..[232,6688+52])
              Psig_value
              value_description "read_unit_shape" (lib/shape.ml[232,6688+6]..[232,6688+21]) (lib/shape.ml[232,6688+2]..[232,6688+52])
                core_type (lib/shape.ml[232,6688+24]..[232,6688+52])
                  Ptyp_arrow
                  Labelled "unit_name"
                  core_type (lib/shape.ml[232,6688+34]..[232,6688+40])
                    Ptyp_constr "string" (lib/shape.ml[232,6688+34]..[232,6688+40])
                    []
                  core_type (lib/shape.ml[232,6688+44]..[232,6688+52])
                    Ptyp_constr "option" (lib/shape.ml[232,6688+46]..[232,6688+52])
                    [
                      core_type (lib/shape.ml[232,6688+44]..[232,6688+45])
                        Ptyp_constr "t" (lib/shape.ml[232,6688+44]..[232,6688+45])
                        []
                    ]
                []
            signature_item (lib/shape.ml[233,6741+2]..[233,6741+38])
              Psig_value
              value_description "find_shape" (lib/shape.ml[233,6741+6]..[233,6741+16]) (lib/shape.ml[233,6741+2]..[233,6741+38])
                core_type (lib/shape.ml[233,6741+19]..[233,6741+38])
                  Ptyp_arrow
                  Nolabel
                  core_type (lib/shape.ml[233,6741+19]..[233,6741+22])
                    Ptyp_constr "env" (lib/shape.ml[233,6741+19]..[233,6741+22])
                    []
                  core_type (lib/shape.ml[233,6741+26]..[233,6741+38])
                    Ptyp_arrow
                    Nolabel
                    core_type (lib/shape.ml[233,6741+26]..[233,6741+33])
                      Ptyp_constr "Ident.t" (lib/shape.ml[233,6741+26]..[233,6741+33])
                      []
                    core_type (lib/shape.ml[233,6741+37]..[233,6741+38])
                      Ptyp_constr "t" (lib/shape.ml[233,6741+37]..[233,6741+38])
                      []
                []
          ]
        module_expr (lib/shape.ml[234,6780+7]..[450,15237+3])
          Pmod_structure
          [
            structure_item (lib/shape.ml[238,6903+2]..[268,8077+47])
              Pstr_type Rec
              [
                type_declaration "nf" (lib/shape.ml[238,6903+7]..[238,6903+9]) (lib/shape.ml[238,6903+2]..[238,6903+48])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_record
                      [
                        (lib/shape.ml[238,6903+14]..[238,6903+32])
                          Immutable
                          "uid" (lib/shape.ml[238,6903+14]..[238,6903+17])                          core_type (lib/shape.ml[238,6903+19]..[238,6903+31])
                            Ptyp_constr "option" (lib/shape.ml[238,6903+25]..[238,6903+31])
                            [
                              core_type (lib/shape.ml[238,6903+19]..[238,6903+24])
                                Ptyp_constr "Uid.t" (lib/shape.ml[238,6903+19]..[238,6903+24])
                                []
                            ]
                        (lib/shape.ml[238,6903+33]..[238,6903+46])
                          Immutable
                          "desc" (lib/shape.ml[238,6903+33]..[238,6903+37])                          core_type (lib/shape.ml[238,6903+39]..[238,6903+46])
                            Ptyp_constr "nf_desc" (lib/shape.ml[238,6903+39]..[238,6903+46])
                            []
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
                type_declaration "nf_desc" (lib/shape.ml[239,6952+6]..[239,6952+13]) (lib/shape.ml[239,6952+2]..[247,7160+24])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (lib/shape.ml[240,6968+4]..[240,6968+17])
                          "NVar" (lib/shape.ml[240,6968+6]..[240,6968+10])
                          [
                            core_type (lib/shape.ml[240,6968+14]..[240,6968+17])
                              Ptyp_constr "var" (lib/shape.ml[240,6968+14]..[240,6968+17])
                              []
                          ]
                          None
                        (lib/shape.ml[241,6986+4]..[241,6986+21])
                          "NApp" (lib/shape.ml[241,6986+6]..[241,6986+10])
                          [
                            core_type (lib/shape.ml[241,6986+14]..[241,6986+16])
                              Ptyp_constr "nf" (lib/shape.ml[241,6986+14]..[241,6986+16])
                              []
                            core_type (lib/shape.ml[241,6986+19]..[241,6986+21])
                              Ptyp_constr "nf" (lib/shape.ml[241,6986+19]..[241,6986+21])
                              []
                          ]
                          None
                        (lib/shape.ml[242,7008+4]..[242,7008+46])
                          "NAbs" (lib/shape.ml[242,7008+6]..[242,7008+10])
                          [
                            core_type (lib/shape.ml[242,7008+14]..[242,7008+23])
                              Ptyp_constr "local_env" (lib/shape.ml[242,7008+14]..[242,7008+23])
                              []
                            core_type (lib/shape.ml[242,7008+26]..[242,7008+29])
                              Ptyp_constr "var" (lib/shape.ml[242,7008+26]..[242,7008+29])
                              []
                            core_type (lib/shape.ml[242,7008+32]..[242,7008+33])
                              Ptyp_constr "t" (lib/shape.ml[242,7008+32]..[242,7008+33])
                              []
                            core_type (lib/shape.ml[242,7008+36]..[242,7008+46])
                              Ptyp_constr "delayed_nf" (lib/shape.ml[242,7008+36]..[242,7008+46])
                              []
                          ]
                          None
                        (lib/shape.ml[243,7055+4]..[243,7055+38])
                          "NStruct" (lib/shape.ml[243,7055+6]..[243,7055+13])
                          [
                            core_type (lib/shape.ml[243,7055+17]..[243,7055+38])
                              Ptyp_constr "Item.Map.t" (lib/shape.ml[243,7055+28]..[243,7055+38])
                              [
                                core_type (lib/shape.ml[243,7055+17]..[243,7055+27])
                                  Ptyp_constr "delayed_nf" (lib/shape.ml[243,7055+17]..[243,7055+27])
                                  []
                              ]
                          ]
                          None
                        (lib/shape.ml[244,7094+4]..[244,7094+26])
                          "NProj" (lib/shape.ml[244,7094+6]..[244,7094+11])
                          [
                            core_type (lib/shape.ml[244,7094+15]..[244,7094+17])
                              Ptyp_constr "nf" (lib/shape.ml[244,7094+15]..[244,7094+17])
                              []
                            core_type (lib/shape.ml[244,7094+20]..[244,7094+26])
                              Ptyp_constr "Item.t" (lib/shape.ml[244,7094+20]..[244,7094+26])
                              []
                          ]
                          None
                        (lib/shape.ml[245,7121+4]..[245,7121+11])
                          "NLeaf" (lib/shape.ml[245,7121+6]..[245,7121+11])
                          []
                          None
                        (lib/shape.ml[246,7133+4]..[246,7133+26])
                          "NComp_unit" (lib/shape.ml[246,7133+6]..[246,7133+16])
                          [
                            core_type (lib/shape.ml[246,7133+20]..[246,7133+26])
                              Ptyp_constr "string" (lib/shape.ml[246,7133+20]..[246,7133+26])
                              []
                          ]
                          None
                        (lib/shape.ml[247,7160+4]..[247,7160+24])
                          "NoFuelLeft" (lib/shape.ml[247,7160+6]..[247,7160+16])
                          [
                            core_type (lib/shape.ml[247,7160+20]..[247,7160+24])
                              Ptyp_constr "desc" (lib/shape.ml[247,7160+20]..[247,7160+24])
                              []
                          ]
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
                type_declaration "delayed_nf" (lib/shape.ml[266,8034+6]..[266,8034+16]) (lib/shape.ml[266,8034+2]..[266,8034+41])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (lib/shape.ml[266,8034+19]..[266,8034+41])
                          "Thunk" (lib/shape.ml[266,8034+19]..[266,8034+24])
                          [
                            core_type (lib/shape.ml[266,8034+28]..[266,8034+37])
                              Ptyp_constr "local_env" (lib/shape.ml[266,8034+28]..[266,8034+37])
                              []
                            core_type (lib/shape.ml[266,8034+40]..[266,8034+41])
                              Ptyp_constr "t" (lib/shape.ml[266,8034+40]..[266,8034+41])
                              []
                          ]
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
                type_declaration "local_env" (lib/shape.ml[268,8077+6]..[268,8077+15]) (lib/shape.ml[268,8077+2]..[268,8077+47])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (lib/shape.ml[268,8077+18]..[268,8077+47])
                        Ptyp_constr "Ident.Map.t" (lib/shape.ml[268,8077+36]..[268,8077+47])
                        [
                          core_type (lib/shape.ml[268,8077+18]..[268,8077+35])
                            Ptyp_constr "option" (lib/shape.ml[268,8077+29]..[268,8077+35])
                            [
                              core_type (lib/shape.ml[268,8077+18]..[268,8077+28])
                                Ptyp_constr "delayed_nf" (lib/shape.ml[268,8077+18]..[268,8077+28])
                                []
                            ]
                        ]
              ]
            structure_item (lib/shape.ml[274,8399+2]..[277,8474+29])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[274,8399+6]..[274,8399+17])
                    Ppat_var "improve_uid" (lib/shape.ml[274,8399+6]..[274,8399+17])
                  expression (lib/shape.ml[274,8399+18]..[277,8474+29]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[274,8399+18]..[274,8399+21])
                        Nolabel
                        None
                        pattern (lib/shape.ml[274,8399+18]..[274,8399+21])
                          Ppat_var "uid" (lib/shape.ml[274,8399+18]..[274,8399+21])
                      Pparam_val (lib/shape.ml[274,8399+22]..[274,8399+31])
                        Nolabel
                        None
                        pattern (lib/shape.ml[274,8399+22]..[274,8399+31])
                          Ppat_constraint
                          pattern (lib/shape.ml[274,8399+23]..[274,8399+25])
                            Ppat_var "nf" (lib/shape.ml[274,8399+23]..[274,8399+25])
                          core_type (lib/shape.ml[274,8399+28]..[274,8399+30])
                            Ptyp_constr "nf" (lib/shape.ml[274,8399+28]..[274,8399+30])
                            []
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[275,8433+4]..[277,8474+29])
                        Pexp_match
                        expression (lib/shape.ml[275,8433+10]..[275,8433+16])
                          Pexp_field
                          expression (lib/shape.ml[275,8433+10]..[275,8433+12])
                            Pexp_ident "nf" (lib/shape.ml[275,8433+10]..[275,8433+12])
                          "uid" (lib/shape.ml[275,8433+13]..[275,8433+16])
                        [
                          <case>
                            pattern (lib/shape.ml[276,8455+6]..[276,8455+12])
                              Ppat_construct "Some" (lib/shape.ml[276,8455+6]..[276,8455+10])
                              Some
                                []
                                pattern (lib/shape.ml[276,8455+11]..[276,8455+12])
                                  Ppat_any
                            expression (lib/shape.ml[276,8455+16]..[276,8455+18])
                              Pexp_ident "nf" (lib/shape.ml[276,8455+16]..[276,8455+18])
                          <case>
                            pattern (lib/shape.ml[277,8474+6]..[277,8474+10])
                              Ppat_construct "None" (lib/shape.ml[277,8474+6]..[277,8474+10])
                              None
                            expression (lib/shape.ml[277,8474+14]..[277,8474+29])
                              Pexp_record
                              [
                                "uid" (lib/shape.ml[277,8474+24]..[277,8474+27]) ghost
                                  expression (lib/shape.ml[277,8474+24]..[277,8474+27])
                                    Pexp_ident "uid" (lib/shape.ml[277,8474+24]..[277,8474+27])
                              ]
                              Some
                                expression (lib/shape.ml[277,8474+16]..[277,8474+18])
                                  Pexp_ident "nf" (lib/shape.ml[277,8474+16]..[277,8474+18])
                        ]
              ]
            structure_item (lib/shape.ml[279,8505+2]..[285,8723+11])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[279,8505+6]..[279,8505+19])
                    Ppat_var "in_memo_table" (lib/shape.ml[279,8505+6]..[279,8505+19])
                  expression (lib/shape.ml[279,8505+20]..[285,8723+11]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[279,8505+20]..[279,8505+30])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8505+20]..[279,8505+30])
                          Ppat_var "memo_table" (lib/shape.ml[279,8505+20]..[279,8505+30])
                      Pparam_val (lib/shape.ml[279,8505+31]..[279,8505+39])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8505+31]..[279,8505+39])
                          Ppat_var "memo_key" (lib/shape.ml[279,8505+31]..[279,8505+39])
                      Pparam_val (lib/shape.ml[279,8505+40]..[279,8505+41])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8505+40]..[279,8505+41])
                          Ppat_var "f" (lib/shape.ml[279,8505+40]..[279,8505+41])
                      Pparam_val (lib/shape.ml[279,8505+42]..[279,8505+45])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8505+42]..[279,8505+45])
                          Ppat_var "arg" (lib/shape.ml[279,8505+42]..[279,8505+45])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[280,8553+4]..[285,8723+11])
                        Pexp_match
                        expression (lib/shape.ml[280,8553+10]..[280,8553+42])
                          Pexp_apply
                          expression (lib/shape.ml[280,8553+10]..[280,8553+22])
                            Pexp_ident "Hashtbl.find" (lib/shape.ml[280,8553+10]..[280,8553+22])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[280,8553+23]..[280,8553+33])
                                Pexp_ident "memo_table" (lib/shape.ml[280,8553+23]..[280,8553+33])
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[280,8553+34]..[280,8553+42])
                                Pexp_ident "memo_key" (lib/shape.ml[280,8553+34]..[280,8553+42])
                          ]
                        [
                          <case>
                            pattern (lib/shape.ml[281,8601+6]..[281,8601+9])
                              Ppat_var "res" (lib/shape.ml[281,8601+6]..[281,8601+9])
                            expression (lib/shape.ml[281,8601+13]..[281,8601+16])
                              Pexp_ident "res" (lib/shape.ml[281,8601+13]..[281,8601+16])
                          <case>
                            pattern (lib/shape.ml[282,8618+6]..[282,8618+25])
                              Ppat_exception
                              pattern (lib/shape.ml[282,8618+16]..[282,8618+25])
                                Ppat_construct "Not_found" (lib/shape.ml[282,8618+16]..[282,8618+25])
                                None
                            expression (lib/shape.ml[283,8647+8]..[285,8723+11])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[283,8647+12]..[283,8647+15])
                                    Ppat_var "res" (lib/shape.ml[283,8647+12]..[283,8647+15])
                                  expression (lib/shape.ml[283,8647+18]..[283,8647+23])
                                    Pexp_apply
                                    expression (lib/shape.ml[283,8647+18]..[283,8647+19])
                                      Pexp_ident "f" (lib/shape.ml[283,8647+18]..[283,8647+19])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[283,8647+20]..[283,8647+23])
                                          Pexp_ident "arg" (lib/shape.ml[283,8647+20]..[283,8647+23])
                                    ]
                              ]
                              expression (lib/shape.ml[284,8674+8]..[285,8723+11])
                                Pexp_sequence
                                expression (lib/shape.ml[284,8674+8]..[284,8674+47])
                                  Pexp_apply
                                  expression (lib/shape.ml[284,8674+8]..[284,8674+23])
                                    Pexp_ident "Hashtbl.replace" (lib/shape.ml[284,8674+8]..[284,8674+23])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[284,8674+24]..[284,8674+34])
                                        Pexp_ident "memo_table" (lib/shape.ml[284,8674+24]..[284,8674+34])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[284,8674+35]..[284,8674+43])
                                        Pexp_ident "memo_key" (lib/shape.ml[284,8674+35]..[284,8674+43])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[284,8674+44]..[284,8674+47])
                                        Pexp_ident "res" (lib/shape.ml[284,8674+44]..[284,8674+47])
                                  ]
                                expression (lib/shape.ml[285,8723+8]..[285,8723+11])
                                  Pexp_ident "res" (lib/shape.ml[285,8723+8]..[285,8723+11])
                        ]
              ]
            structure_item (lib/shape.ml[287,8736+2]..[293,8923+3])
              Pstr_type Rec
              [
                type_declaration "env" (lib/shape.ml[287,8736+7]..[287,8736+10]) (lib/shape.ml[287,8736+2]..[293,8923+3])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_record
                      [
                        (lib/shape.ml[288,8751+4]..[288,8751+18])
                          Immutable
                          "fuel" (lib/shape.ml[288,8751+4]..[288,8751+8])                          core_type (lib/shape.ml[288,8751+10]..[288,8751+17])
                            Ptyp_constr "ref" (lib/shape.ml[288,8751+14]..[288,8751+17])
                            [
                              core_type (lib/shape.ml[288,8751+10]..[288,8751+13])
                                Ptyp_constr "int" (lib/shape.ml[288,8751+10]..[288,8751+13])
                                []
                            ]
                        (lib/shape.ml[289,8770+4]..[289,8770+27])
                          Immutable
                          "global_env" (lib/shape.ml[289,8770+4]..[289,8770+14])                          core_type (lib/shape.ml[289,8770+16]..[289,8770+26])
                            Ptyp_constr "Params.env" (lib/shape.ml[289,8770+16]..[289,8770+26])
                            []
                        (lib/shape.ml[290,8798+4]..[290,8798+25])
                          Immutable
                          "local_env" (lib/shape.ml[290,8798+4]..[290,8798+13])                          core_type (lib/shape.ml[290,8798+15]..[290,8798+24])
                            Ptyp_constr "local_env" (lib/shape.ml[290,8798+15]..[290,8798+24])
                            []
                        (lib/shape.ml[291,8824+4]..[291,8824+53])
                          Immutable
                          "reduce_memo_table" (lib/shape.ml[291,8824+4]..[291,8824+21])                          core_type (lib/shape.ml[291,8824+23]..[291,8824+52])
                            Ptyp_constr "Hashtbl.t" (lib/shape.ml[291,8824+43]..[291,8824+52])
                            [
                              core_type (lib/shape.ml[291,8824+24]..[291,8824+37])
                                Ptyp_tuple
                                [
                                  core_type (lib/shape.ml[291,8824+24]..[291,8824+33])
                                    Ptyp_constr "local_env" (lib/shape.ml[291,8824+24]..[291,8824+33])
                                    []
                                  core_type (lib/shape.ml[291,8824+36]..[291,8824+37])
                                    Ptyp_constr "t" (lib/shape.ml[291,8824+36]..[291,8824+37])
                                    []
                                ]
                              core_type (lib/shape.ml[291,8824+39]..[291,8824+41])
                                Ptyp_constr "nf" (lib/shape.ml[291,8824+39]..[291,8824+41])
                                []
                            ]
                        (lib/shape.ml[292,8878+4]..[292,8878+44])
                          Immutable
                          "read_back_memo_table" (lib/shape.ml[292,8878+4]..[292,8878+24])                          core_type (lib/shape.ml[292,8878+26]..[292,8878+43])
                            Ptyp_constr "Hashtbl.t" (lib/shape.ml[292,8878+34]..[292,8878+43])
                            [
                              core_type (lib/shape.ml[292,8878+27]..[292,8878+29])
                                Ptyp_constr "nf" (lib/shape.ml[292,8878+27]..[292,8878+29])
                                []
                              core_type (lib/shape.ml[292,8878+31]..[292,8878+32])
                                Ptyp_constr "t" (lib/shape.ml[292,8878+31]..[292,8878+32])
                                []
                            ]
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            structure_item (lib/shape.ml[295,8928+2]..[296,8955+66])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[295,8928+6]..[295,8928+10])
                    Ppat_var "bind" (lib/shape.ml[295,8928+6]..[295,8928+10])
                  expression (lib/shape.ml[295,8928+11]..[296,8955+66]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[295,8928+11]..[295,8928+14])
                        Nolabel
                        None
                        pattern (lib/shape.ml[295,8928+11]..[295,8928+14])
                          Ppat_var "env" (lib/shape.ml[295,8928+11]..[295,8928+14])
                      Pparam_val (lib/shape.ml[295,8928+15]..[295,8928+18])
                        Nolabel
                        None
                        pattern (lib/shape.ml[295,8928+15]..[295,8928+18])
                          Ppat_var "var" (lib/shape.ml[295,8928+15]..[295,8928+18])
                      Pparam_val (lib/shape.ml[295,8928+19]..[295,8928+24])
                        Nolabel
                        None
                        pattern (lib/shape.ml[295,8928+19]..[295,8928+24])
                          Ppat_var "shape" (lib/shape.ml[295,8928+19]..[295,8928+24])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[296,8955+4]..[296,8955+66])
                        Pexp_record
                        [
                          "local_env" (lib/shape.ml[296,8955+15]..[296,8955+24])
                            expression (lib/shape.ml[296,8955+27]..[296,8955+64])
                              Pexp_apply
                              expression (lib/shape.ml[296,8955+27]..[296,8955+40])
                                Pexp_ident "Ident.Map.add" (lib/shape.ml[296,8955+27]..[296,8955+40])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[296,8955+41]..[296,8955+44])
                                    Pexp_ident "var" (lib/shape.ml[296,8955+41]..[296,8955+44])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[296,8955+45]..[296,8955+50])
                                    Pexp_ident "shape" (lib/shape.ml[296,8955+45]..[296,8955+50])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[296,8955+51]..[296,8955+64])
                                    Pexp_field
                                    expression (lib/shape.ml[296,8955+51]..[296,8955+54])
                                      Pexp_ident "env" (lib/shape.ml[296,8955+51]..[296,8955+54])
                                    "local_env" (lib/shape.ml[296,8955+55]..[296,8955+64])
                              ]
                        ]
                        Some
                          expression (lib/shape.ml[296,8955+6]..[296,8955+9])
                            Pexp_ident "env" (lib/shape.ml[296,8955+6]..[296,8955+9])
              ]
            structure_item (lib/shape.ml[298,9023+2]..[406,13830+30])
              Pstr_value Rec
              [
                <def>
                  pattern (lib/shape.ml[298,9023+10]..[298,9023+17])
                    Ppat_var "reduce_" (lib/shape.ml[298,9023+10]..[298,9023+17])
                  expression (lib/shape.ml[298,9023+18]..[300,9090+65]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[298,9023+18]..[298,9023+21])
                        Nolabel
                        None
                        pattern (lib/shape.ml[298,9023+18]..[298,9023+21])
                          Ppat_var "env" (lib/shape.ml[298,9023+18]..[298,9023+21])
                      Pparam_val (lib/shape.ml[298,9023+22]..[298,9023+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[298,9023+22]..[298,9023+23])
                          Ppat_var "t" (lib/shape.ml[298,9023+22]..[298,9023+23])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[299,9049+4]..[300,9090+65])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[299,9049+8]..[299,9049+16])
                              Ppat_var "memo_key" (lib/shape.ml[299,9049+8]..[299,9049+16])
                            expression (lib/shape.ml[299,9049+19]..[299,9049+37])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[299,9049+20]..[299,9049+33])
                                  Pexp_field
                                  expression (lib/shape.ml[299,9049+20]..[299,9049+23])
                                    Pexp_ident "env" (lib/shape.ml[299,9049+20]..[299,9049+23])
                                  "local_env" (lib/shape.ml[299,9049+24]..[299,9049+33])
                                expression (lib/shape.ml[299,9049+35]..[299,9049+36])
                                  Pexp_ident "t" (lib/shape.ml[299,9049+35]..[299,9049+36])
                              ]
                        ]
                        expression (lib/shape.ml[300,9090+4]..[300,9090+65])
                          Pexp_apply
                          expression (lib/shape.ml[300,9090+4]..[300,9090+17])
                            Pexp_ident "in_memo_table" (lib/shape.ml[300,9090+4]..[300,9090+17])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9090+18]..[300,9090+39])
                                Pexp_field
                                expression (lib/shape.ml[300,9090+18]..[300,9090+21])
                                  Pexp_ident "env" (lib/shape.ml[300,9090+18]..[300,9090+21])
                                "reduce_memo_table" (lib/shape.ml[300,9090+22]..[300,9090+39])
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9090+40]..[300,9090+48])
                                Pexp_ident "memo_key" (lib/shape.ml[300,9090+40]..[300,9090+48])
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9090+49]..[300,9090+63])
                                Pexp_apply
                                expression (lib/shape.ml[300,9090+50]..[300,9090+58])
                                  Pexp_ident "reduce__" (lib/shape.ml[300,9090+50]..[300,9090+58])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[300,9090+59]..[300,9090+62])
                                      Pexp_ident "env" (lib/shape.ml[300,9090+59]..[300,9090+62])
                                ]
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9090+64]..[300,9090+65])
                                Pexp_ident "t" (lib/shape.ml[300,9090+64]..[300,9090+65])
                          ]
                <def>
                  pattern (lib/shape.ml[339,11192+6]..[339,11192+14])
                    Ppat_var "reduce__" (lib/shape.ml[339,11192+6]..[339,11192+14])
                  expression (lib/shape.ml[339,11192+15]..[406,13830+30]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[339,11192+15]..[339,11192+56])
                        Nolabel
                        None
                        pattern (lib/shape.ml[339,11192+15]..[339,11192+56])
                          Ppat_alias "env" (lib/shape.ml[339,11192+52]..[339,11192+55])
                          pattern (lib/shape.ml[339,11192+16]..[339,11192+48])
                            Ppat_record Open
                            [
                              "fuel" (lib/shape.ml[339,11192+17]..[339,11192+21]) ghost
                                pattern (lib/shape.ml[339,11192+17]..[339,11192+21])
                                  Ppat_var "fuel" (lib/shape.ml[339,11192+17]..[339,11192+21])
                              "global_env" (lib/shape.ml[339,11192+23]..[339,11192+33]) ghost
                                pattern (lib/shape.ml[339,11192+23]..[339,11192+33])
                                  Ppat_var "global_env" (lib/shape.ml[339,11192+23]..[339,11192+33])
                              "local_env" (lib/shape.ml[339,11192+35]..[339,11192+44]) ghost
                                pattern (lib/shape.ml[339,11192+35]..[339,11192+44])
                                  Ppat_var "local_env" (lib/shape.ml[339,11192+35]..[339,11192+44])
                            ]
                      Pparam_val (lib/shape.ml[339,11192+57]..[339,11192+64])
                        Nolabel
                        None
                        pattern (lib/shape.ml[339,11192+57]..[339,11192+64])
                          Ppat_constraint
                          pattern (lib/shape.ml[339,11192+58]..[339,11192+59])
                            Ppat_var "t" (lib/shape.ml[339,11192+58]..[339,11192+59])
                          core_type (lib/shape.ml[339,11192+62]..[339,11192+63])
                            Ptyp_constr "t" (lib/shape.ml[339,11192+62]..[339,11192+63])
                            []
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[340,11259+4]..[406,13830+30])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[340,11259+8]..[340,11259+14])
                              Ppat_var "reduce" (lib/shape.ml[340,11259+8]..[340,11259+14])
                            expression (lib/shape.ml[340,11259+15]..[340,11259+36]) ghost
                              Pexp_function
                              [
                                Pparam_val (lib/shape.ml[340,11259+15]..[340,11259+18])
                                  Nolabel
                                  None
                                  pattern (lib/shape.ml[340,11259+15]..[340,11259+18])
                                    Ppat_var "env" (lib/shape.ml[340,11259+15]..[340,11259+18])
                                Pparam_val (lib/shape.ml[340,11259+19]..[340,11259+20])
                                  Nolabel
                                  None
                                  pattern (lib/shape.ml[340,11259+19]..[340,11259+20])
                                    Ppat_var "t" (lib/shape.ml[340,11259+19]..[340,11259+20])
                              ]
                              None
                              Pfunction_body
                                expression (lib/shape.ml[340,11259+23]..[340,11259+36])
                                  Pexp_apply
                                  expression (lib/shape.ml[340,11259+23]..[340,11259+30])
                                    Pexp_ident "reduce_" (lib/shape.ml[340,11259+23]..[340,11259+30])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[340,11259+31]..[340,11259+34])
                                        Pexp_ident "env" (lib/shape.ml[340,11259+31]..[340,11259+34])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[340,11259+35]..[340,11259+36])
                                        Pexp_ident "t" (lib/shape.ml[340,11259+35]..[340,11259+36])
                                  ]
                        ]
                        expression (lib/shape.ml[341,11299+4]..[406,13830+30])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (lib/shape.ml[341,11299+8]..[341,11299+20])
                                Ppat_var "delay_reduce" (lib/shape.ml[341,11299+8]..[341,11299+20])
                              expression (lib/shape.ml[341,11299+21]..[341,11299+53]) ghost
                                Pexp_function
                                [
                                  Pparam_val (lib/shape.ml[341,11299+21]..[341,11299+24])
                                    Nolabel
                                    None
                                    pattern (lib/shape.ml[341,11299+21]..[341,11299+24])
                                      Ppat_var "env" (lib/shape.ml[341,11299+21]..[341,11299+24])
                                  Pparam_val (lib/shape.ml[341,11299+25]..[341,11299+26])
                                    Nolabel
                                    None
                                    pattern (lib/shape.ml[341,11299+25]..[341,11299+26])
                                      Ppat_var "t" (lib/shape.ml[341,11299+25]..[341,11299+26])
                                ]
                                None
                                Pfunction_body
                                  expression (lib/shape.ml[341,11299+29]..[341,11299+53])
                                    Pexp_construct "Thunk" (lib/shape.ml[341,11299+29]..[341,11299+34])
                                    Some
                                      expression (lib/shape.ml[341,11299+35]..[341,11299+53])
                                        Pexp_tuple
                                        [
                                          expression (lib/shape.ml[341,11299+36]..[341,11299+49])
                                            Pexp_field
                                            expression (lib/shape.ml[341,11299+36]..[341,11299+39])
                                              Pexp_ident "env" (lib/shape.ml[341,11299+36]..[341,11299+39])
                                            "local_env" (lib/shape.ml[341,11299+40]..[341,11299+49])
                                          expression (lib/shape.ml[341,11299+51]..[341,11299+52])
                                            Pexp_ident "t" (lib/shape.ml[341,11299+51]..[341,11299+52])
                                        ]
                          ]
                          expression (lib/shape.ml[342,11356+4]..[406,13830+30])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (lib/shape.ml[342,11356+8]..[342,11356+13])
                                  Ppat_var "force" (lib/shape.ml[342,11356+8]..[342,11356+13])
                                expression (lib/shape.ml[342,11356+14]..[343,11395+37]) ghost
                                  Pexp_function
                                  [
                                    Pparam_val (lib/shape.ml[342,11356+14]..[342,11356+36])
                                      Nolabel
                                      None
                                      pattern (lib/shape.ml[342,11356+14]..[342,11356+36])
                                        Ppat_construct "Thunk" (lib/shape.ml[342,11356+15]..[342,11356+20])
                                        Some
                                          []
                                          pattern (lib/shape.ml[342,11356+21]..[342,11356+35])
                                            Ppat_tuple
                                            [
                                              pattern (lib/shape.ml[342,11356+22]..[342,11356+31])
                                                Ppat_var "local_env" (lib/shape.ml[342,11356+22]..[342,11356+31])
                                              pattern (lib/shape.ml[342,11356+33]..[342,11356+34])
                                                Ppat_var "t" (lib/shape.ml[342,11356+33]..[342,11356+34])
                                            ]
                                  ]
                                  None
                                  Pfunction_body
                                    expression (lib/shape.ml[343,11395+6]..[343,11395+37])
                                      Pexp_apply
                                      expression (lib/shape.ml[343,11395+6]..[343,11395+12])
                                        Pexp_ident "reduce" (lib/shape.ml[343,11395+6]..[343,11395+12])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[343,11395+13]..[343,11395+35])
                                            Pexp_record
                                            [
                                              "local_env" (lib/shape.ml[343,11395+24]..[343,11395+33]) ghost
                                                expression (lib/shape.ml[343,11395+24]..[343,11395+33])
                                                  Pexp_ident "local_env" (lib/shape.ml[343,11395+24]..[343,11395+33])
                                            ]
                                            Some
                                              expression (lib/shape.ml[343,11395+15]..[343,11395+18])
                                                Pexp_ident "env" (lib/shape.ml[343,11395+15]..[343,11395+18])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[343,11395+36]..[343,11395+37])
                                            Pexp_ident "t" (lib/shape.ml[343,11395+36]..[343,11395+37])
                                      ]
                            ]
                            expression (lib/shape.ml[344,11436+4]..[406,13830+30])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[344,11436+8]..[344,11436+14])
                                    Ppat_var "return" (lib/shape.ml[344,11436+8]..[344,11436+14])
                                  expression (lib/shape.ml[344,11436+15]..[344,11436+48]) ghost
                                    Pexp_function
                                    [
                                      Pparam_val (lib/shape.ml[344,11436+15]..[344,11436+19])
                                        Nolabel
                                        None
                                        pattern (lib/shape.ml[344,11436+15]..[344,11436+19])
                                          Ppat_var "desc" (lib/shape.ml[344,11436+15]..[344,11436+19])
                                    ]
                                    Some
                                      Pconstraint
                                        core_type (lib/shape.ml[344,11436+22]..[344,11436+24])
                                          Ptyp_constr "nf" (lib/shape.ml[344,11436+22]..[344,11436+24])
                                          []
                                    Pfunction_body
                                      expression (lib/shape.ml[344,11436+27]..[344,11436+48])
                                        Pexp_record
                                        [
                                          "uid" (lib/shape.ml[344,11436+29]..[344,11436+32])
                                            expression (lib/shape.ml[344,11436+35]..[344,11436+40])
                                              Pexp_field
                                              expression (lib/shape.ml[344,11436+35]..[344,11436+36])
                                                Pexp_ident "t" (lib/shape.ml[344,11436+35]..[344,11436+36])
                                              "uid" (lib/shape.ml[344,11436+37]..[344,11436+40])
                                          "desc" (lib/shape.ml[344,11436+42]..[344,11436+46]) ghost
                                            expression (lib/shape.ml[344,11436+42]..[344,11436+46])
                                              Pexp_ident "desc" (lib/shape.ml[344,11436+42]..[344,11436+46])
                                        ]
                                        None
                              ]
                              expression (lib/shape.ml[345,11488+4]..[406,13830+30])
                                Pexp_ifthenelse
                                expression (lib/shape.ml[345,11488+7]..[345,11488+16])
                                  Pexp_apply
                                  expression (lib/shape.ml[345,11488+13]..[345,11488+14])
                                    Pexp_ident "<" (lib/shape.ml[345,11488+13]..[345,11488+14])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[345,11488+7]..[345,11488+12])
                                        Pexp_apply
                                        expression (lib/shape.ml[345,11488+7]..[345,11488+8])
                                          Pexp_ident "!" (lib/shape.ml[345,11488+7]..[345,11488+8])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[345,11488+8]..[345,11488+12])
                                              Pexp_ident "fuel" (lib/shape.ml[345,11488+8]..[345,11488+12])
                                        ]
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[345,11488+15]..[345,11488+16])
                                        Pexp_constant PConst_int (0,None)
                                  ]
                                expression (lib/shape.ml[345,11488+22]..[345,11488+48])
                                  Pexp_apply
                                  expression (lib/shape.ml[345,11488+22]..[345,11488+28])
                                    Pexp_ident "return" (lib/shape.ml[345,11488+22]..[345,11488+28])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[345,11488+29]..[345,11488+48])
                                        Pexp_construct "NoFuelLeft" (lib/shape.ml[345,11488+30]..[345,11488+40])
                                        Some
                                          expression (lib/shape.ml[345,11488+41]..[345,11488+47])
                                            Pexp_field
                                            expression (lib/shape.ml[345,11488+41]..[345,11488+42])
                                              Pexp_ident "t" (lib/shape.ml[345,11488+41]..[345,11488+42])
                                            "desc" (lib/shape.ml[345,11488+43]..[345,11488+47])
                                  ]
                                Some
                                  expression (lib/shape.ml[347,11546+6]..[406,13830+30])
                                    Pexp_match
                                    expression (lib/shape.ml[347,11546+12]..[347,11546+18])
                                      Pexp_field
                                      expression (lib/shape.ml[347,11546+12]..[347,11546+13])
                                        Pexp_ident "t" (lib/shape.ml[347,11546+12]..[347,11546+13])
                                      "desc" (lib/shape.ml[347,11546+14]..[347,11546+18])
                                    [
                                      <case>
                                        pattern (lib/shape.ml[348,11570+8]..[348,11570+27])
                                          Ppat_construct "Comp_unit" (lib/shape.ml[348,11570+8]..[348,11570+17])
                                          Some
                                            []
                                            pattern (lib/shape.ml[348,11570+18]..[348,11570+27])
                                              Ppat_var "unit_name" (lib/shape.ml[348,11570+18]..[348,11570+27])
                                        expression (lib/shape.ml[349,11601+10]..[352,11747+13])
                                          Pexp_match
                                          expression (lib/shape.ml[349,11601+22]..[349,11601+55])
                                            Pexp_apply
                                            expression (lib/shape.ml[349,11601+22]..[349,11601+44])
                                              Pexp_ident "Params.read_unit_shape" (lib/shape.ml[349,11601+22]..[349,11601+44])
                                            [
                                              <arg>
                                              Labelled "unit_name"
                                                expression (lib/shape.ml[349,11601+46]..[349,11601+55])
                                                  Pexp_ident "unit_name" (lib/shape.ml[349,11601+46]..[349,11601+55])
                                            ]
                                          [
                                            <case>
                                              pattern (lib/shape.ml[350,11662+12]..[350,11662+18])
                                                Ppat_construct "Some" (lib/shape.ml[350,11662+12]..[350,11662+16])
                                                Some
                                                  []
                                                  pattern (lib/shape.ml[350,11662+17]..[350,11662+18])
                                                    Ppat_var "t" (lib/shape.ml[350,11662+17]..[350,11662+18])
                                              expression (lib/shape.ml[350,11662+22]..[350,11662+34])
                                                Pexp_apply
                                                expression (lib/shape.ml[350,11662+22]..[350,11662+28])
                                                  Pexp_ident "reduce" (lib/shape.ml[350,11662+22]..[350,11662+28])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[350,11662+29]..[350,11662+32])
                                                      Pexp_ident "env" (lib/shape.ml[350,11662+29]..[350,11662+32])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[350,11662+33]..[350,11662+34])
                                                      Pexp_ident "t" (lib/shape.ml[350,11662+33]..[350,11662+34])
                                                ]
                                            <case>
                                              pattern (lib/shape.ml[351,11697+12]..[351,11697+16])
                                                Ppat_construct "None" (lib/shape.ml[351,11697+12]..[351,11697+16])
                                                None
                                              expression (lib/shape.ml[351,11697+20]..[351,11697+49])
                                                Pexp_apply
                                                expression (lib/shape.ml[351,11697+20]..[351,11697+26])
                                                  Pexp_ident "return" (lib/shape.ml[351,11697+20]..[351,11697+26])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[351,11697+27]..[351,11697+49])
                                                      Pexp_construct "NComp_unit" (lib/shape.ml[351,11697+28]..[351,11697+38])
                                                      Some
                                                        expression (lib/shape.ml[351,11697+39]..[351,11697+48])
                                                          Pexp_ident "unit_name" (lib/shape.ml[351,11697+39]..[351,11697+48])
                                                ]
                                          ]
                                      <case>
                                        pattern (lib/shape.ml[353,11761+8]..[353,11761+19])
                                          Ppat_construct "App" (lib/shape.ml[353,11761+8]..[353,11761+11])
                                          Some
                                            []
                                            pattern (lib/shape.ml[353,11761+11]..[353,11761+19])
                                              Ppat_tuple
                                              [
                                                pattern (lib/shape.ml[353,11761+12]..[353,11761+13])
                                                  Ppat_var "f" (lib/shape.ml[353,11761+12]..[353,11761+13])
                                                pattern (lib/shape.ml[353,11761+15]..[353,11761+18])
                                                  Ppat_var "arg" (lib/shape.ml[353,11761+15]..[353,11761+18])
                                              ]
                                        expression (lib/shape.ml[354,11784+10]..[364,12192+13])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[354,11784+14]..[354,11784+15])
                                                Ppat_var "f" (lib/shape.ml[354,11784+14]..[354,11784+15])
                                              expression (lib/shape.ml[354,11784+18]..[354,11784+30])
                                                Pexp_apply
                                                expression (lib/shape.ml[354,11784+18]..[354,11784+24])
                                                  Pexp_ident "reduce" (lib/shape.ml[354,11784+18]..[354,11784+24])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[354,11784+25]..[354,11784+28])
                                                      Pexp_ident "env" (lib/shape.ml[354,11784+25]..[354,11784+28])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[354,11784+29]..[354,11784+30])
                                                      Pexp_ident "f" (lib/shape.ml[354,11784+29]..[354,11784+30])
                                                ]
                                          ]
                                          expression (lib/shape.ml[355,11818+10]..[364,12192+13])
                                            Pexp_match
                                            expression (lib/shape.ml[355,11818+22]..[355,11818+28])
                                              Pexp_field
                                              expression (lib/shape.ml[355,11818+22]..[355,11818+23])
                                                Pexp_ident "f" (lib/shape.ml[355,11818+22]..[355,11818+23])
                                              "desc" (lib/shape.ml[355,11818+24]..[355,11818+28])
                                            [
                                              <case>
                                                pattern (lib/shape.ml[356,11852+12]..[356,11852+47])
                                                  Ppat_construct "NAbs" (lib/shape.ml[356,11852+12]..[356,11852+16])
                                                  Some
                                                    []
                                                    pattern (lib/shape.ml[356,11852+16]..[356,11852+47])
                                                      Ppat_tuple
                                                      [
                                                        pattern (lib/shape.ml[356,11852+17]..[356,11852+25])
                                                          Ppat_var "clos_env" (lib/shape.ml[356,11852+17]..[356,11852+25])
                                                        pattern (lib/shape.ml[356,11852+27]..[356,11852+30])
                                                          Ppat_var "var" (lib/shape.ml[356,11852+27]..[356,11852+30])
                                                        pattern (lib/shape.ml[356,11852+32]..[356,11852+36])
                                                          Ppat_var "body" (lib/shape.ml[356,11852+32]..[356,11852+36])
                                                        pattern (lib/shape.ml[356,11852+38]..[356,11852+46])
                                                          Ppat_var "_body_nf" (lib/shape.ml[356,11852+38]..[356,11852+46])
                                                      ]
                                                expression (lib/shape.ml[357,11903+14]..[360,12062+34])
                                                  Pexp_let Nonrec
                                                  [
                                                    <def>
                                                      pattern (lib/shape.ml[357,11903+18]..[357,11903+21])
                                                        Ppat_var "arg" (lib/shape.ml[357,11903+18]..[357,11903+21])
                                                      expression (lib/shape.ml[357,11903+24]..[357,11903+44])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[357,11903+24]..[357,11903+36])
                                                          Pexp_ident "delay_reduce" (lib/shape.ml[357,11903+24]..[357,11903+36])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[357,11903+37]..[357,11903+40])
                                                              Pexp_ident "env" (lib/shape.ml[357,11903+37]..[357,11903+40])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[357,11903+41]..[357,11903+44])
                                                              Pexp_ident "arg" (lib/shape.ml[357,11903+41]..[357,11903+44])
                                                        ]
                                                  ]
                                                  expression (lib/shape.ml[358,11951+14]..[360,12062+34])
                                                    Pexp_let Nonrec
                                                    [
                                                      <def>
                                                        pattern (lib/shape.ml[358,11951+18]..[358,11951+21])
                                                          Ppat_var "env" (lib/shape.ml[358,11951+18]..[358,11951+21])
                                                        expression (lib/shape.ml[358,11951+24]..[358,11951+77])
                                                          Pexp_apply
                                                          expression (lib/shape.ml[358,11951+24]..[358,11951+28])
                                                            Pexp_ident "bind" (lib/shape.ml[358,11951+24]..[358,11951+28])
                                                          [
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[358,11951+29]..[358,11951+62])
                                                                Pexp_record
                                                                [
                                                                  "local_env" (lib/shape.ml[358,11951+40]..[358,11951+49])
                                                                    expression (lib/shape.ml[358,11951+52]..[358,11951+60])
                                                                      Pexp_ident "clos_env" (lib/shape.ml[358,11951+52]..[358,11951+60])
                                                                ]
                                                                Some
                                                                  expression (lib/shape.ml[358,11951+31]..[358,11951+34])
                                                                    Pexp_ident "env" (lib/shape.ml[358,11951+31]..[358,11951+34])
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[358,11951+63]..[358,11951+66])
                                                                Pexp_ident "var" (lib/shape.ml[358,11951+63]..[358,11951+66])
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[358,11951+67]..[358,11951+77])
                                                                Pexp_construct "Some" (lib/shape.ml[358,11951+68]..[358,11951+72])
                                                                Some
                                                                  expression (lib/shape.ml[358,11951+73]..[358,11951+76])
                                                                    Pexp_ident "arg" (lib/shape.ml[358,11951+73]..[358,11951+76])
                                                          ]
                                                    ]
                                                    expression (lib/shape.ml[359,12032+14]..[360,12062+34])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[360,12062+14]..[360,12062+16])
                                                        Pexp_ident "|>" (lib/shape.ml[360,12062+14]..[360,12062+16])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[359,12032+14]..[359,12032+29])
                                                            Pexp_apply
                                                            expression (lib/shape.ml[359,12032+14]..[359,12032+20])
                                                              Pexp_ident "reduce" (lib/shape.ml[359,12032+14]..[359,12032+20])
                                                            [
                                                              <arg>
                                                              Nolabel
                                                                expression (lib/shape.ml[359,12032+21]..[359,12032+24])
                                                                  Pexp_ident "env" (lib/shape.ml[359,12032+21]..[359,12032+24])
                                                              <arg>
                                                              Nolabel
                                                                expression (lib/shape.ml[359,12032+25]..[359,12032+29])
                                                                  Pexp_ident "body" (lib/shape.ml[359,12032+25]..[359,12032+29])
                                                            ]
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[360,12062+17]..[360,12062+34])
                                                            Pexp_apply
                                                            expression (lib/shape.ml[360,12062+17]..[360,12062+28])
                                                              Pexp_ident "improve_uid" (lib/shape.ml[360,12062+17]..[360,12062+28])
                                                            [
                                                              <arg>
                                                              Nolabel
                                                                expression (lib/shape.ml[360,12062+29]..[360,12062+34])
                                                                  Pexp_field
                                                                  expression (lib/shape.ml[360,12062+29]..[360,12062+30])
                                                                    Pexp_ident "t" (lib/shape.ml[360,12062+29]..[360,12062+30])
                                                                  "uid" (lib/shape.ml[360,12062+31]..[360,12062+34])
                                                            ]
                                                      ]
                                              <case>
                                                pattern (lib/shape.ml[361,12097+12]..[361,12097+13])
                                                  Ppat_any
                                                expression (lib/shape.ml[362,12114+14]..[363,12156+35])
                                                  Pexp_let Nonrec
                                                  [
                                                    <def>
                                                      pattern (lib/shape.ml[362,12114+18]..[362,12114+21])
                                                        Ppat_var "arg" (lib/shape.ml[362,12114+18]..[362,12114+21])
                                                      expression (lib/shape.ml[362,12114+24]..[362,12114+38])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[362,12114+24]..[362,12114+30])
                                                          Pexp_ident "reduce" (lib/shape.ml[362,12114+24]..[362,12114+30])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[362,12114+31]..[362,12114+34])
                                                              Pexp_ident "env" (lib/shape.ml[362,12114+31]..[362,12114+34])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[362,12114+35]..[362,12114+38])
                                                              Pexp_ident "arg" (lib/shape.ml[362,12114+35]..[362,12114+38])
                                                        ]
                                                  ]
                                                  expression (lib/shape.ml[363,12156+14]..[363,12156+35])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[363,12156+14]..[363,12156+20])
                                                      Pexp_ident "return" (lib/shape.ml[363,12156+14]..[363,12156+20])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[363,12156+21]..[363,12156+35])
                                                          Pexp_construct "NApp" (lib/shape.ml[363,12156+22]..[363,12156+26])
                                                          Some
                                                            expression (lib/shape.ml[363,12156+26]..[363,12156+34])
                                                              Pexp_tuple
                                                              [
                                                                expression (lib/shape.ml[363,12156+27]..[363,12156+28])
                                                                  Pexp_ident "f" (lib/shape.ml[363,12156+27]..[363,12156+28])
                                                                expression (lib/shape.ml[363,12156+30]..[363,12156+33])
                                                                  Pexp_ident "arg" (lib/shape.ml[363,12156+30]..[363,12156+33])
                                                              ]
                                                    ]
                                            ]
                                      <case>
                                        pattern (lib/shape.ml[365,12206+8]..[365,12206+23])
                                          Ppat_construct "Proj" (lib/shape.ml[365,12206+8]..[365,12206+12])
                                          Some
                                            []
                                            pattern (lib/shape.ml[365,12206+12]..[365,12206+23])
                                              Ppat_tuple
                                              [
                                                pattern (lib/shape.ml[365,12206+13]..[365,12206+16])
                                                  Ppat_var "str" (lib/shape.ml[365,12206+13]..[365,12206+16])
                                                pattern (lib/shape.ml[365,12206+18]..[365,12206+22])
                                                  Ppat_var "item" (lib/shape.ml[365,12206+18]..[365,12206+22])
                                              ]
                                        expression (lib/shape.ml[366,12233+10]..[378,12642+13])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[366,12233+14]..[366,12233+17])
                                                Ppat_var "str" (lib/shape.ml[366,12233+14]..[366,12233+17])
                                              expression (lib/shape.ml[366,12233+20]..[366,12233+34])
                                                Pexp_apply
                                                expression (lib/shape.ml[366,12233+20]..[366,12233+26])
                                                  Pexp_ident "reduce" (lib/shape.ml[366,12233+20]..[366,12233+26])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[366,12233+27]..[366,12233+30])
                                                      Pexp_ident "env" (lib/shape.ml[366,12233+27]..[366,12233+30])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[366,12233+31]..[366,12233+34])
                                                      Pexp_ident "str" (lib/shape.ml[366,12233+31]..[366,12233+34])
                                                ]
                                          ]
                                          expression (lib/shape.ml[367,12271+10]..[378,12642+13])
                                            Pexp_let Nonrec
                                            [
                                              <def>
                                                pattern (lib/shape.ml[367,12271+14]..[367,12271+19])
                                                  Ppat_var "nored" (lib/shape.ml[367,12271+14]..[367,12271+19])
                                                expression (lib/shape.ml[367,12271+20]..[367,12271+50]) ghost
                                                  Pexp_function
                                                  [
                                                    Pparam_val (lib/shape.ml[367,12271+20]..[367,12271+22])
                                                      Nolabel
                                                      None
                                                      pattern (lib/shape.ml[367,12271+20]..[367,12271+22])
                                                        Ppat_construct "()" (lib/shape.ml[367,12271+20]..[367,12271+22])
                                                        None
                                                  ]
                                                  None
                                                  Pfunction_body
                                                    expression (lib/shape.ml[367,12271+25]..[367,12271+50])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[367,12271+25]..[367,12271+31])
                                                        Pexp_ident "return" (lib/shape.ml[367,12271+25]..[367,12271+31])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[367,12271+32]..[367,12271+50])
                                                            Pexp_construct "NProj" (lib/shape.ml[367,12271+33]..[367,12271+38])
                                                            Some
                                                              expression (lib/shape.ml[367,12271+38]..[367,12271+49])
                                                                Pexp_tuple
                                                                [
                                                                  expression (lib/shape.ml[367,12271+39]..[367,12271+42])
                                                                    Pexp_ident "str" (lib/shape.ml[367,12271+39]..[367,12271+42])
                                                                  expression (lib/shape.ml[367,12271+44]..[367,12271+48])
                                                                    Pexp_ident "item" (lib/shape.ml[367,12271+44]..[367,12271+48])
                                                                ]
                                                      ]
                                            ]
                                            expression (lib/shape.ml[368,12325+10]..[378,12642+13])
                                              Pexp_match
                                              expression (lib/shape.ml[368,12325+22]..[368,12325+30])
                                                Pexp_field
                                                expression (lib/shape.ml[368,12325+22]..[368,12325+25])
                                                  Pexp_ident "str" (lib/shape.ml[368,12325+22]..[368,12325+25])
                                                "desc" (lib/shape.ml[368,12325+26]..[368,12325+30])
                                              [
                                                <case>
                                                  pattern (lib/shape.ml[369,12361+12]..[369,12361+27])
                                                    Ppat_construct "NStruct" (lib/shape.ml[369,12361+12]..[369,12361+19])
                                                    Some
                                                      []
                                                      pattern (lib/shape.ml[369,12361+20]..[369,12361+27])
                                                        Ppat_var "items" (lib/shape.ml[369,12361+21]..[369,12361+26])
                                                  expression (lib/shape.ml[370,12392+14]..[375,12584+17])
                                                    Pexp_match
                                                    expression (lib/shape.ml[370,12392+26]..[370,12392+50])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[370,12392+26]..[370,12392+39])
                                                        Pexp_ident "Item.Map.find" (lib/shape.ml[370,12392+26]..[370,12392+39])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[370,12392+40]..[370,12392+44])
                                                            Pexp_ident "item" (lib/shape.ml[370,12392+40]..[370,12392+44])
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[370,12392+45]..[370,12392+50])
                                                            Pexp_ident "items" (lib/shape.ml[370,12392+45]..[370,12392+50])
                                                      ]
                                                    [
                                                      <case>
                                                        pattern (lib/shape.ml[371,12448+16]..[371,12448+35])
                                                          Ppat_exception
                                                          pattern (lib/shape.ml[371,12448+26]..[371,12448+35])
                                                            Ppat_construct "Not_found" (lib/shape.ml[371,12448+26]..[371,12448+35])
                                                            None
                                                        expression (lib/shape.ml[371,12448+39]..[371,12448+47])
                                                          Pexp_apply
                                                          expression (lib/shape.ml[371,12448+39]..[371,12448+44])
                                                            Pexp_ident "nored" (lib/shape.ml[371,12448+39]..[371,12448+44])
                                                          [
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[371,12448+45]..[371,12448+47])
                                                                Pexp_construct "()" (lib/shape.ml[371,12448+45]..[371,12448+47])
                                                                None
                                                          ]
                                                      <case>
                                                        pattern (lib/shape.ml[372,12496+16]..[372,12496+18])
                                                          Ppat_var "nf" (lib/shape.ml[372,12496+16]..[372,12496+18])
                                                        expression (lib/shape.ml[373,12518+18]..[374,12545+38])
                                                          Pexp_apply
                                                          expression (lib/shape.ml[374,12545+18]..[374,12545+20])
                                                            Pexp_ident "|>" (lib/shape.ml[374,12545+18]..[374,12545+20])
                                                          [
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[373,12518+18]..[373,12518+26])
                                                                Pexp_apply
                                                                expression (lib/shape.ml[373,12518+18]..[373,12518+23])
                                                                  Pexp_ident "force" (lib/shape.ml[373,12518+18]..[373,12518+23])
                                                                [
                                                                  <arg>
                                                                  Nolabel
                                                                    expression (lib/shape.ml[373,12518+24]..[373,12518+26])
                                                                      Pexp_ident "nf" (lib/shape.ml[373,12518+24]..[373,12518+26])
                                                                ]
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[374,12545+21]..[374,12545+38])
                                                                Pexp_apply
                                                                expression (lib/shape.ml[374,12545+21]..[374,12545+32])
                                                                  Pexp_ident "improve_uid" (lib/shape.ml[374,12545+21]..[374,12545+32])
                                                                [
                                                                  <arg>
                                                                  Nolabel
                                                                    expression (lib/shape.ml[374,12545+33]..[374,12545+38])
                                                                      Pexp_field
                                                                      expression (lib/shape.ml[374,12545+33]..[374,12545+34])
Pexp_ident "t" (lib/shape.ml[374,12545+33]..[374,12545+34])
                                                                      "uid" (lib/shape.ml[374,12545+35]..[374,12545+38])
                                                                ]
                                                          ]
                                                    ]
                                                <case>
                                                  pattern (lib/shape.ml[376,12602+12]..[376,12602+13])
                                                    Ppat_any
                                                  expression (lib/shape.ml[377,12619+14]..[377,12619+22])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[377,12619+14]..[377,12619+19])
                                                      Pexp_ident "nored" (lib/shape.ml[377,12619+14]..[377,12619+19])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[377,12619+20]..[377,12619+22])
                                                          Pexp_construct "()" (lib/shape.ml[377,12619+20]..[377,12619+22])
                                                          None
                                                    ]
                                              ]
                                      <case>
                                        pattern (lib/shape.ml[379,12656+8]..[379,12656+22])
                                          Ppat_construct "Abs" (lib/shape.ml[379,12656+8]..[379,12656+11])
                                          Some
                                            []
                                            pattern (lib/shape.ml[379,12656+11]..[379,12656+22])
                                              Ppat_tuple
                                              [
                                                pattern (lib/shape.ml[379,12656+12]..[379,12656+15])
                                                  Ppat_var "var" (lib/shape.ml[379,12656+12]..[379,12656+15])
                                                pattern (lib/shape.ml[379,12656+17]..[379,12656+21])
                                                  Ppat_var "body" (lib/shape.ml[379,12656+17]..[379,12656+21])
                                              ]
                                        expression (lib/shape.ml[380,12682+10]..[381,12747+54])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[380,12682+14]..[380,12682+21])
                                                Ppat_var "body_nf" (lib/shape.ml[380,12682+14]..[380,12682+21])
                                              expression (lib/shape.ml[380,12682+24]..[380,12682+61])
                                                Pexp_apply
                                                expression (lib/shape.ml[380,12682+24]..[380,12682+36])
                                                  Pexp_ident "delay_reduce" (lib/shape.ml[380,12682+24]..[380,12682+36])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[380,12682+37]..[380,12682+56])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[380,12682+38]..[380,12682+42])
                                                        Pexp_ident "bind" (lib/shape.ml[380,12682+38]..[380,12682+42])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[380,12682+43]..[380,12682+46])
                                                            Pexp_ident "env" (lib/shape.ml[380,12682+43]..[380,12682+46])
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[380,12682+47]..[380,12682+50])
                                                            Pexp_ident "var" (lib/shape.ml[380,12682+47]..[380,12682+50])
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[380,12682+51]..[380,12682+55])
                                                            Pexp_construct "None" (lib/shape.ml[380,12682+51]..[380,12682+55])
                                                            None
                                                      ]
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[380,12682+57]..[380,12682+61])
                                                      Pexp_ident "body" (lib/shape.ml[380,12682+57]..[380,12682+61])
                                                ]
                                          ]
                                          expression (lib/shape.ml[381,12747+10]..[381,12747+54])
                                            Pexp_apply
                                            expression (lib/shape.ml[381,12747+10]..[381,12747+16])
                                              Pexp_ident "return" (lib/shape.ml[381,12747+10]..[381,12747+16])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[381,12747+17]..[381,12747+54])
                                                  Pexp_construct "NAbs" (lib/shape.ml[381,12747+18]..[381,12747+22])
                                                  Some
                                                    expression (lib/shape.ml[381,12747+22]..[381,12747+53])
                                                      Pexp_tuple
                                                      [
                                                        expression (lib/shape.ml[381,12747+23]..[381,12747+32])
                                                          Pexp_ident "local_env" (lib/shape.ml[381,12747+23]..[381,12747+32])
                                                        expression (lib/shape.ml[381,12747+34]..[381,12747+37])
                                                          Pexp_ident "var" (lib/shape.ml[381,12747+34]..[381,12747+37])
                                                        expression (lib/shape.ml[381,12747+39]..[381,12747+43])
                                                          Pexp_ident "body" (lib/shape.ml[381,12747+39]..[381,12747+43])
                                                        expression (lib/shape.ml[381,12747+45]..[381,12747+52])
                                                          Pexp_ident "body_nf" (lib/shape.ml[381,12747+45]..[381,12747+52])
                                                      ]
                                            ]
                                      <case>
                                        pattern (lib/shape.ml[382,12802+8]..[382,12802+14])
                                          Ppat_construct "Var" (lib/shape.ml[382,12802+8]..[382,12802+11])
                                          Some
                                            []
                                            pattern (lib/shape.ml[382,12802+12]..[382,12802+14])
                                              Ppat_var "id" (lib/shape.ml[382,12802+12]..[382,12802+14])
                                        expression (lib/shape.ml[383,12820+10]..[402,13710+13])
                                          Pexp_match
                                          expression (lib/shape.ml[383,12820+22]..[383,12820+49])
                                            Pexp_apply
                                            expression (lib/shape.ml[383,12820+22]..[383,12820+36])
                                              Pexp_ident "Ident.Map.find" (lib/shape.ml[383,12820+22]..[383,12820+36])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[383,12820+37]..[383,12820+39])
                                                  Pexp_ident "id" (lib/shape.ml[383,12820+37]..[383,12820+39])
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[383,12820+40]..[383,12820+49])
                                                  Pexp_ident "local_env" (lib/shape.ml[383,12820+40]..[383,12820+49])
                                            ]
                                          [
                                            <case>
                                              pattern (lib/shape.ml[393,13377+12]..[393,13377+16])
                                                Ppat_construct "None" (lib/shape.ml[393,13377+12]..[393,13377+16])
                                                None
                                              expression (lib/shape.ml[393,13377+20]..[393,13377+36])
                                                Pexp_apply
                                                expression (lib/shape.ml[393,13377+20]..[393,13377+26])
                                                  Pexp_ident "return" (lib/shape.ml[393,13377+20]..[393,13377+26])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[393,13377+27]..[393,13377+36])
                                                      Pexp_construct "NVar" (lib/shape.ml[393,13377+28]..[393,13377+32])
                                                      Some
                                                        expression (lib/shape.ml[393,13377+33]..[393,13377+35])
                                                          Pexp_ident "id" (lib/shape.ml[393,13377+33]..[393,13377+35])
                                                ]
                                            <case>
                                              pattern (lib/shape.ml[394,13414+12]..[394,13414+20])
                                                Ppat_construct "Some" (lib/shape.ml[394,13414+12]..[394,13414+16])
                                                Some
                                                  []
                                                  pattern (lib/shape.ml[394,13414+17]..[394,13414+20])
                                                    Ppat_var "def" (lib/shape.ml[394,13414+17]..[394,13414+20])
                                              expression (lib/shape.ml[394,13414+24]..[394,13414+33])
                                                Pexp_apply
                                                expression (lib/shape.ml[394,13414+24]..[394,13414+29])
                                                  Pexp_ident "force" (lib/shape.ml[394,13414+24]..[394,13414+29])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[394,13414+30]..[394,13414+33])
                                                      Pexp_ident "def" (lib/shape.ml[394,13414+30]..[394,13414+33])
                                                ]
                                            <case>
                                              pattern (lib/shape.ml[395,13448+12]..[395,13448+31])
                                                Ppat_exception
                                                pattern (lib/shape.ml[395,13448+22]..[395,13448+31])
                                                  Ppat_construct "Not_found" (lib/shape.ml[395,13448+22]..[395,13448+31])
                                                  None
                                              expression (lib/shape.ml[396,13483+10]..[401,13681+28])
                                                Pexp_match
                                                expression (lib/shape.ml[396,13483+16]..[396,13483+47])
                                                  Pexp_apply
                                                  expression (lib/shape.ml[396,13483+16]..[396,13483+33])
                                                    Pexp_ident "Params.find_shape" (lib/shape.ml[396,13483+16]..[396,13483+33])
                                                  [
                                                    <arg>
                                                    Nolabel
                                                      expression (lib/shape.ml[396,13483+34]..[396,13483+44])
                                                        Pexp_ident "global_env" (lib/shape.ml[396,13483+34]..[396,13483+44])
                                                    <arg>
                                                    Nolabel
                                                      expression (lib/shape.ml[396,13483+45]..[396,13483+47])
                                                        Pexp_ident "id" (lib/shape.ml[396,13483+45]..[396,13483+47])
                                                  ]
                                                [
                                                  <case>
                                                    pattern (lib/shape.ml[397,13536+12]..[397,13536+31])
                                                      Ppat_exception
                                                      pattern (lib/shape.ml[397,13536+22]..[397,13536+31])
                                                        Ppat_construct "Not_found" (lib/shape.ml[397,13536+22]..[397,13536+31])
                                                        None
                                                    expression (lib/shape.ml[397,13536+35]..[397,13536+51])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[397,13536+35]..[397,13536+41])
                                                        Pexp_ident "return" (lib/shape.ml[397,13536+35]..[397,13536+41])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[397,13536+42]..[397,13536+51])
                                                            Pexp_construct "NVar" (lib/shape.ml[397,13536+43]..[397,13536+47])
                                                            Some
                                                              expression (lib/shape.ml[397,13536+48]..[397,13536+50])
                                                                Pexp_ident "id" (lib/shape.ml[397,13536+48]..[397,13536+50])
                                                      ]
                                                  <case>
                                                    pattern (lib/shape.ml[398,13588+12]..[398,13588+15])
                                                      Ppat_var "res" (lib/shape.ml[398,13588+12]..[398,13588+15])
                                                    <when>
                                                      expression (lib/shape.ml[398,13588+21]..[398,13588+28])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[398,13588+25]..[398,13588+26])
                                                          Pexp_ident "=" (lib/shape.ml[398,13588+25]..[398,13588+26])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[398,13588+21]..[398,13588+24])
                                                              Pexp_ident "res" (lib/shape.ml[398,13588+21]..[398,13588+24])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[398,13588+27]..[398,13588+28])
                                                              Pexp_ident "t" (lib/shape.ml[398,13588+27]..[398,13588+28])
                                                        ]
                                                    expression (lib/shape.ml[398,13588+32]..[398,13588+48])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[398,13588+32]..[398,13588+38])
                                                        Pexp_ident "return" (lib/shape.ml[398,13588+32]..[398,13588+38])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[398,13588+39]..[398,13588+48])
                                                            Pexp_construct "NVar" (lib/shape.ml[398,13588+40]..[398,13588+44])
                                                            Some
                                                              expression (lib/shape.ml[398,13588+45]..[398,13588+47])
                                                                Pexp_ident "id" (lib/shape.ml[398,13588+45]..[398,13588+47])
                                                      ]
                                                  <case>
                                                    pattern (lib/shape.ml[399,13637+12]..[399,13637+15])
                                                      Ppat_var "res" (lib/shape.ml[399,13637+12]..[399,13637+15])
                                                    expression (lib/shape.ml[400,13656+14]..[401,13681+28])
                                                      Pexp_sequence
                                                      expression (lib/shape.ml[400,13656+14]..[400,13656+23])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[400,13656+14]..[400,13656+18])
                                                          Pexp_ident "decr" (lib/shape.ml[400,13656+14]..[400,13656+18])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[400,13656+19]..[400,13656+23])
                                                              Pexp_ident "fuel" (lib/shape.ml[400,13656+19]..[400,13656+23])
                                                        ]
                                                      expression (lib/shape.ml[401,13681+14]..[401,13681+28])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[401,13681+14]..[401,13681+20])
                                                          Pexp_ident "reduce" (lib/shape.ml[401,13681+14]..[401,13681+20])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[401,13681+21]..[401,13681+24])
                                                              Pexp_ident "env" (lib/shape.ml[401,13681+21]..[401,13681+24])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[401,13681+25]..[401,13681+28])
                                                              Pexp_ident "res" (lib/shape.ml[401,13681+25]..[401,13681+28])
                                                        ]
                                                ]
                                          ]
                                      <case>
                                        pattern (lib/shape.ml[403,13724+8]..[403,13724+12])
                                          Ppat_construct "Leaf" (lib/shape.ml[403,13724+8]..[403,13724+12])
                                          None
                                        expression (lib/shape.ml[403,13724+16]..[403,13724+28])
                                          Pexp_apply
                                          expression (lib/shape.ml[403,13724+16]..[403,13724+22])
                                            Pexp_ident "return" (lib/shape.ml[403,13724+16]..[403,13724+22])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[403,13724+23]..[403,13724+28])
                                                Pexp_construct "NLeaf" (lib/shape.ml[403,13724+23]..[403,13724+28])
                                                None
                                          ]
                                      <case>
                                        pattern (lib/shape.ml[404,13753+8]..[404,13753+16])
                                          Ppat_construct "Struct" (lib/shape.ml[404,13753+8]..[404,13753+14])
                                          Some
                                            []
                                            pattern (lib/shape.ml[404,13753+15]..[404,13753+16])
                                              Ppat_var "m" (lib/shape.ml[404,13753+15]..[404,13753+16])
                                        expression (lib/shape.ml[405,13773+10]..[406,13830+30])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[405,13773+14]..[405,13773+17])
                                                Ppat_var "mnf" (lib/shape.ml[405,13773+14]..[405,13773+17])
                                              expression (lib/shape.ml[405,13773+20]..[405,13773+53])
                                                Pexp_apply
                                                expression (lib/shape.ml[405,13773+20]..[405,13773+32])
                                                  Pexp_ident "Item.Map.map" (lib/shape.ml[405,13773+20]..[405,13773+32])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[405,13773+33]..[405,13773+51])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[405,13773+34]..[405,13773+46])
                                                        Pexp_ident "delay_reduce" (lib/shape.ml[405,13773+34]..[405,13773+46])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[405,13773+47]..[405,13773+50])
                                                            Pexp_ident "env" (lib/shape.ml[405,13773+47]..[405,13773+50])
                                                      ]
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[405,13773+52]..[405,13773+53])
                                                      Pexp_ident "m" (lib/shape.ml[405,13773+52]..[405,13773+53])
                                                ]
                                          ]
                                          expression (lib/shape.ml[406,13830+10]..[406,13830+30])
                                            Pexp_apply
                                            expression (lib/shape.ml[406,13830+10]..[406,13830+16])
                                              Pexp_ident "return" (lib/shape.ml[406,13830+10]..[406,13830+16])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[406,13830+17]..[406,13830+30])
                                                  Pexp_construct "NStruct" (lib/shape.ml[406,13830+18]..[406,13830+25])
                                                  Some
                                                    expression (lib/shape.ml[406,13830+26]..[406,13830+29])
                                                      Pexp_ident "mnf" (lib/shape.ml[406,13830+26]..[406,13830+29])
                                            ]
                                    ]
              ]
            structure_item (lib/shape.ml[408,13862+2]..[435,14850+23])
              Pstr_value Rec
              [
                <def>
                  pattern (lib/shape.ml[408,13862+10]..[408,13862+19])
                    Ppat_var "read_back" (lib/shape.ml[408,13862+10]..[408,13862+19])
                  expression (lib/shape.ml[408,13862+20]..[409,13902+65]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[408,13862+20]..[408,13862+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[408,13862+20]..[408,13862+23])
                          Ppat_var "env" (lib/shape.ml[408,13862+20]..[408,13862+23])
                      Pparam_val (lib/shape.ml[408,13862+24]..[408,13862+33])
                        Nolabel
                        None
                        pattern (lib/shape.ml[408,13862+24]..[408,13862+33])
                          Ppat_constraint
                          pattern (lib/shape.ml[408,13862+25]..[408,13862+27])
                            Ppat_var "nf" (lib/shape.ml[408,13862+25]..[408,13862+27])
                          core_type (lib/shape.ml[408,13862+30]..[408,13862+32])
                            Ptyp_constr "nf" (lib/shape.ml[408,13862+30]..[408,13862+32])
                            []
                    ]
                    Some
                      Pconstraint
                        core_type (lib/shape.ml[408,13862+36]..[408,13862+37])
                          Ptyp_constr "t" (lib/shape.ml[408,13862+36]..[408,13862+37])
                          []
                    Pfunction_body
                      expression (lib/shape.ml[409,13902+4]..[409,13902+65])
                        Pexp_apply
                        expression (lib/shape.ml[409,13902+4]..[409,13902+17])
                          Pexp_ident "in_memo_table" (lib/shape.ml[409,13902+4]..[409,13902+17])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13902+18]..[409,13902+42])
                              Pexp_field
                              expression (lib/shape.ml[409,13902+18]..[409,13902+21])
                                Pexp_ident "env" (lib/shape.ml[409,13902+18]..[409,13902+21])
                              "read_back_memo_table" (lib/shape.ml[409,13902+22]..[409,13902+42])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13902+43]..[409,13902+45])
                              Pexp_ident "nf" (lib/shape.ml[409,13902+43]..[409,13902+45])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13902+46]..[409,13902+62])
                              Pexp_apply
                              expression (lib/shape.ml[409,13902+47]..[409,13902+57])
                                Pexp_ident "read_back_" (lib/shape.ml[409,13902+47]..[409,13902+57])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[409,13902+58]..[409,13902+61])
                                    Pexp_ident "env" (lib/shape.ml[409,13902+58]..[409,13902+61])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13902+63]..[409,13902+65])
                              Pexp_ident "nf" (lib/shape.ml[409,13902+63]..[409,13902+65])
                        ]
                <def>
                  pattern (lib/shape.ml[415,14207+6]..[415,14207+16])
                    Ppat_var "read_back_" (lib/shape.ml[415,14207+6]..[415,14207+16])
                  expression (lib/shape.ml[415,14207+17]..[416,14244+55]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[415,14207+17]..[415,14207+20])
                        Nolabel
                        None
                        pattern (lib/shape.ml[415,14207+17]..[415,14207+20])
                          Ppat_var "env" (lib/shape.ml[415,14207+17]..[415,14207+20])
                      Pparam_val (lib/shape.ml[415,14207+21]..[415,14207+30])
                        Nolabel
                        None
                        pattern (lib/shape.ml[415,14207+21]..[415,14207+30])
                          Ppat_constraint
                          pattern (lib/shape.ml[415,14207+22]..[415,14207+24])
                            Ppat_var "nf" (lib/shape.ml[415,14207+22]..[415,14207+24])
                          core_type (lib/shape.ml[415,14207+27]..[415,14207+29])
                            Ptyp_constr "nf" (lib/shape.ml[415,14207+27]..[415,14207+29])
                            []
                    ]
                    Some
                      Pconstraint
                        core_type (lib/shape.ml[415,14207+33]..[415,14207+34])
                          Ptyp_constr "t" (lib/shape.ml[415,14207+33]..[415,14207+34])
                          []
                    Pfunction_body
                      expression (lib/shape.ml[416,14244+4]..[416,14244+55])
                        Pexp_record
                        [
                          "uid" (lib/shape.ml[416,14244+6]..[416,14244+9])
                            expression (lib/shape.ml[416,14244+12]..[416,14244+18])
                              Pexp_field
                              expression (lib/shape.ml[416,14244+12]..[416,14244+14])
                                Pexp_ident "nf" (lib/shape.ml[416,14244+12]..[416,14244+14])
                              "uid" (lib/shape.ml[416,14244+15]..[416,14244+18])
                          "desc" (lib/shape.ml[416,14244+20]..[416,14244+24])
                            expression (lib/shape.ml[416,14244+27]..[416,14244+53])
                              Pexp_apply
                              expression (lib/shape.ml[416,14244+27]..[416,14244+41])
                                Pexp_ident "read_back_desc" (lib/shape.ml[416,14244+27]..[416,14244+41])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[416,14244+42]..[416,14244+45])
                                    Pexp_ident "env" (lib/shape.ml[416,14244+42]..[416,14244+45])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[416,14244+46]..[416,14244+53])
                                    Pexp_field
                                    expression (lib/shape.ml[416,14244+46]..[416,14244+48])
                                      Pexp_ident "nf" (lib/shape.ml[416,14244+46]..[416,14244+48])
                                    "desc" (lib/shape.ml[416,14244+49]..[416,14244+53])
                              ]
                        ]
                        None
                <def>
                  pattern (lib/shape.ml[418,14301+6]..[418,14301+20])
                    Ppat_var "read_back_desc" (lib/shape.ml[418,14301+6]..[418,14301+20])
                  expression (lib/shape.ml[418,14301+21]..[435,14850+23]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[418,14301+21]..[418,14301+24])
                        Nolabel
                        None
                        pattern (lib/shape.ml[418,14301+21]..[418,14301+24])
                          Ppat_var "env" (lib/shape.ml[418,14301+21]..[418,14301+24])
                      Pparam_val (lib/shape.ml[418,14301+25]..[418,14301+29])
                        Nolabel
                        None
                        pattern (lib/shape.ml[418,14301+25]..[418,14301+29])
                          Ppat_var "desc" (lib/shape.ml[418,14301+25]..[418,14301+29])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[419,14333+4]..[435,14850+23])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[419,14333+8]..[419,14333+17])
                              Ppat_var "read_back" (lib/shape.ml[419,14333+8]..[419,14333+17])
                            expression (lib/shape.ml[419,14333+18]..[419,14333+39]) ghost
                              Pexp_function
                              [
                                Pparam_val (lib/shape.ml[419,14333+18]..[419,14333+20])
                                  Nolabel
                                  None
                                  pattern (lib/shape.ml[419,14333+18]..[419,14333+20])
                                    Ppat_var "nf" (lib/shape.ml[419,14333+18]..[419,14333+20])
                              ]
                              None
                              Pfunction_body
                                expression (lib/shape.ml[419,14333+23]..[419,14333+39])
                                  Pexp_apply
                                  expression (lib/shape.ml[419,14333+23]..[419,14333+32])
                                    Pexp_ident "read_back" (lib/shape.ml[419,14333+23]..[419,14333+32])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[419,14333+33]..[419,14333+36])
                                        Pexp_ident "env" (lib/shape.ml[419,14333+33]..[419,14333+36])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[419,14333+37]..[419,14333+39])
                                        Pexp_ident "nf" (lib/shape.ml[419,14333+37]..[419,14333+39])
                                  ]
                        ]
                        expression (lib/shape.ml[420,14376+4]..[435,14850+23])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (lib/shape.ml[420,14376+8]..[420,14376+23])
                                Ppat_var "read_back_force" (lib/shape.ml[420,14376+8]..[420,14376+23])
                              expression (lib/shape.ml[420,14376+24]..[421,14425+50]) ghost
                                Pexp_function
                                [
                                  Pparam_val (lib/shape.ml[420,14376+24]..[420,14376+46])
                                    Nolabel
                                    None
                                    pattern (lib/shape.ml[420,14376+24]..[420,14376+46])
                                      Ppat_construct "Thunk" (lib/shape.ml[420,14376+25]..[420,14376+30])
                                      Some
                                        []
                                        pattern (lib/shape.ml[420,14376+31]..[420,14376+45])
                                          Ppat_tuple
                                          [
                                            pattern (lib/shape.ml[420,14376+32]..[420,14376+41])
                                              Ppat_var "local_env" (lib/shape.ml[420,14376+32]..[420,14376+41])
                                            pattern (lib/shape.ml[420,14376+43]..[420,14376+44])
                                              Ppat_var "t" (lib/shape.ml[420,14376+43]..[420,14376+44])
                                          ]
                                ]
                                None
                                Pfunction_body
                                  expression (lib/shape.ml[421,14425+6]..[421,14425+50])
                                    Pexp_apply
                                    expression (lib/shape.ml[421,14425+6]..[421,14425+15])
                                      Pexp_ident "read_back" (lib/shape.ml[421,14425+6]..[421,14425+15])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[421,14425+16]..[421,14425+50])
                                          Pexp_apply
                                          expression (lib/shape.ml[421,14425+17]..[421,14425+24])
                                            Pexp_ident "reduce_" (lib/shape.ml[421,14425+17]..[421,14425+24])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[421,14425+25]..[421,14425+47])
                                                Pexp_record
                                                [
                                                  "local_env" (lib/shape.ml[421,14425+36]..[421,14425+45]) ghost
                                                    expression (lib/shape.ml[421,14425+36]..[421,14425+45])
                                                      Pexp_ident "local_env" (lib/shape.ml[421,14425+36]..[421,14425+45])
                                                ]
                                                Some
                                                  expression (lib/shape.ml[421,14425+27]..[421,14425+30])
                                                    Pexp_ident "env" (lib/shape.ml[421,14425+27]..[421,14425+30])
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[421,14425+48]..[421,14425+49])
                                                Pexp_ident "t" (lib/shape.ml[421,14425+48]..[421,14425+49])
                                          ]
                                    ]
                          ]
                          expression (lib/shape.ml[422,14479+4]..[435,14850+23])
                            Pexp_match
                            expression (lib/shape.ml[422,14479+10]..[422,14479+14])
                              Pexp_ident "desc" (lib/shape.ml[422,14479+10]..[422,14479+14])
                            [
                              <case>
                                pattern (lib/shape.ml[423,14499+6]..[423,14499+12])
                                  Ppat_construct "NVar" (lib/shape.ml[423,14499+6]..[423,14499+10])
                                  Some
                                    []
                                    pattern (lib/shape.ml[423,14499+11]..[423,14499+12])
                                      Ppat_var "v" (lib/shape.ml[423,14499+11]..[423,14499+12])
                                expression (lib/shape.ml[424,14515+8]..[424,14515+13])
                                  Pexp_construct "Var" (lib/shape.ml[424,14515+8]..[424,14515+11])
                                  Some
                                    expression (lib/shape.ml[424,14515+12]..[424,14515+13])
                                      Pexp_ident "v" (lib/shape.ml[424,14515+12]..[424,14515+13])
                              <case>
                                pattern (lib/shape.ml[425,14529+6]..[425,14529+21])
                                  Ppat_construct "NApp" (lib/shape.ml[425,14529+6]..[425,14529+10])
                                  Some
                                    []
                                    pattern (lib/shape.ml[425,14529+11]..[425,14529+21])
                                      Ppat_tuple
                                      [
                                        pattern (lib/shape.ml[425,14529+12]..[425,14529+15])
                                          Ppat_var "nft" (lib/shape.ml[425,14529+12]..[425,14529+15])
                                        pattern (lib/shape.ml[425,14529+17]..[425,14529+20])
                                          Ppat_var "nfu" (lib/shape.ml[425,14529+17]..[425,14529+20])
                                      ]
                                expression (lib/shape.ml[426,14554+8]..[426,14554+41])
                                  Pexp_construct "App" (lib/shape.ml[426,14554+8]..[426,14554+11])
                                  Some
                                    expression (lib/shape.ml[426,14554+11]..[426,14554+41])
                                      Pexp_tuple
                                      [
                                        expression (lib/shape.ml[426,14554+12]..[426,14554+25])
                                          Pexp_apply
                                          expression (lib/shape.ml[426,14554+12]..[426,14554+21])
                                            Pexp_ident "read_back" (lib/shape.ml[426,14554+12]..[426,14554+21])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[426,14554+22]..[426,14554+25])
                                                Pexp_ident "nft" (lib/shape.ml[426,14554+22]..[426,14554+25])
                                          ]
                                        expression (lib/shape.ml[426,14554+27]..[426,14554+40])
                                          Pexp_apply
                                          expression (lib/shape.ml[426,14554+27]..[426,14554+36])
                                            Pexp_ident "read_back" (lib/shape.ml[426,14554+27]..[426,14554+36])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[426,14554+37]..[426,14554+40])
                                                Pexp_ident "nfu" (lib/shape.ml[426,14554+37]..[426,14554+40])
                                          ]
                                      ]
                              <case>
                                pattern (lib/shape.ml[427,14596+6]..[427,14596+28])
                                  Ppat_construct "NAbs" (lib/shape.ml[427,14596+6]..[427,14596+10])
                                  Some
                                    []
                                    pattern (lib/shape.ml[427,14596+11]..[427,14596+28])
                                      Ppat_tuple
                                      [
                                        pattern (lib/shape.ml[427,14596+12]..[427,14596+16])
                                          Ppat_var "_env" (lib/shape.ml[427,14596+12]..[427,14596+16])
                                        pattern (lib/shape.ml[427,14596+18]..[427,14596+19])
                                          Ppat_var "x" (lib/shape.ml[427,14596+18]..[427,14596+19])
                                        pattern (lib/shape.ml[427,14596+21]..[427,14596+23])
                                          Ppat_var "_t" (lib/shape.ml[427,14596+21]..[427,14596+23])
                                        pattern (lib/shape.ml[427,14596+25]..[427,14596+27])
                                          Ppat_var "nf" (lib/shape.ml[427,14596+25]..[427,14596+27])
                                      ]
                                expression (lib/shape.ml[428,14628+8]..[428,14628+34])
                                  Pexp_construct "Abs" (lib/shape.ml[428,14628+8]..[428,14628+11])
                                  Some
                                    expression (lib/shape.ml[428,14628+11]..[428,14628+34])
                                      Pexp_tuple
                                      [
                                        expression (lib/shape.ml[428,14628+12]..[428,14628+13])
                                          Pexp_ident "x" (lib/shape.ml[428,14628+12]..[428,14628+13])
                                        expression (lib/shape.ml[428,14628+15]..[428,14628+33])
                                          Pexp_apply
                                          expression (lib/shape.ml[428,14628+15]..[428,14628+30])
                                            Pexp_ident "read_back_force" (lib/shape.ml[428,14628+15]..[428,14628+30])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[428,14628+31]..[428,14628+33])
                                                Pexp_ident "nf" (lib/shape.ml[428,14628+31]..[428,14628+33])
                                          ]
                                      ]
                              <case>
                                pattern (lib/shape.ml[429,14663+6]..[429,14663+18])
                                  Ppat_construct "NStruct" (lib/shape.ml[429,14663+6]..[429,14663+13])
                                  Some
                                    []
                                    pattern (lib/shape.ml[429,14663+14]..[429,14663+18])
                                      Ppat_var "nstr" (lib/shape.ml[429,14663+14]..[429,14663+18])
                                expression (lib/shape.ml[430,14685+8]..[430,14685+50])
                                  Pexp_construct "Struct" (lib/shape.ml[430,14685+8]..[430,14685+14])
                                  Some
                                    expression (lib/shape.ml[430,14685+15]..[430,14685+50])
                                      Pexp_apply
                                      expression (lib/shape.ml[430,14685+16]..[430,14685+28])
                                        Pexp_ident "Item.Map.map" (lib/shape.ml[430,14685+16]..[430,14685+28])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[430,14685+29]..[430,14685+44])
                                            Pexp_ident "read_back_force" (lib/shape.ml[430,14685+29]..[430,14685+44])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[430,14685+45]..[430,14685+49])
                                            Pexp_ident "nstr" (lib/shape.ml[430,14685+45]..[430,14685+49])
                                      ]
                              <case>
                                pattern (lib/shape.ml[431,14736+6]..[431,14736+22])
                                  Ppat_construct "NProj" (lib/shape.ml[431,14736+6]..[431,14736+11])
                                  Some
                                    []
                                    pattern (lib/shape.ml[431,14736+12]..[431,14736+22])
                                      Ppat_tuple
                                      [
                                        pattern (lib/shape.ml[431,14736+13]..[431,14736+15])
                                          Ppat_var "nf" (lib/shape.ml[431,14736+13]..[431,14736+15])
                                        pattern (lib/shape.ml[431,14736+17]..[431,14736+21])
                                          Ppat_var "item" (lib/shape.ml[431,14736+17]..[431,14736+21])
                                      ]
                                expression (lib/shape.ml[432,14762+8]..[432,14762+33])
                                  Pexp_construct "Proj" (lib/shape.ml[432,14762+8]..[432,14762+12])
                                  Some
                                    expression (lib/shape.ml[432,14762+13]..[432,14762+33])
                                      Pexp_tuple
                                      [
                                        expression (lib/shape.ml[432,14762+14]..[432,14762+26])
                                          Pexp_apply
                                          expression (lib/shape.ml[432,14762+14]..[432,14762+23])
                                            Pexp_ident "read_back" (lib/shape.ml[432,14762+14]..[432,14762+23])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[432,14762+24]..[432,14762+26])
                                                Pexp_ident "nf" (lib/shape.ml[432,14762+24]..[432,14762+26])
                                          ]
                                        expression (lib/shape.ml[432,14762+28]..[432,14762+32])
                                          Pexp_ident "item" (lib/shape.ml[432,14762+28]..[432,14762+32])
                                      ]
                              <case>
                                pattern (lib/shape.ml[433,14796+6]..[433,14796+11])
                                  Ppat_construct "NLeaf" (lib/shape.ml[433,14796+6]..[433,14796+11])
                                  None
                                expression (lib/shape.ml[433,14796+15]..[433,14796+19])
                                  Pexp_construct "Leaf" (lib/shape.ml[433,14796+15]..[433,14796+19])
                                  None
                              <case>
                                pattern (lib/shape.ml[434,14816+6]..[434,14816+18])
                                  Ppat_construct "NComp_unit" (lib/shape.ml[434,14816+6]..[434,14816+16])
                                  Some
                                    []
                                    pattern (lib/shape.ml[434,14816+17]..[434,14816+18])
                                      Ppat_var "s" (lib/shape.ml[434,14816+17]..[434,14816+18])
                                expression (lib/shape.ml[434,14816+22]..[434,14816+33])
                                  Pexp_construct "Comp_unit" (lib/shape.ml[434,14816+22]..[434,14816+31])
                                  Some
                                    expression (lib/shape.ml[434,14816+32]..[434,14816+33])
                                      Pexp_ident "s" (lib/shape.ml[434,14816+32]..[434,14816+33])
                              <case>
                                pattern (lib/shape.ml[435,14850+6]..[435,14850+18])
                                  Ppat_construct "NoFuelLeft" (lib/shape.ml[435,14850+6]..[435,14850+16])
                                  Some
                                    []
                                    pattern (lib/shape.ml[435,14850+17]..[435,14850+18])
                                      Ppat_var "t" (lib/shape.ml[435,14850+17]..[435,14850+18])
                                expression (lib/shape.ml[435,14850+22]..[435,14850+23])
                                  Pexp_ident "t" (lib/shape.ml[435,14850+22]..[435,14850+23])
                            ]
              ]
            structure_item (lib/shape.ml[437,14875+2]..[449,15202+34])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[437,14875+6]..[437,14875+12])
                    Ppat_var "reduce" (lib/shape.ml[437,14875+6]..[437,14875+12])
                  expression (lib/shape.ml[437,14875+13]..[449,15202+34]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[437,14875+13]..[437,14875+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[437,14875+13]..[437,14875+23])
                          Ppat_var "global_env" (lib/shape.ml[437,14875+13]..[437,14875+23])
                      Pparam_val (lib/shape.ml[437,14875+24]..[437,14875+25])
                        Nolabel
                        None
                        pattern (lib/shape.ml[437,14875+24]..[437,14875+25])
                          Ppat_var "t" (lib/shape.ml[437,14875+24]..[437,14875+25])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[438,14903+4]..[449,15202+34])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[438,14903+8]..[438,14903+12])
                              Ppat_var "fuel" (lib/shape.ml[438,14903+8]..[438,14903+12])
                            expression (lib/shape.ml[438,14903+15]..[438,14903+30])
                              Pexp_apply
                              expression (lib/shape.ml[438,14903+15]..[438,14903+18])
                                Pexp_ident "ref" (lib/shape.ml[438,14903+15]..[438,14903+18])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[438,14903+19]..[438,14903+30])
                                    Pexp_ident "Params.fuel" (lib/shape.ml[438,14903+19]..[438,14903+30])
                              ]
                        ]
                        expression (lib/shape.ml[439,14937+4]..[449,15202+34])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (lib/shape.ml[439,14937+8]..[439,14937+25])
                                Ppat_var "reduce_memo_table" (lib/shape.ml[439,14937+8]..[439,14937+25])
                              expression (lib/shape.ml[439,14937+28]..[439,14937+45])
                                Pexp_apply
                                expression (lib/shape.ml[439,14937+28]..[439,14937+42])
                                  Pexp_ident "Hashtbl.create" (lib/shape.ml[439,14937+28]..[439,14937+42])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[439,14937+43]..[439,14937+45])
                                      Pexp_constant PConst_int (42,None)
                                ]
                          ]
                          expression (lib/shape.ml[440,14986+4]..[449,15202+34])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (lib/shape.ml[440,14986+8]..[440,14986+28])
                                  Ppat_var "read_back_memo_table" (lib/shape.ml[440,14986+8]..[440,14986+28])
                                expression (lib/shape.ml[440,14986+31]..[440,14986+48])
                                  Pexp_apply
                                  expression (lib/shape.ml[440,14986+31]..[440,14986+45])
                                    Pexp_ident "Hashtbl.create" (lib/shape.ml[440,14986+31]..[440,14986+45])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[440,14986+46]..[440,14986+48])
                                        Pexp_constant PConst_int (42,None)
                                  ]
                            ]
                            expression (lib/shape.ml[441,15038+4]..[449,15202+34])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[441,15038+8]..[441,15038+17])
                                    Ppat_var "local_env" (lib/shape.ml[441,15038+8]..[441,15038+17])
                                  expression (lib/shape.ml[441,15038+20]..[441,15038+35])
                                    Pexp_ident "Ident.Map.empty" (lib/shape.ml[441,15038+20]..[441,15038+35])
                              ]
                              expression (lib/shape.ml[442,15077+4]..[449,15202+34])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (lib/shape.ml[442,15077+8]..[442,15077+11])
                                      Ppat_var "env" (lib/shape.ml[442,15077+8]..[442,15077+11])
                                    expression (lib/shape.ml[442,15077+14]..[448,15193+5])
                                      Pexp_record
                                      [
                                        "fuel" (lib/shape.ml[443,15093+6]..[443,15093+10]) ghost
                                          expression (lib/shape.ml[443,15093+6]..[443,15093+10])
                                            Pexp_ident "fuel" (lib/shape.ml[443,15093+6]..[443,15093+10])
                                        "global_env" (lib/shape.ml[444,15105+6]..[444,15105+16]) ghost
                                          expression (lib/shape.ml[444,15105+6]..[444,15105+16])
                                            Pexp_ident "global_env" (lib/shape.ml[444,15105+6]..[444,15105+16])
                                        "reduce_memo_table" (lib/shape.ml[445,15123+6]..[445,15123+23]) ghost
                                          expression (lib/shape.ml[445,15123+6]..[445,15123+23])
                                            Pexp_ident "reduce_memo_table" (lib/shape.ml[445,15123+6]..[445,15123+23])
                                        "read_back_memo_table" (lib/shape.ml[446,15148+6]..[446,15148+26]) ghost
                                          expression (lib/shape.ml[446,15148+6]..[446,15148+26])
                                            Pexp_ident "read_back_memo_table" (lib/shape.ml[446,15148+6]..[446,15148+26])
                                        "local_env" (lib/shape.ml[447,15176+6]..[447,15176+15]) ghost
                                          expression (lib/shape.ml[447,15176+6]..[447,15176+15])
                                            Pexp_ident "local_env" (lib/shape.ml[447,15176+6]..[447,15176+15])
                                      ]
                                      None
                                ]
                                expression (lib/shape.ml[449,15202+4]..[449,15202+34])
                                  Pexp_apply
                                  expression (lib/shape.ml[449,15202+18]..[449,15202+20])
                                    Pexp_ident "|>" (lib/shape.ml[449,15202+18]..[449,15202+20])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[449,15202+4]..[449,15202+17])
                                        Pexp_apply
                                        expression (lib/shape.ml[449,15202+4]..[449,15202+11])
                                          Pexp_ident "reduce_" (lib/shape.ml[449,15202+4]..[449,15202+11])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[449,15202+12]..[449,15202+15])
                                              Pexp_ident "env" (lib/shape.ml[449,15202+12]..[449,15202+15])
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[449,15202+16]..[449,15202+17])
                                              Pexp_ident "t" (lib/shape.ml[449,15202+16]..[449,15202+17])
                                        ]
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[449,15202+21]..[449,15202+34])
                                        Pexp_apply
                                        expression (lib/shape.ml[449,15202+21]..[449,15202+30])
                                          Pexp_ident "read_back" (lib/shape.ml[449,15202+21]..[449,15202+30])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[449,15202+31]..[449,15202+34])
                                              Pexp_ident "env" (lib/shape.ml[449,15202+31]..[449,15202+34])
                                        ]
                                  ]
              ]
          ]
  structure_item (lib/shape.ml[452,15242+0]..[463,15728+6])
    Pstr_module
    "Local_reduce" (lib/shape.ml[452,15242+7]..[452,15242+19])
      module_expr (lib/shape.ml[458,15579+2]..[463,15728+6])
        Pmod_apply
        module_expr (lib/shape.ml[458,15579+2]..[458,15579+13])
          Pmod_ident "Make_reduce" (lib/shape.ml[458,15579+2]..[458,15579+13])
        module_expr (lib/shape.ml[458,15579+14]..[463,15728+5])
          Pmod_structure
          [
            structure_item (lib/shape.ml[459,15600+4]..[459,15600+19])
              Pstr_type Rec
              [
                type_declaration "env" (lib/shape.ml[459,15600+9]..[459,15600+12]) (lib/shape.ml[459,15600+4]..[459,15600+19])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (lib/shape.ml[459,15600+15]..[459,15600+19])
                        Ptyp_constr "unit" (lib/shape.ml[459,15600+15]..[459,15600+19])
                        []
              ]
            structure_item (lib/shape.ml[460,15620+4]..[460,15620+17])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[460,15620+8]..[460,15620+12])
                    Ppat_var "fuel" (lib/shape.ml[460,15620+8]..[460,15620+12])
                  expression (lib/shape.ml[460,15620+15]..[460,15620+17])
                    Pexp_constant PConst_int (10,None)
              ]
            structure_item (lib/shape.ml[461,15638+4]..[461,15638+43])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[461,15638+8]..[461,15638+23])
                    Ppat_var "read_unit_shape" (lib/shape.ml[461,15638+8]..[461,15638+23])
                  expression (lib/shape.ml[461,15638+24]..[461,15638+43]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[461,15638+24]..[461,15638+36])
                        Labelled "unit_name"
                        None
                        pattern (lib/shape.ml[461,15638+35]..[461,15638+36])
                          Ppat_any
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[461,15638+39]..[461,15638+43])
                        Pexp_construct "None" (lib/shape.ml[461,15638+39]..[461,15638+43])
                        None
              ]
            structure_item (lib/shape.ml[462,15682+4]..[462,15682+45])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[462,15682+8]..[462,15682+18])
                    Ppat_var "find_shape" (lib/shape.ml[462,15682+8]..[462,15682+18])
                  expression (lib/shape.ml[462,15682+19]..[462,15682+45]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[462,15682+19]..[462,15682+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[462,15682+19]..[462,15682+23])
                          Ppat_var "_env" (lib/shape.ml[462,15682+19]..[462,15682+23])
                      Pparam_val (lib/shape.ml[462,15682+24]..[462,15682+27])
                        Nolabel
                        None
                        pattern (lib/shape.ml[462,15682+24]..[462,15682+27])
                          Ppat_var "_id" (lib/shape.ml[462,15682+24]..[462,15682+27])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[462,15682+30]..[462,15682+45])
                        Pexp_apply
                        expression (lib/shape.ml[462,15682+30]..[462,15682+35])
                          Pexp_ident "raise" (lib/shape.ml[462,15682+30]..[462,15682+35])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[462,15682+36]..[462,15682+45])
                              Pexp_construct "Not_found" (lib/shape.ml[462,15682+36]..[462,15682+45])
                              None
                        ]
              ]
          ]
  structure_item (lib/shape.ml[465,15736+0]..[466,15761+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[465,15736+4]..[465,15736+16])
          Ppat_var "local_reduce" (lib/shape.ml[465,15736+4]..[465,15736+16])
        expression (lib/shape.ml[465,15736+17]..[466,15761+30]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[465,15736+17]..[465,15736+22])
              Nolabel
              None
              pattern (lib/shape.ml[465,15736+17]..[465,15736+22])
                Ppat_var "shape" (lib/shape.ml[465,15736+17]..[465,15736+22])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[466,15761+2]..[466,15761+30])
              Pexp_apply
              expression (lib/shape.ml[466,15761+2]..[466,15761+21])
                Pexp_ident "Local_reduce.reduce" (lib/shape.ml[466,15761+2]..[466,15761+21])
              [
                <arg>
                Nolabel
                  expression (lib/shape.ml[466,15761+22]..[466,15761+24])
                    Pexp_construct "()" (lib/shape.ml[466,15761+22]..[466,15761+24])
                    None
                <arg>
                Nolabel
                  expression (lib/shape.ml[466,15761+25]..[466,15761+30])
                    Pexp_ident "shape" (lib/shape.ml[466,15761+25]..[466,15761+30])
              ]
    ]
  structure_item (lib/shape.ml[468,15793+0]..[468,15793+60])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[468,15793+4]..[468,15793+13])
          Ppat_var "dummy_mod" (lib/shape.ml[468,15793+4]..[468,15793+13])
        expression (lib/shape.ml[468,15793+16]..[468,15793+60])
          Pexp_record
          [
            "uid" (lib/shape.ml[468,15793+18]..[468,15793+21])
              expression (lib/shape.ml[468,15793+24]..[468,15793+28])
                Pexp_construct "None" (lib/shape.ml[468,15793+24]..[468,15793+28])
                None
            "desc" (lib/shape.ml[468,15793+30]..[468,15793+34])
              expression (lib/shape.ml[468,15793+37]..[468,15793+58])
                Pexp_construct "Struct" (lib/shape.ml[468,15793+37]..[468,15793+43])
                Some
                  expression (lib/shape.ml[468,15793+44]..[468,15793+58])
                    Pexp_ident "Item.Map.empty" (lib/shape.ml[468,15793+44]..[468,15793+58])
          ]
          None
    ]
  structure_item (lib/shape.ml[470,15855+0]..[481,16297+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[470,15855+4]..[470,15855+11])
          Ppat_var "of_path" (lib/shape.ml[470,15855+4]..[470,15855+11])
        expression (lib/shape.ml[470,15855+12]..[481,16297+15]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[470,15855+12]..[470,15855+23])
              Labelled "find_shape"
              None
              pattern (lib/shape.ml[470,15855+13]..[470,15855+23])
                Ppat_var "find_shape" (lib/shape.ml[470,15855+13]..[470,15855+23])
            Pparam_val (lib/shape.ml[470,15855+24]..[470,15855+34])
              Labelled "namespace"
              None
              pattern (lib/shape.ml[470,15855+25]..[470,15855+34])
                Ppat_var "namespace" (lib/shape.ml[470,15855+25]..[470,15855+34])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[471,15892+2]..[481,16297+15])
              Pexp_let Rec
              [
                <def>
                  pattern (lib/shape.ml[471,15892+10]..[471,15892+13])
                    Ppat_var "aux" (lib/shape.ml[471,15892+10]..[471,15892+13])
                  core_type (lib/shape.ml[471,15892+16]..[471,15892+51])
                    Ptyp_arrow
                    Nolabel
                    core_type (lib/shape.ml[471,15892+16]..[471,15892+36])
                      Ptyp_constr "Sig_component_kind.t" (lib/shape.ml[471,15892+16]..[471,15892+36])
                      []
                    core_type (lib/shape.ml[471,15892+40]..[471,15892+51])
                      Ptyp_arrow
                      Nolabel
                      core_type (lib/shape.ml[471,15892+40]..[471,15892+46])
                        Ptyp_constr "Path.t" (lib/shape.ml[471,15892+40]..[471,15892+46])
                        []
                      core_type (lib/shape.ml[471,15892+50]..[471,15892+51])
                        Ptyp_constr "t" (lib/shape.ml[471,15892+50]..[471,15892+51])
                        []
                  expression (lib/shape.ml[471,15892+54]..[479,16282+9])
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[471,15892+58]..[471,15892+60])
                        Nolabel
                        None
                        pattern (lib/shape.ml[471,15892+58]..[471,15892+60])
                          Ppat_var "ns" (lib/shape.ml[471,15892+58]..[471,15892+60])
                    ]
                    None
                    Pfunction_cases (lib/shape.ml[471,15892+64]..[479,16282+9])
                      [
                        <case>
                          pattern (lib/shape.ml[472,15965+6]..[472,15965+15])
                            Ppat_construct "Pident" (lib/shape.ml[472,15965+6]..[472,15965+12])
                            Some
                              []
                              pattern (lib/shape.ml[472,15965+13]..[472,15965+15])
                                Ppat_var "id" (lib/shape.ml[472,15965+13]..[472,15965+15])
                          expression (lib/shape.ml[472,15965+19]..[472,15965+35])
                            Pexp_apply
                            expression (lib/shape.ml[472,15965+19]..[472,15965+29])
                              Pexp_ident "find_shape" (lib/shape.ml[472,15965+19]..[472,15965+29])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[472,15965+30]..[472,15965+32])
                                  Pexp_ident "ns" (lib/shape.ml[472,15965+30]..[472,15965+32])
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[472,15965+33]..[472,15965+35])
                                  Pexp_ident "id" (lib/shape.ml[472,15965+33]..[472,15965+35])
                            ]
                        <case>
                          pattern (lib/shape.ml[473,16001+6]..[473,16001+23])
                            Ppat_construct "Pdot" (lib/shape.ml[473,16001+6]..[473,16001+10])
                            Some
                              []
                              pattern (lib/shape.ml[473,16001+11]..[473,16001+23])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[473,16001+12]..[473,16001+16])
                                    Ppat_var "path" (lib/shape.ml[473,16001+12]..[473,16001+16])
                                  pattern (lib/shape.ml[473,16001+18]..[473,16001+22])
                                    Ppat_var "name" (lib/shape.ml[473,16001+18]..[473,16001+22])
                                ]
                          expression (lib/shape.ml[473,16001+27]..[473,16001+60])
                            Pexp_apply
                            expression (lib/shape.ml[473,16001+27]..[473,16001+31])
                              Pexp_ident "proj" (lib/shape.ml[473,16001+27]..[473,16001+31])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[473,16001+32]..[473,16001+49])
                                  Pexp_apply
                                  expression (lib/shape.ml[473,16001+33]..[473,16001+36])
                                    Pexp_ident "aux" (lib/shape.ml[473,16001+33]..[473,16001+36])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[473,16001+37]..[473,16001+43])
                                        Pexp_construct "Module" (lib/shape.ml[473,16001+37]..[473,16001+43])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[473,16001+44]..[473,16001+48])
                                        Pexp_ident "path" (lib/shape.ml[473,16001+44]..[473,16001+48])
                                  ]
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[473,16001+50]..[473,16001+60])
                                  Pexp_tuple
                                  [
                                    expression (lib/shape.ml[473,16001+51]..[473,16001+55])
                                      Pexp_ident "name" (lib/shape.ml[473,16001+51]..[473,16001+55])
                                    expression (lib/shape.ml[473,16001+57]..[473,16001+59])
                                      Pexp_ident "ns" (lib/shape.ml[473,16001+57]..[473,16001+59])
                                  ]
                            ]
                        <case>
                          pattern (lib/shape.ml[474,16062+6]..[474,16062+21])
                            Ppat_construct "Papply" (lib/shape.ml[474,16062+6]..[474,16062+12])
                            Some
                              []
                              pattern (lib/shape.ml[474,16062+13]..[474,16062+21])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[474,16062+14]..[474,16062+16])
                                    Ppat_var "p1" (lib/shape.ml[474,16062+14]..[474,16062+16])
                                  pattern (lib/shape.ml[474,16062+18]..[474,16062+20])
                                    Ppat_var "p2" (lib/shape.ml[474,16062+18]..[474,16062+20])
                                ]
                          expression (lib/shape.ml[474,16062+25]..[474,16062+65])
                            Pexp_apply
                            expression (lib/shape.ml[474,16062+25]..[474,16062+28])
                              Pexp_ident "app" (lib/shape.ml[474,16062+25]..[474,16062+28])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[474,16062+29]..[474,16062+44])
                                  Pexp_apply
                                  expression (lib/shape.ml[474,16062+30]..[474,16062+33])
                                    Pexp_ident "aux" (lib/shape.ml[474,16062+30]..[474,16062+33])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16062+34]..[474,16062+40])
                                        Pexp_construct "Module" (lib/shape.ml[474,16062+34]..[474,16062+40])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16062+41]..[474,16062+43])
                                        Pexp_ident "p1" (lib/shape.ml[474,16062+41]..[474,16062+43])
                                  ]
                              <arg>
                              Labelled "arg"
                                expression (lib/shape.ml[474,16062+50]..[474,16062+65])
                                  Pexp_apply
                                  expression (lib/shape.ml[474,16062+51]..[474,16062+54])
                                    Pexp_ident "aux" (lib/shape.ml[474,16062+51]..[474,16062+54])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16062+55]..[474,16062+61])
                                        Pexp_construct "Module" (lib/shape.ml[474,16062+55]..[474,16062+61])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16062+62]..[474,16062+64])
                                        Pexp_ident "p2" (lib/shape.ml[474,16062+62]..[474,16062+64])
                                  ]
                            ]
                        <case>
                          pattern (lib/shape.ml[475,16128+6]..[475,16128+29])
                            Ppat_construct "Pextra_ty" (lib/shape.ml[475,16128+6]..[475,16128+15])
                            Some
                              []
                              pattern (lib/shape.ml[475,16128+16]..[475,16128+29])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[475,16128+17]..[475,16128+21])
                                    Ppat_var "path" (lib/shape.ml[475,16128+17]..[475,16128+21])
                                  pattern (lib/shape.ml[475,16128+23]..[475,16128+28])
                                    Ppat_var "extra" (lib/shape.ml[475,16128+23]..[475,16128+28])
                                ]
                          expression (lib/shape.ml[475,16128+33]..[479,16282+9])
                            Pexp_match
                            expression (lib/shape.ml[476,16167+14]..[476,16167+19])
                              Pexp_ident "extra" (lib/shape.ml[476,16167+14]..[476,16167+19])
                            [
                              <case>
                                pattern (lib/shape.ml[477,16192+10]..[477,16192+20])
                                  Ppat_construct "Pcstr_ty" (lib/shape.ml[477,16192+10]..[477,16192+18])
                                  Some
                                    []
                                    pattern (lib/shape.ml[477,16192+19]..[477,16192+20])
                                      Ppat_any
                                expression (lib/shape.ml[477,16192+24]..[477,16192+37])
                                  Pexp_apply
                                  expression (lib/shape.ml[477,16192+24]..[477,16192+27])
                                    Pexp_ident "aux" (lib/shape.ml[477,16192+24]..[477,16192+27])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[477,16192+28]..[477,16192+32])
                                        Pexp_construct "Type" (lib/shape.ml[477,16192+28]..[477,16192+32])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[477,16192+33]..[477,16192+37])
                                        Pexp_ident "path" (lib/shape.ml[477,16192+33]..[477,16192+37])
                                  ]
                              <case>
                                pattern (lib/shape.ml[478,16230+10]..[478,16230+17])
                                  Ppat_construct "Pext_ty" (lib/shape.ml[478,16230+10]..[478,16230+17])
                                  None
                                expression (lib/shape.ml[478,16230+21]..[478,16230+51])
                                  Pexp_apply
                                  expression (lib/shape.ml[478,16230+21]..[478,16230+24])
                                    Pexp_ident "aux" (lib/shape.ml[478,16230+21]..[478,16230+24])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[478,16230+25]..[478,16230+46])
                                        Pexp_construct "Extension_constructor" (lib/shape.ml[478,16230+25]..[478,16230+46])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[478,16230+47]..[478,16230+51])
                                        Pexp_ident "path" (lib/shape.ml[478,16230+47]..[478,16230+51])
                                  ]
                            ]
                      ]
              ]
              expression (lib/shape.ml[481,16297+2]..[481,16297+15])
                Pexp_apply
                expression (lib/shape.ml[481,16297+2]..[481,16297+5])
                  Pexp_ident "aux" (lib/shape.ml[481,16297+2]..[481,16297+5])
                [
                  <arg>
                  Nolabel
                    expression (lib/shape.ml[481,16297+6]..[481,16297+15])
                      Pexp_ident "namespace" (lib/shape.ml[481,16297+6]..[481,16297+15])
                ]
    ]
  structure_item (lib/shape.ml[483,16314+0]..[485,16415+24])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[483,16314+4]..[483,16314+23])
          Ppat_var "for_persistent_unit" (lib/shape.ml[483,16314+4]..[483,16314+23])
        expression (lib/shape.ml[483,16314+24]..[485,16415+24]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[483,16314+24]..[483,16314+25])
              Nolabel
              None
              pattern (lib/shape.ml[483,16314+24]..[483,16314+25])
                Ppat_var "s" (lib/shape.ml[483,16314+24]..[483,16314+25])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[484,16342+2]..[485,16415+24])
              Pexp_record
              [
                "uid" (lib/shape.ml[484,16342+4]..[484,16342+7])
                  expression (lib/shape.ml[484,16342+10]..[484,16342+71])
                    Pexp_construct "Some" (lib/shape.ml[484,16342+10]..[484,16342+14])
                    Some
                      expression (lib/shape.ml[484,16342+15]..[484,16342+71])
                        Pexp_apply
                        expression (lib/shape.ml[484,16342+16]..[484,16342+42])
                          Pexp_ident "Uid.of_compilation_unit_id" (lib/shape.ml[484,16342+16]..[484,16342+42])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[484,16342+43]..[484,16342+70])
                              Pexp_apply
                              expression (lib/shape.ml[484,16342+44]..[484,16342+67])
                                Pexp_ident "Ident.create_persistent" (lib/shape.ml[484,16342+44]..[484,16342+67])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[484,16342+68]..[484,16342+69])
                                    Pexp_ident "s" (lib/shape.ml[484,16342+68]..[484,16342+69])
                              ]
                        ]
                "desc" (lib/shape.ml[485,16415+4]..[485,16415+8])
                  expression (lib/shape.ml[485,16415+11]..[485,16415+22])
                    Pexp_construct "Comp_unit" (lib/shape.ml[485,16415+11]..[485,16415+20])
                    Some
                      expression (lib/shape.ml[485,16415+21]..[485,16415+22])
                        Pexp_ident "s" (lib/shape.ml[485,16415+21]..[485,16415+22])
              ]
              None
    ]
  structure_item (lib/shape.ml[487,16441+0]..[487,16441+49])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[487,16441+4]..[487,16441+19])
          Ppat_var "leaf_for_unpack" (lib/shape.ml[487,16441+4]..[487,16441+19])
        expression (lib/shape.ml[487,16441+22]..[487,16441+49])
          Pexp_record
          [
            "uid" (lib/shape.ml[487,16441+24]..[487,16441+27])
              expression (lib/shape.ml[487,16441+30]..[487,16441+34])
                Pexp_construct "None" (lib/shape.ml[487,16441+30]..[487,16441+34])
                None
            "desc" (lib/shape.ml[487,16441+36]..[487,16441+40])
              expression (lib/shape.ml[487,16441+43]..[487,16441+47])
                Pexp_construct "Leaf" (lib/shape.ml[487,16441+43]..[487,16441+47])
                None
          ]
          None
    ]
  structure_item (lib/shape.ml[489,16492+0]..[492,16577+10])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[489,16492+4]..[489,16492+19])
          Ppat_var "set_uid_if_none" (lib/shape.ml[489,16492+4]..[489,16492+19])
        expression (lib/shape.ml[489,16492+20]..[492,16577+10]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[489,16492+20]..[489,16492+21])
              Nolabel
              None
              pattern (lib/shape.ml[489,16492+20]..[489,16492+21])
                Ppat_var "t" (lib/shape.ml[489,16492+20]..[489,16492+21])
            Pparam_val (lib/shape.ml[489,16492+22]..[489,16492+25])
              Nolabel
              None
              pattern (lib/shape.ml[489,16492+22]..[489,16492+25])
                Ppat_var "uid" (lib/shape.ml[489,16492+22]..[489,16492+25])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[490,16520+2]..[492,16577+10])
              Pexp_match
              expression (lib/shape.ml[490,16520+8]..[490,16520+13])
                Pexp_field
                expression (lib/shape.ml[490,16520+8]..[490,16520+9])
                  Pexp_ident "t" (lib/shape.ml[490,16520+8]..[490,16520+9])
                "uid" (lib/shape.ml[490,16520+10]..[490,16520+13])
              [
                <case>
                  pattern (lib/shape.ml[491,16539+4]..[491,16539+8])
                    Ppat_construct "None" (lib/shape.ml[491,16539+4]..[491,16539+8])
                    None
                  expression (lib/shape.ml[491,16539+12]..[491,16539+37])
                    Pexp_record
                    [
                      "uid" (lib/shape.ml[491,16539+21]..[491,16539+24])
                        expression (lib/shape.ml[491,16539+27]..[491,16539+35])
                          Pexp_construct "Some" (lib/shape.ml[491,16539+27]..[491,16539+31])
                          Some
                            expression (lib/shape.ml[491,16539+32]..[491,16539+35])
                              Pexp_ident "uid" (lib/shape.ml[491,16539+32]..[491,16539+35])
                    ]
                    Some
                      expression (lib/shape.ml[491,16539+14]..[491,16539+15])
                        Pexp_ident "t" (lib/shape.ml[491,16539+14]..[491,16539+15])
                <case>
                  pattern (lib/shape.ml[492,16577+4]..[492,16577+5])
                    Ppat_any
                  expression (lib/shape.ml[492,16577+9]..[492,16577+10])
                    Pexp_ident "t" (lib/shape.ml[492,16577+9]..[492,16577+10])
              ]
    ]
  structure_item (lib/shape.ml[494,16589+0]..[538,18076+3])
    Pstr_module
    "Map" (lib/shape.ml[494,16589+7]..[494,16589+10])
      module_expr (lib/shape.ml[494,16589+13]..[538,18076+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[495,16609+2]..[495,16609+16])
            Pstr_type Rec
            [
              type_declaration "shape" (lib/shape.ml[495,16609+7]..[495,16609+12]) (lib/shape.ml[495,16609+2]..[495,16609+16])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (lib/shape.ml[495,16609+15]..[495,16609+16])
                      Ptyp_constr "t" (lib/shape.ml[495,16609+15]..[495,16609+16])
                      []
            ]
          structure_item (lib/shape.ml[496,16626+2]..[496,16626+30])
            Pstr_type Nonrec
            [
              type_declaration "t" (lib/shape.ml[496,16626+14]..[496,16626+15]) (lib/shape.ml[496,16626+2]..[496,16626+30])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (lib/shape.ml[496,16626+18]..[496,16626+30])
                      Ptyp_constr "Item.Map.t" (lib/shape.ml[496,16626+20]..[496,16626+30])
                      [
                        core_type (lib/shape.ml[496,16626+18]..[496,16626+19])
                          Ptyp_constr "t" (lib/shape.ml[496,16626+18]..[496,16626+19])
                          []
                      ]
            ]
          structure_item (lib/shape.ml[498,16658+2]..[498,16658+28])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[498,16658+6]..[498,16658+11])
                  Ppat_var "empty" (lib/shape.ml[498,16658+6]..[498,16658+11])
                expression (lib/shape.ml[498,16658+14]..[498,16658+28])
                  Pexp_ident "Item.Map.empty" (lib/shape.ml[498,16658+14]..[498,16658+28])
            ]
          structure_item (lib/shape.ml[500,16688+2]..[500,16688+50])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[500,16688+6]..[500,16688+9])
                  Ppat_var "add" (lib/shape.ml[500,16688+6]..[500,16688+9])
                expression (lib/shape.ml[500,16688+10]..[500,16688+50]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[500,16688+10]..[500,16688+11])
                      Nolabel
                      None
                      pattern (lib/shape.ml[500,16688+10]..[500,16688+11])
                        Ppat_var "t" (lib/shape.ml[500,16688+10]..[500,16688+11])
                    Pparam_val (lib/shape.ml[500,16688+12]..[500,16688+16])
                      Nolabel
                      None
                      pattern (lib/shape.ml[500,16688+12]..[500,16688+16])
                        Ppat_var "item" (lib/shape.ml[500,16688+12]..[500,16688+16])
                    Pparam_val (lib/shape.ml[500,16688+17]..[500,16688+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[500,16688+17]..[500,16688+22])
                        Ppat_var "shape" (lib/shape.ml[500,16688+17]..[500,16688+22])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[500,16688+25]..[500,16688+50])
                      Pexp_apply
                      expression (lib/shape.ml[500,16688+25]..[500,16688+37])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[500,16688+25]..[500,16688+37])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[500,16688+38]..[500,16688+42])
                            Pexp_ident "item" (lib/shape.ml[500,16688+38]..[500,16688+42])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[500,16688+43]..[500,16688+48])
                            Pexp_ident "shape" (lib/shape.ml[500,16688+43]..[500,16688+48])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[500,16688+49]..[500,16688+50])
                            Pexp_ident "t" (lib/shape.ml[500,16688+49]..[500,16688+50])
                      ]
            ]
          structure_item (lib/shape.ml[502,16740+2]..[502,16740+68])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[502,16740+6]..[502,16740+15])
                  Ppat_var "add_value" (lib/shape.ml[502,16740+6]..[502,16740+15])
                expression (lib/shape.ml[502,16740+16]..[502,16740+68]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[502,16740+16]..[502,16740+17])
                      Nolabel
                      None
                      pattern (lib/shape.ml[502,16740+16]..[502,16740+17])
                        Ppat_var "t" (lib/shape.ml[502,16740+16]..[502,16740+17])
                    Pparam_val (lib/shape.ml[502,16740+18]..[502,16740+20])
                      Nolabel
                      None
                      pattern (lib/shape.ml[502,16740+18]..[502,16740+20])
                        Ppat_var "id" (lib/shape.ml[502,16740+18]..[502,16740+20])
                    Pparam_val (lib/shape.ml[502,16740+21]..[502,16740+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[502,16740+21]..[502,16740+24])
                        Ppat_var "uid" (lib/shape.ml[502,16740+21]..[502,16740+24])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[502,16740+27]..[502,16740+68])
                      Pexp_apply
                      expression (lib/shape.ml[502,16740+27]..[502,16740+39])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[502,16740+27]..[502,16740+39])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[502,16740+40]..[502,16740+55])
                            Pexp_apply
                            expression (lib/shape.ml[502,16740+41]..[502,16740+51])
                              Pexp_ident "Item.value" (lib/shape.ml[502,16740+41]..[502,16740+51])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[502,16740+52]..[502,16740+54])
                                  Pexp_ident "id" (lib/shape.ml[502,16740+52]..[502,16740+54])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[502,16740+56]..[502,16740+66])
                            Pexp_apply
                            expression (lib/shape.ml[502,16740+57]..[502,16740+61])
                              Pexp_ident "leaf" (lib/shape.ml[502,16740+57]..[502,16740+61])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[502,16740+62]..[502,16740+65])
                                  Pexp_ident "uid" (lib/shape.ml[502,16740+62]..[502,16740+65])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[502,16740+67]..[502,16740+68])
                            Pexp_ident "t" (lib/shape.ml[502,16740+67]..[502,16740+68])
                      ]
            ]
          structure_item (lib/shape.ml[503,16809+2]..[505,16875+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[503,16809+6]..[503,16809+20])
                  Ppat_var "add_value_proj" (lib/shape.ml[503,16809+6]..[503,16809+20])
                expression (lib/shape.ml[503,16809+21]..[505,16875+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[503,16809+21]..[503,16809+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[503,16809+21]..[503,16809+22])
                        Ppat_var "t" (lib/shape.ml[503,16809+21]..[503,16809+22])
                    Pparam_val (lib/shape.ml[503,16809+23]..[503,16809+25])
                      Nolabel
                      None
                      pattern (lib/shape.ml[503,16809+23]..[503,16809+25])
                        Ppat_var "id" (lib/shape.ml[503,16809+23]..[503,16809+25])
                    Pparam_val (lib/shape.ml[503,16809+26]..[503,16809+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[503,16809+26]..[503,16809+31])
                        Ppat_var "shape" (lib/shape.ml[503,16809+26]..[503,16809+31])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[504,16843+4]..[505,16875+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[504,16843+8]..[504,16843+12])
                            Ppat_var "item" (lib/shape.ml[504,16843+8]..[504,16843+12])
                          expression (lib/shape.ml[504,16843+15]..[504,16843+28])
                            Pexp_apply
                            expression (lib/shape.ml[504,16843+15]..[504,16843+25])
                              Pexp_ident "Item.value" (lib/shape.ml[504,16843+15]..[504,16843+25])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[504,16843+26]..[504,16843+28])
                                  Pexp_ident "id" (lib/shape.ml[504,16843+26]..[504,16843+28])
                            ]
                      ]
                      expression (lib/shape.ml[505,16875+4]..[505,16875+41])
                        Pexp_apply
                        expression (lib/shape.ml[505,16875+4]..[505,16875+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[505,16875+4]..[505,16875+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[505,16875+17]..[505,16875+21])
                              Pexp_ident "item" (lib/shape.ml[505,16875+17]..[505,16875+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[505,16875+22]..[505,16875+39])
                              Pexp_apply
                              expression (lib/shape.ml[505,16875+23]..[505,16875+27])
                                Pexp_ident "proj" (lib/shape.ml[505,16875+23]..[505,16875+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[505,16875+28]..[505,16875+33])
                                    Pexp_ident "shape" (lib/shape.ml[505,16875+28]..[505,16875+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[505,16875+34]..[505,16875+38])
                                    Pexp_ident "item" (lib/shape.ml[505,16875+34]..[505,16875+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[505,16875+40]..[505,16875+41])
                              Pexp_ident "t" (lib/shape.ml[505,16875+40]..[505,16875+41])
                        ]
            ]
          structure_item (lib/shape.ml[507,16918+2]..[507,16918+67])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[507,16918+6]..[507,16918+14])
                  Ppat_var "add_type" (lib/shape.ml[507,16918+6]..[507,16918+14])
                expression (lib/shape.ml[507,16918+15]..[507,16918+67]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[507,16918+15]..[507,16918+16])
                      Nolabel
                      None
                      pattern (lib/shape.ml[507,16918+15]..[507,16918+16])
                        Ppat_var "t" (lib/shape.ml[507,16918+15]..[507,16918+16])
                    Pparam_val (lib/shape.ml[507,16918+17]..[507,16918+19])
                      Nolabel
                      None
                      pattern (lib/shape.ml[507,16918+17]..[507,16918+19])
                        Ppat_var "id" (lib/shape.ml[507,16918+17]..[507,16918+19])
                    Pparam_val (lib/shape.ml[507,16918+20]..[507,16918+23])
                      Nolabel
                      None
                      pattern (lib/shape.ml[507,16918+20]..[507,16918+23])
                        Ppat_var "uid" (lib/shape.ml[507,16918+20]..[507,16918+23])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[507,16918+26]..[507,16918+67])
                      Pexp_apply
                      expression (lib/shape.ml[507,16918+26]..[507,16918+38])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[507,16918+26]..[507,16918+38])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[507,16918+39]..[507,16918+54])
                            Pexp_apply
                            expression (lib/shape.ml[507,16918+40]..[507,16918+50])
                              Pexp_ident "Item.type_" (lib/shape.ml[507,16918+40]..[507,16918+50])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[507,16918+51]..[507,16918+53])
                                  Pexp_ident "id" (lib/shape.ml[507,16918+51]..[507,16918+53])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[507,16918+55]..[507,16918+65])
                            Pexp_apply
                            expression (lib/shape.ml[507,16918+56]..[507,16918+60])
                              Pexp_ident "leaf" (lib/shape.ml[507,16918+56]..[507,16918+60])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[507,16918+61]..[507,16918+64])
                                  Pexp_ident "uid" (lib/shape.ml[507,16918+61]..[507,16918+64])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[507,16918+66]..[507,16918+67])
                            Pexp_ident "t" (lib/shape.ml[507,16918+66]..[507,16918+67])
                      ]
            ]
          structure_item (lib/shape.ml[508,16986+2]..[510,17051+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[508,16986+6]..[508,16986+19])
                  Ppat_var "add_type_proj" (lib/shape.ml[508,16986+6]..[508,16986+19])
                expression (lib/shape.ml[508,16986+20]..[510,17051+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[508,16986+20]..[508,16986+21])
                      Nolabel
                      None
                      pattern (lib/shape.ml[508,16986+20]..[508,16986+21])
                        Ppat_var "t" (lib/shape.ml[508,16986+20]..[508,16986+21])
                    Pparam_val (lib/shape.ml[508,16986+22]..[508,16986+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[508,16986+22]..[508,16986+24])
                        Ppat_var "id" (lib/shape.ml[508,16986+22]..[508,16986+24])
                    Pparam_val (lib/shape.ml[508,16986+25]..[508,16986+30])
                      Nolabel
                      None
                      pattern (lib/shape.ml[508,16986+25]..[508,16986+30])
                        Ppat_var "shape" (lib/shape.ml[508,16986+25]..[508,16986+30])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[509,17019+4]..[510,17051+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[509,17019+8]..[509,17019+12])
                            Ppat_var "item" (lib/shape.ml[509,17019+8]..[509,17019+12])
                          expression (lib/shape.ml[509,17019+15]..[509,17019+28])
                            Pexp_apply
                            expression (lib/shape.ml[509,17019+15]..[509,17019+25])
                              Pexp_ident "Item.type_" (lib/shape.ml[509,17019+15]..[509,17019+25])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[509,17019+26]..[509,17019+28])
                                  Pexp_ident "id" (lib/shape.ml[509,17019+26]..[509,17019+28])
                            ]
                      ]
                      expression (lib/shape.ml[510,17051+4]..[510,17051+41])
                        Pexp_apply
                        expression (lib/shape.ml[510,17051+4]..[510,17051+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[510,17051+4]..[510,17051+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[510,17051+17]..[510,17051+21])
                              Pexp_ident "item" (lib/shape.ml[510,17051+17]..[510,17051+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[510,17051+22]..[510,17051+39])
                              Pexp_apply
                              expression (lib/shape.ml[510,17051+23]..[510,17051+27])
                                Pexp_ident "proj" (lib/shape.ml[510,17051+23]..[510,17051+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[510,17051+28]..[510,17051+33])
                                    Pexp_ident "shape" (lib/shape.ml[510,17051+28]..[510,17051+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[510,17051+34]..[510,17051+38])
                                    Pexp_ident "item" (lib/shape.ml[510,17051+34]..[510,17051+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[510,17051+40]..[510,17051+41])
                              Pexp_ident "t" (lib/shape.ml[510,17051+40]..[510,17051+41])
                        ]
            ]
          structure_item (lib/shape.ml[512,17094+2]..[512,17094+68])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[512,17094+6]..[512,17094+16])
                  Ppat_var "add_module" (lib/shape.ml[512,17094+6]..[512,17094+16])
                expression (lib/shape.ml[512,17094+17]..[512,17094+68]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[512,17094+17]..[512,17094+18])
                      Nolabel
                      None
                      pattern (lib/shape.ml[512,17094+17]..[512,17094+18])
                        Ppat_var "t" (lib/shape.ml[512,17094+17]..[512,17094+18])
                    Pparam_val (lib/shape.ml[512,17094+19]..[512,17094+21])
                      Nolabel
                      None
                      pattern (lib/shape.ml[512,17094+19]..[512,17094+21])
                        Ppat_var "id" (lib/shape.ml[512,17094+19]..[512,17094+21])
                    Pparam_val (lib/shape.ml[512,17094+22]..[512,17094+27])
                      Nolabel
                      None
                      pattern (lib/shape.ml[512,17094+22]..[512,17094+27])
                        Ppat_var "shape" (lib/shape.ml[512,17094+22]..[512,17094+27])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[512,17094+30]..[512,17094+68])
                      Pexp_apply
                      expression (lib/shape.ml[512,17094+30]..[512,17094+42])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[512,17094+30]..[512,17094+42])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[512,17094+43]..[512,17094+60])
                            Pexp_apply
                            expression (lib/shape.ml[512,17094+44]..[512,17094+56])
                              Pexp_ident "Item.module_" (lib/shape.ml[512,17094+44]..[512,17094+56])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[512,17094+57]..[512,17094+59])
                                  Pexp_ident "id" (lib/shape.ml[512,17094+57]..[512,17094+59])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[512,17094+61]..[512,17094+66])
                            Pexp_ident "shape" (lib/shape.ml[512,17094+61]..[512,17094+66])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[512,17094+67]..[512,17094+68])
                            Pexp_ident "t" (lib/shape.ml[512,17094+67]..[512,17094+68])
                      ]
            ]
          structure_item (lib/shape.ml[513,17163+2]..[515,17232+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[513,17163+6]..[513,17163+21])
                  Ppat_var "add_module_proj" (lib/shape.ml[513,17163+6]..[513,17163+21])
                expression (lib/shape.ml[513,17163+22]..[515,17232+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[513,17163+22]..[513,17163+23])
                      Nolabel
                      None
                      pattern (lib/shape.ml[513,17163+22]..[513,17163+23])
                        Ppat_var "t" (lib/shape.ml[513,17163+22]..[513,17163+23])
                    Pparam_val (lib/shape.ml[513,17163+24]..[513,17163+26])
                      Nolabel
                      None
                      pattern (lib/shape.ml[513,17163+24]..[513,17163+26])
                        Ppat_var "id" (lib/shape.ml[513,17163+24]..[513,17163+26])
                    Pparam_val (lib/shape.ml[513,17163+27]..[513,17163+32])
                      Nolabel
                      None
                      pattern (lib/shape.ml[513,17163+27]..[513,17163+32])
                        Ppat_var "shape" (lib/shape.ml[513,17163+27]..[513,17163+32])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[514,17198+4]..[515,17232+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[514,17198+8]..[514,17198+12])
                            Ppat_var "item" (lib/shape.ml[514,17198+8]..[514,17198+12])
                          expression (lib/shape.ml[514,17198+15]..[514,17198+30])
                            Pexp_apply
                            expression (lib/shape.ml[514,17198+15]..[514,17198+27])
                              Pexp_ident "Item.module_" (lib/shape.ml[514,17198+15]..[514,17198+27])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[514,17198+28]..[514,17198+30])
                                  Pexp_ident "id" (lib/shape.ml[514,17198+28]..[514,17198+30])
                            ]
                      ]
                      expression (lib/shape.ml[515,17232+4]..[515,17232+41])
                        Pexp_apply
                        expression (lib/shape.ml[515,17232+4]..[515,17232+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[515,17232+4]..[515,17232+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[515,17232+17]..[515,17232+21])
                              Pexp_ident "item" (lib/shape.ml[515,17232+17]..[515,17232+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[515,17232+22]..[515,17232+39])
                              Pexp_apply
                              expression (lib/shape.ml[515,17232+23]..[515,17232+27])
                                Pexp_ident "proj" (lib/shape.ml[515,17232+23]..[515,17232+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[515,17232+28]..[515,17232+33])
                                    Pexp_ident "shape" (lib/shape.ml[515,17232+28]..[515,17232+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[515,17232+34]..[515,17232+38])
                                    Pexp_ident "item" (lib/shape.ml[515,17232+34]..[515,17232+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[515,17232+40]..[515,17232+41])
                              Pexp_ident "t" (lib/shape.ml[515,17232+40]..[515,17232+41])
                        ]
            ]
          structure_item (lib/shape.ml[517,17275+2]..[518,17308+51])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[517,17275+6]..[517,17275+21])
                  Ppat_var "add_module_type" (lib/shape.ml[517,17275+6]..[517,17275+21])
                expression (lib/shape.ml[517,17275+22]..[518,17308+51]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[517,17275+22]..[517,17275+23])
                      Nolabel
                      None
                      pattern (lib/shape.ml[517,17275+22]..[517,17275+23])
                        Ppat_var "t" (lib/shape.ml[517,17275+22]..[517,17275+23])
                    Pparam_val (lib/shape.ml[517,17275+24]..[517,17275+26])
                      Nolabel
                      None
                      pattern (lib/shape.ml[517,17275+24]..[517,17275+26])
                        Ppat_var "id" (lib/shape.ml[517,17275+24]..[517,17275+26])
                    Pparam_val (lib/shape.ml[517,17275+27]..[517,17275+30])
                      Nolabel
                      None
                      pattern (lib/shape.ml[517,17275+27]..[517,17275+30])
                        Ppat_var "uid" (lib/shape.ml[517,17275+27]..[517,17275+30])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[518,17308+4]..[518,17308+51])
                      Pexp_apply
                      expression (lib/shape.ml[518,17308+4]..[518,17308+16])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[518,17308+4]..[518,17308+16])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[518,17308+17]..[518,17308+38])
                            Pexp_apply
                            expression (lib/shape.ml[518,17308+18]..[518,17308+34])
                              Pexp_ident "Item.module_type" (lib/shape.ml[518,17308+18]..[518,17308+34])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[518,17308+35]..[518,17308+37])
                                  Pexp_ident "id" (lib/shape.ml[518,17308+35]..[518,17308+37])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[518,17308+39]..[518,17308+49])
                            Pexp_apply
                            expression (lib/shape.ml[518,17308+40]..[518,17308+44])
                              Pexp_ident "leaf" (lib/shape.ml[518,17308+40]..[518,17308+44])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[518,17308+45]..[518,17308+48])
                                  Pexp_ident "uid" (lib/shape.ml[518,17308+45]..[518,17308+48])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[518,17308+50]..[518,17308+51])
                            Pexp_ident "t" (lib/shape.ml[518,17308+50]..[518,17308+51])
                      ]
            ]
          structure_item (lib/shape.ml[519,17360+2]..[521,17438+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[519,17360+6]..[519,17360+26])
                  Ppat_var "add_module_type_proj" (lib/shape.ml[519,17360+6]..[519,17360+26])
                expression (lib/shape.ml[519,17360+27]..[521,17438+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[519,17360+27]..[519,17360+28])
                      Nolabel
                      None
                      pattern (lib/shape.ml[519,17360+27]..[519,17360+28])
                        Ppat_var "t" (lib/shape.ml[519,17360+27]..[519,17360+28])
                    Pparam_val (lib/shape.ml[519,17360+29]..[519,17360+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[519,17360+29]..[519,17360+31])
                        Ppat_var "id" (lib/shape.ml[519,17360+29]..[519,17360+31])
                    Pparam_val (lib/shape.ml[519,17360+32]..[519,17360+37])
                      Nolabel
                      None
                      pattern (lib/shape.ml[519,17360+32]..[519,17360+37])
                        Ppat_var "shape" (lib/shape.ml[519,17360+32]..[519,17360+37])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[520,17400+4]..[521,17438+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[520,17400+8]..[520,17400+12])
                            Ppat_var "item" (lib/shape.ml[520,17400+8]..[520,17400+12])
                          expression (lib/shape.ml[520,17400+15]..[520,17400+34])
                            Pexp_apply
                            expression (lib/shape.ml[520,17400+15]..[520,17400+31])
                              Pexp_ident "Item.module_type" (lib/shape.ml[520,17400+15]..[520,17400+31])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[520,17400+32]..[520,17400+34])
                                  Pexp_ident "id" (lib/shape.ml[520,17400+32]..[520,17400+34])
                            ]
                      ]
                      expression (lib/shape.ml[521,17438+4]..[521,17438+41])
                        Pexp_apply
                        expression (lib/shape.ml[521,17438+4]..[521,17438+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[521,17438+4]..[521,17438+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[521,17438+17]..[521,17438+21])
                              Pexp_ident "item" (lib/shape.ml[521,17438+17]..[521,17438+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[521,17438+22]..[521,17438+39])
                              Pexp_apply
                              expression (lib/shape.ml[521,17438+23]..[521,17438+27])
                                Pexp_ident "proj" (lib/shape.ml[521,17438+23]..[521,17438+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[521,17438+28]..[521,17438+33])
                                    Pexp_ident "shape" (lib/shape.ml[521,17438+28]..[521,17438+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[521,17438+34]..[521,17438+38])
                                    Pexp_ident "item" (lib/shape.ml[521,17438+34]..[521,17438+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[521,17438+40]..[521,17438+41])
                              Pexp_ident "t" (lib/shape.ml[521,17438+40]..[521,17438+41])
                        ]
            ]
          structure_item (lib/shape.ml[523,17481+2]..[524,17510+61])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[523,17481+6]..[523,17481+17])
                  Ppat_var "add_extcons" (lib/shape.ml[523,17481+6]..[523,17481+17])
                expression (lib/shape.ml[523,17481+18]..[524,17510+61]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[523,17481+18]..[523,17481+19])
                      Nolabel
                      None
                      pattern (lib/shape.ml[523,17481+18]..[523,17481+19])
                        Ppat_var "t" (lib/shape.ml[523,17481+18]..[523,17481+19])
                    Pparam_val (lib/shape.ml[523,17481+20]..[523,17481+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[523,17481+20]..[523,17481+22])
                        Ppat_var "id" (lib/shape.ml[523,17481+20]..[523,17481+22])
                    Pparam_val (lib/shape.ml[523,17481+23]..[523,17481+26])
                      Nolabel
                      None
                      pattern (lib/shape.ml[523,17481+23]..[523,17481+26])
                        Ppat_var "uid" (lib/shape.ml[523,17481+23]..[523,17481+26])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[524,17510+4]..[524,17510+61])
                      Pexp_apply
                      expression (lib/shape.ml[524,17510+4]..[524,17510+16])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[524,17510+4]..[524,17510+16])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[524,17510+17]..[524,17510+48])
                            Pexp_apply
                            expression (lib/shape.ml[524,17510+18]..[524,17510+44])
                              Pexp_ident "Item.extension_constructor" (lib/shape.ml[524,17510+18]..[524,17510+44])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[524,17510+45]..[524,17510+47])
                                  Pexp_ident "id" (lib/shape.ml[524,17510+45]..[524,17510+47])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[524,17510+49]..[524,17510+59])
                            Pexp_apply
                            expression (lib/shape.ml[524,17510+50]..[524,17510+54])
                              Pexp_ident "leaf" (lib/shape.ml[524,17510+50]..[524,17510+54])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[524,17510+55]..[524,17510+58])
                                  Pexp_ident "uid" (lib/shape.ml[524,17510+55]..[524,17510+58])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[524,17510+60]..[524,17510+61])
                            Pexp_ident "t" (lib/shape.ml[524,17510+60]..[524,17510+61])
                      ]
            ]
          structure_item (lib/shape.ml[525,17572+2]..[527,17656+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[525,17572+6]..[525,17572+22])
                  Ppat_var "add_extcons_proj" (lib/shape.ml[525,17572+6]..[525,17572+22])
                expression (lib/shape.ml[525,17572+23]..[527,17656+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[525,17572+23]..[525,17572+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[525,17572+23]..[525,17572+24])
                        Ppat_var "t" (lib/shape.ml[525,17572+23]..[525,17572+24])
                    Pparam_val (lib/shape.ml[525,17572+25]..[525,17572+27])
                      Nolabel
                      None
                      pattern (lib/shape.ml[525,17572+25]..[525,17572+27])
                        Ppat_var "id" (lib/shape.ml[525,17572+25]..[525,17572+27])
                    Pparam_val (lib/shape.ml[525,17572+28]..[525,17572+33])
                      Nolabel
                      None
                      pattern (lib/shape.ml[525,17572+28]..[525,17572+33])
                        Ppat_var "shape" (lib/shape.ml[525,17572+28]..[525,17572+33])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[526,17608+4]..[527,17656+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[526,17608+8]..[526,17608+12])
                            Ppat_var "item" (lib/shape.ml[526,17608+8]..[526,17608+12])
                          expression (lib/shape.ml[526,17608+15]..[526,17608+44])
                            Pexp_apply
                            expression (lib/shape.ml[526,17608+15]..[526,17608+41])
                              Pexp_ident "Item.extension_constructor" (lib/shape.ml[526,17608+15]..[526,17608+41])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[526,17608+42]..[526,17608+44])
                                  Pexp_ident "id" (lib/shape.ml[526,17608+42]..[526,17608+44])
                            ]
                      ]
                      expression (lib/shape.ml[527,17656+4]..[527,17656+41])
                        Pexp_apply
                        expression (lib/shape.ml[527,17656+4]..[527,17656+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[527,17656+4]..[527,17656+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[527,17656+17]..[527,17656+21])
                              Pexp_ident "item" (lib/shape.ml[527,17656+17]..[527,17656+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[527,17656+22]..[527,17656+39])
                              Pexp_apply
                              expression (lib/shape.ml[527,17656+23]..[527,17656+27])
                                Pexp_ident "proj" (lib/shape.ml[527,17656+23]..[527,17656+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[527,17656+28]..[527,17656+33])
                                    Pexp_ident "shape" (lib/shape.ml[527,17656+28]..[527,17656+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[527,17656+34]..[527,17656+38])
                                    Pexp_ident "item" (lib/shape.ml[527,17656+34]..[527,17656+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[527,17656+40]..[527,17656+41])
                              Pexp_ident "t" (lib/shape.ml[527,17656+40]..[527,17656+41])
                        ]
            ]
          structure_item (lib/shape.ml[529,17699+2]..[529,17699+69])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[529,17699+6]..[529,17699+15])
                  Ppat_var "add_class" (lib/shape.ml[529,17699+6]..[529,17699+15])
                expression (lib/shape.ml[529,17699+16]..[529,17699+69]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[529,17699+16]..[529,17699+17])
                      Nolabel
                      None
                      pattern (lib/shape.ml[529,17699+16]..[529,17699+17])
                        Ppat_var "t" (lib/shape.ml[529,17699+16]..[529,17699+17])
                    Pparam_val (lib/shape.ml[529,17699+18]..[529,17699+20])
                      Nolabel
                      None
                      pattern (lib/shape.ml[529,17699+18]..[529,17699+20])
                        Ppat_var "id" (lib/shape.ml[529,17699+18]..[529,17699+20])
                    Pparam_val (lib/shape.ml[529,17699+21]..[529,17699+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[529,17699+21]..[529,17699+24])
                        Ppat_var "uid" (lib/shape.ml[529,17699+21]..[529,17699+24])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[529,17699+27]..[529,17699+69])
                      Pexp_apply
                      expression (lib/shape.ml[529,17699+27]..[529,17699+39])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[529,17699+27]..[529,17699+39])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[529,17699+40]..[529,17699+56])
                            Pexp_apply
                            expression (lib/shape.ml[529,17699+41]..[529,17699+52])
                              Pexp_ident "Item.class_" (lib/shape.ml[529,17699+41]..[529,17699+52])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[529,17699+53]..[529,17699+55])
                                  Pexp_ident "id" (lib/shape.ml[529,17699+53]..[529,17699+55])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[529,17699+57]..[529,17699+67])
                            Pexp_apply
                            expression (lib/shape.ml[529,17699+58]..[529,17699+62])
                              Pexp_ident "leaf" (lib/shape.ml[529,17699+58]..[529,17699+62])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[529,17699+63]..[529,17699+66])
                                  Pexp_ident "uid" (lib/shape.ml[529,17699+63]..[529,17699+66])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[529,17699+68]..[529,17699+69])
                            Pexp_ident "t" (lib/shape.ml[529,17699+68]..[529,17699+69])
                      ]
            ]
          structure_item (lib/shape.ml[530,17769+2]..[532,17836+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[530,17769+6]..[530,17769+20])
                  Ppat_var "add_class_proj" (lib/shape.ml[530,17769+6]..[530,17769+20])
                expression (lib/shape.ml[530,17769+21]..[532,17836+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[530,17769+21]..[530,17769+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[530,17769+21]..[530,17769+22])
                        Ppat_var "t" (lib/shape.ml[530,17769+21]..[530,17769+22])
                    Pparam_val (lib/shape.ml[530,17769+23]..[530,17769+25])
                      Nolabel
                      None
                      pattern (lib/shape.ml[530,17769+23]..[530,17769+25])
                        Ppat_var "id" (lib/shape.ml[530,17769+23]..[530,17769+25])
                    Pparam_val (lib/shape.ml[530,17769+26]..[530,17769+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[530,17769+26]..[530,17769+31])
                        Ppat_var "shape" (lib/shape.ml[530,17769+26]..[530,17769+31])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[531,17803+4]..[532,17836+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[531,17803+8]..[531,17803+12])
                            Ppat_var "item" (lib/shape.ml[531,17803+8]..[531,17803+12])
                          expression (lib/shape.ml[531,17803+15]..[531,17803+29])
                            Pexp_apply
                            expression (lib/shape.ml[531,17803+15]..[531,17803+26])
                              Pexp_ident "Item.class_" (lib/shape.ml[531,17803+15]..[531,17803+26])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[531,17803+27]..[531,17803+29])
                                  Pexp_ident "id" (lib/shape.ml[531,17803+27]..[531,17803+29])
                            ]
                      ]
                      expression (lib/shape.ml[532,17836+4]..[532,17836+41])
                        Pexp_apply
                        expression (lib/shape.ml[532,17836+4]..[532,17836+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[532,17836+4]..[532,17836+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[532,17836+17]..[532,17836+21])
                              Pexp_ident "item" (lib/shape.ml[532,17836+17]..[532,17836+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[532,17836+22]..[532,17836+39])
                              Pexp_apply
                              expression (lib/shape.ml[532,17836+23]..[532,17836+27])
                                Pexp_ident "proj" (lib/shape.ml[532,17836+23]..[532,17836+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[532,17836+28]..[532,17836+33])
                                    Pexp_ident "shape" (lib/shape.ml[532,17836+28]..[532,17836+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[532,17836+34]..[532,17836+38])
                                    Pexp_ident "item" (lib/shape.ml[532,17836+34]..[532,17836+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[532,17836+40]..[532,17836+41])
                              Pexp_ident "t" (lib/shape.ml[532,17836+40]..[532,17836+41])
                        ]
            ]
          structure_item (lib/shape.ml[534,17879+2]..[534,17879+78])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[534,17879+6]..[534,17879+20])
                  Ppat_var "add_class_type" (lib/shape.ml[534,17879+6]..[534,17879+20])
                expression (lib/shape.ml[534,17879+21]..[534,17879+78]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[534,17879+21]..[534,17879+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[534,17879+21]..[534,17879+22])
                        Ppat_var "t" (lib/shape.ml[534,17879+21]..[534,17879+22])
                    Pparam_val (lib/shape.ml[534,17879+23]..[534,17879+25])
                      Nolabel
                      None
                      pattern (lib/shape.ml[534,17879+23]..[534,17879+25])
                        Ppat_var "id" (lib/shape.ml[534,17879+23]..[534,17879+25])
                    Pparam_val (lib/shape.ml[534,17879+26]..[534,17879+29])
                      Nolabel
                      None
                      pattern (lib/shape.ml[534,17879+26]..[534,17879+29])
                        Ppat_var "uid" (lib/shape.ml[534,17879+26]..[534,17879+29])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[534,17879+32]..[534,17879+78])
                      Pexp_apply
                      expression (lib/shape.ml[534,17879+32]..[534,17879+44])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[534,17879+32]..[534,17879+44])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[534,17879+45]..[534,17879+65])
                            Pexp_apply
                            expression (lib/shape.ml[534,17879+46]..[534,17879+61])
                              Pexp_ident "Item.class_type" (lib/shape.ml[534,17879+46]..[534,17879+61])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[534,17879+62]..[534,17879+64])
                                  Pexp_ident "id" (lib/shape.ml[534,17879+62]..[534,17879+64])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[534,17879+66]..[534,17879+76])
                            Pexp_apply
                            expression (lib/shape.ml[534,17879+67]..[534,17879+71])
                              Pexp_ident "leaf" (lib/shape.ml[534,17879+67]..[534,17879+71])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[534,17879+72]..[534,17879+75])
                                  Pexp_ident "uid" (lib/shape.ml[534,17879+72]..[534,17879+75])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[534,17879+77]..[534,17879+78])
                            Pexp_ident "t" (lib/shape.ml[534,17879+77]..[534,17879+78])
                      ]
            ]
          structure_item (lib/shape.ml[535,17958+2]..[537,18034+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[535,17958+6]..[535,17958+25])
                  Ppat_var "add_class_type_proj" (lib/shape.ml[535,17958+6]..[535,17958+25])
                expression (lib/shape.ml[535,17958+26]..[537,18034+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[535,17958+26]..[535,17958+27])
                      Nolabel
                      None
                      pattern (lib/shape.ml[535,17958+26]..[535,17958+27])
                        Ppat_var "t" (lib/shape.ml[535,17958+26]..[535,17958+27])
                    Pparam_val (lib/shape.ml[535,17958+28]..[535,17958+30])
                      Nolabel
                      None
                      pattern (lib/shape.ml[535,17958+28]..[535,17958+30])
                        Ppat_var "id" (lib/shape.ml[535,17958+28]..[535,17958+30])
                    Pparam_val (lib/shape.ml[535,17958+31]..[535,17958+36])
                      Nolabel
                      None
                      pattern (lib/shape.ml[535,17958+31]..[535,17958+36])
                        Ppat_var "shape" (lib/shape.ml[535,17958+31]..[535,17958+36])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[536,17997+4]..[537,18034+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[536,17997+8]..[536,17997+12])
                            Ppat_var "item" (lib/shape.ml[536,17997+8]..[536,17997+12])
                          expression (lib/shape.ml[536,17997+15]..[536,17997+33])
                            Pexp_apply
                            expression (lib/shape.ml[536,17997+15]..[536,17997+30])
                              Pexp_ident "Item.class_type" (lib/shape.ml[536,17997+15]..[536,17997+30])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[536,17997+31]..[536,17997+33])
                                  Pexp_ident "id" (lib/shape.ml[536,17997+31]..[536,17997+33])
                            ]
                      ]
                      expression (lib/shape.ml[537,18034+4]..[537,18034+41])
                        Pexp_apply
                        expression (lib/shape.ml[537,18034+4]..[537,18034+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[537,18034+4]..[537,18034+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[537,18034+17]..[537,18034+21])
                              Pexp_ident "item" (lib/shape.ml[537,18034+17]..[537,18034+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[537,18034+22]..[537,18034+39])
                              Pexp_apply
                              expression (lib/shape.ml[537,18034+23]..[537,18034+27])
                                Pexp_ident "proj" (lib/shape.ml[537,18034+23]..[537,18034+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[537,18034+28]..[537,18034+33])
                                    Pexp_ident "shape" (lib/shape.ml[537,18034+28]..[537,18034+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[537,18034+34]..[537,18034+38])
                                    Pexp_ident "item" (lib/shape.ml[537,18034+34]..[537,18034+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[537,18034+40]..[537,18034+41])
                              Pexp_ident "t" (lib/shape.ml[537,18034+40]..[537,18034+41])
                        ]
            ]
        ]
]

module Uid =
  struct
    type t =
      | Compilation_unit of string 
      | Item of {
      comp_unit: string ;
      id: int } 
      | Internal 
      | Predef of string 
    include
      (Identifiable.Make)(struct
                            type nonrec t = t
                            let equal (x : t) y = x = y
                            let compare (x : t) y = compare x y
                            let hash (x : t) = Hashtbl.hash x
                            let print fmt =
                              function
                              | Internal ->
                                  Format.pp_print_string fmt "<internal>"
                              | Predef name ->
                                  Format.fprintf fmt "<predef:%s>" name
                              | Compilation_unit s ->
                                  Format.pp_print_string fmt s
                              | Item { comp_unit; id } ->
                                  Format.fprintf fmt "%s.%d" comp_unit id
                            let output oc t =
                              let fmt = Format.formatter_of_out_channel oc in
                              print fmt t
                          end)
    let id = ref (-1)
    let reinit () = id := (-1)
    let mk ~current_unit =
      incr id; Item { comp_unit = current_unit; id = (!id) }
    let of_compilation_unit_id id =
      if not (Ident.persistent id)
      then
        Misc.fatal_errorf "Types.Uid.of_compilation_unit_id %S"
          (Ident.name id);
      Compilation_unit (Ident.name id)
    let of_predef_id id =
      if not (Ident.is_predef id)
      then Misc.fatal_errorf "Types.Uid.of_predef_id %S" (Ident.name id);
      Predef (Ident.name id)
    let internal_not_actually_unique = Internal
    let for_actual_declaration = function | Item _ -> true | _ -> false
  end
module Sig_component_kind =
  struct
    type t =
      | Value 
      | Type 
      | Module 
      | Module_type 
      | Extension_constructor 
      | Class 
      | Class_type 
    let to_string =
      function
      | Value -> "value"
      | Type -> "type"
      | Module -> "module"
      | Module_type -> "module type"
      | Extension_constructor -> "extension constructor"
      | Class -> "class"
      | Class_type -> "class type"
    let can_appear_in_types =
      function
      | Value | Extension_constructor -> false
      | Type | Module | Module_type | Class | Class_type -> true
  end
module Item =
  struct
    module T =
      struct
        type t = (string * Sig_component_kind.t)
        let compare = compare
        let make str ns = (str, ns)
        let value id = ((Ident.name id), Sig_component_kind.Value)
        let type_ id = ((Ident.name id), Sig_component_kind.Type)
        let module_ id = ((Ident.name id), Sig_component_kind.Module)
        let module_type id =
          ((Ident.name id), Sig_component_kind.Module_type)
        let extension_constructor id =
          ((Ident.name id), Sig_component_kind.Extension_constructor)
        let class_ id = ((Ident.name id), Sig_component_kind.Class)
        let class_type id = ((Ident.name id), Sig_component_kind.Class_type)
        let print fmt (name, ns) =
          Format.fprintf fmt "%S[%s]" name (Sig_component_kind.to_string ns)
      end
    include T
    module Map = (Map.Make)(T)
  end
type var = Ident.t
type t = {
  uid: Uid.t option ;
  desc: desc }
and desc =
  | Var of var 
  | Abs of var * t 
  | App of t * t 
  | Struct of t Item.Map.t 
  | Leaf 
  | Proj of t * Item.t 
  | Comp_unit of string 
let print fmt =
  let print_uid_opt =
    Format.pp_print_option (fun fmt -> Format.fprintf fmt "<%a>" Uid.print) in
  let rec aux fmt { uid; desc } =
    match desc with
    | Var id -> Format.fprintf fmt "%a%a" Ident.print id print_uid_opt uid
    | Abs (id, t) ->
        let rec collect_idents =
          function
          | { uid = None; desc = Abs (id, t) } ->
              let (ids, body) = collect_idents t in ((id :: ids), body)
          | body -> ([], body) in
        let (other_idents, body) = collect_idents t in
        let pp_idents fmt idents =
          let pp_sep fmt () = Format.fprintf fmt ",@ " in
          Format.pp_print_list ~pp_sep Ident.print fmt idents in
        Format.fprintf fmt "Abs@[%a@,(@[%a,@ @[%a@]@])@]" print_uid_opt uid
          pp_idents (id :: other_idents) aux body
    | App (t1, t2) ->
        Format.fprintf fmt "@[%a(@,%a)%a@]" aux t1 aux t2 print_uid_opt uid
    | Leaf ->
        Format.fprintf fmt "<%a>" (Format.pp_print_option Uid.print) uid
    | Proj (t, item) ->
        (match uid with
         | None -> Format.fprintf fmt "@[%a@ .@ %a@]" aux t Item.print item
         | Some uid ->
             Format.fprintf fmt "@[(%a@ .@ %a)<%a>@]" aux t Item.print item
               Uid.print uid)
    | Comp_unit name -> Format.fprintf fmt "CU %s" name
    | Struct map ->
        let print_map fmt =
          Item.Map.iter
            (fun item t ->
               Format.fprintf fmt "@[<hv 2>%a ->@ %a;@]@," Item.print item
                 aux t) in
        Format.fprintf fmt "{@[<v>%a@,%a@]}" print_uid_opt uid print_map map in
  Format.fprintf fmt "@[%a@]@;" aux
let fresh_var ?(name= "shape-var") uid =
  let var = Ident.create_local name in
  (var, { uid = (Some uid); desc = (Var var) })
let for_unnamed_functor_param = Ident.create_local "()"
let var uid id = { uid = (Some uid); desc = (Var id) }
let abs ?uid var body = { uid; desc = (Abs (var, body)) }
let str ?uid map = { uid; desc = (Struct map) }
let leaf uid = { uid = (Some uid); desc = Leaf }
let proj ?uid t item =
  match t.desc with
  | Leaf -> t
  | Struct map -> (try Item.Map.find item map with | Not_found -> t)
  | _ -> { uid; desc = (Proj (t, item)) }
let app ?uid f ~arg = { uid; desc = (App (f, arg)) }
let decompose_abs t =
  match t.desc with | Abs (x, t) -> Some (x, t) | _ -> None
module Make_reduce(Params:sig
                            type env
                            val fuel : int
                            val read_unit_shape :
                              unit_name:string -> t option
                            val find_shape : env -> Ident.t -> t
                          end) =
  struct
    type nf = {
      uid: Uid.t option ;
      desc: nf_desc }
    and nf_desc =
      | NVar of var 
      | NApp of nf * nf 
      | NAbs of local_env * var * t * delayed_nf 
      | NStruct of delayed_nf Item.Map.t 
      | NProj of nf * Item.t 
      | NLeaf 
      | NComp_unit of string 
      | NoFuelLeft of desc 
    and delayed_nf =
      | Thunk of local_env * t 
    and local_env = delayed_nf option Ident.Map.t
    let improve_uid uid (nf : nf) =
      match nf.uid with | Some _ -> nf | None -> { nf with uid }
    let in_memo_table memo_table memo_key f arg =
      match Hashtbl.find memo_table memo_key with
      | res -> res
      | exception Not_found ->
          let res = f arg in (Hashtbl.replace memo_table memo_key res; res)
    type env =
      {
      fuel: int ref ;
      global_env: Params.env ;
      local_env: local_env ;
      reduce_memo_table: ((local_env * t), nf) Hashtbl.t ;
      read_back_memo_table: (nf, t) Hashtbl.t }
    let bind env var shape =
      { env with local_env = (Ident.Map.add var shape env.local_env) }
    let rec reduce_ env t =
      let memo_key = ((env.local_env), t) in
      in_memo_table env.reduce_memo_table memo_key (reduce__ env) t
    and reduce__ ({ fuel; global_env; local_env;_} as env) (t : t) =
      let reduce env t = reduce_ env t in
      let delay_reduce env t = Thunk ((env.local_env), t) in
      let force (Thunk (local_env, t)) = reduce { env with local_env } t in
      let return desc : nf= { uid = (t.uid); desc } in
      if (!fuel) < 0
      then return (NoFuelLeft (t.desc))
      else
        (match t.desc with
         | Comp_unit unit_name ->
             (match Params.read_unit_shape ~unit_name with
              | Some t -> reduce env t
              | None -> return (NComp_unit unit_name))
         | App (f, arg) ->
             let f = reduce env f in
             (match f.desc with
              | NAbs (clos_env, var, body, _body_nf) ->
                  let arg = delay_reduce env arg in
                  let env =
                    bind { env with local_env = clos_env } var (Some arg) in
                  (reduce env body) |> (improve_uid t.uid)
              | _ -> let arg = reduce env arg in return (NApp (f, arg)))
         | Proj (str, item) ->
             let str = reduce env str in
             let nored () = return (NProj (str, item)) in
             (match str.desc with
              | NStruct items ->
                  (match Item.Map.find item items with
                   | exception Not_found -> nored ()
                   | nf -> (force nf) |> (improve_uid t.uid))
              | _ -> nored ())
         | Abs (var, body) ->
             let body_nf = delay_reduce (bind env var None) body in
             return (NAbs (local_env, var, body, body_nf))
         | Var id ->
             (match Ident.Map.find id local_env with
              | None -> return (NVar id)
              | Some def -> force def
              | exception Not_found ->
                  (match Params.find_shape global_env id with
                   | exception Not_found -> return (NVar id)
                   | res when res = t -> return (NVar id)
                   | res -> (decr fuel; reduce env res)))
         | Leaf -> return NLeaf
         | Struct m ->
             let mnf = Item.Map.map (delay_reduce env) m in
             return (NStruct mnf))
    let rec read_back env (nf : nf) : t=
      in_memo_table env.read_back_memo_table nf (read_back_ env) nf
    and read_back_ env (nf : nf) : t=
      { uid = (nf.uid); desc = (read_back_desc env nf.desc) }
    and read_back_desc env desc =
      let read_back nf = read_back env nf in
      let read_back_force (Thunk (local_env, t)) =
        read_back (reduce_ { env with local_env } t) in
      match desc with
      | NVar v -> Var v
      | NApp (nft, nfu) -> App ((read_back nft), (read_back nfu))
      | NAbs (_env, x, _t, nf) -> Abs (x, (read_back_force nf))
      | NStruct nstr -> Struct (Item.Map.map read_back_force nstr)
      | NProj (nf, item) -> Proj ((read_back nf), item)
      | NLeaf -> Leaf
      | NComp_unit s -> Comp_unit s
      | NoFuelLeft t -> t
    let reduce global_env t =
      let fuel = ref Params.fuel in
      let reduce_memo_table = Hashtbl.create 42 in
      let read_back_memo_table = Hashtbl.create 42 in
      let local_env = Ident.Map.empty in
      let env =
        {
          fuel;
          global_env;
          reduce_memo_table;
          read_back_memo_table;
          local_env
        } in
      (reduce_ env t) |> (read_back env)
  end
module Local_reduce =
  (Make_reduce)(struct
                  type env = unit
                  let fuel = 10
                  let read_unit_shape ~unit_name:_ = None
                  let find_shape _env _id = raise Not_found
                end)
let local_reduce shape = Local_reduce.reduce () shape
let dummy_mod = { uid = None; desc = (Struct Item.Map.empty) }
let of_path ~find_shape ~namespace =
  let rec aux : Sig_component_kind.t -> Path.t -> t =
    fun ns ->
      function
      | Pident id -> find_shape ns id
      | Pdot (path, name) -> proj (aux Module path) (name, ns)
      | Papply (p1, p2) -> app (aux Module p1) ~arg:(aux Module p2)
      | Pextra_ty (path, extra) ->
          (match extra with
           | Pcstr_ty _ -> aux Type path
           | Pext_ty -> aux Extension_constructor path) in
  aux namespace
let for_persistent_unit s =
  {
    uid = (Some (Uid.of_compilation_unit_id (Ident.create_persistent s)));
    desc = (Comp_unit s)
  }
let leaf_for_unpack = { uid = None; desc = Leaf }
let set_uid_if_none t uid =
  match t.uid with | None -> { t with uid = (Some uid) } | _ -> t
module Map =
  struct
    type shape = t
    type nonrec t = t Item.Map.t
    let empty = Item.Map.empty
    let add t item shape = Item.Map.add item shape t
    let add_value t id uid = Item.Map.add (Item.value id) (leaf uid) t
    let add_value_proj t id shape =
      let item = Item.value id in Item.Map.add item (proj shape item) t
    let add_type t id uid = Item.Map.add (Item.type_ id) (leaf uid) t
    let add_type_proj t id shape =
      let item = Item.type_ id in Item.Map.add item (proj shape item) t
    let add_module t id shape = Item.Map.add (Item.module_ id) shape t
    let add_module_proj t id shape =
      let item = Item.module_ id in Item.Map.add item (proj shape item) t
    let add_module_type t id uid =
      Item.Map.add (Item.module_type id) (leaf uid) t
    let add_module_type_proj t id shape =
      let item = Item.module_type id in Item.Map.add item (proj shape item) t
    let add_extcons t id uid =
      Item.Map.add (Item.extension_constructor id) (leaf uid) t
    let add_extcons_proj t id shape =
      let item = Item.extension_constructor id in
      Item.Map.add item (proj shape item) t
    let add_class t id uid = Item.Map.add (Item.class_ id) (leaf uid) t
    let add_class_proj t id shape =
      let item = Item.class_ id in Item.Map.add item (proj shape item) t
    let add_class_type t id uid =
      Item.Map.add (Item.class_type id) (leaf uid) t
    let add_class_type_proj t id shape =
      let item = Item.class_type id in Item.Map.add item (proj shape item) t
  end
