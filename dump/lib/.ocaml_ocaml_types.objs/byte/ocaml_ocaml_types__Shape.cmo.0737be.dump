[
  structure_item (lib/shape.ml[16,1080+0]..[64,2482+3])
    Pstr_module
    "Uid" (lib/shape.ml[16,1080+7]..[16,1080+10])
      module_expr (lib/shape.ml[16,1080+13]..[64,2482+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[17,1100+2]..[21,1204+22])
            Pstr_type Rec
            [
              type_declaration "t" (lib/shape.ml[17,1100+7]..[17,1100+8]) (lib/shape.ml[17,1100+2]..[21,1204+22])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (lib/shape.ml[18,1111+4]..[18,1111+32])
                        "Compilation_unit" (lib/shape.ml[18,1111+6]..[18,1111+22])
                        [
                          core_type (lib/shape.ml[18,1111+26]..[18,1111+32])
                            Ptyp_constr "string" (lib/shape.ml[18,1111+26]..[18,1111+32])
                            []
                        ]
                        None
                      (lib/shape.ml[19,1144+4]..[19,1144+44])
                        "Item" (lib/shape.ml[19,1144+6]..[19,1144+10])
                        [
                          (lib/shape.ml[19,1144+16]..[19,1144+34])
                            Immutable
                            "comp_unit" (lib/shape.ml[19,1144+16]..[19,1144+25])                            core_type (lib/shape.ml[19,1144+27]..[19,1144+33])
                              Ptyp_constr "string" (lib/shape.ml[19,1144+27]..[19,1144+33])
                              []
                          (lib/shape.ml[19,1144+35]..[19,1144+42])
                            Immutable
                            "id" (lib/shape.ml[19,1144+35]..[19,1144+37])                            core_type (lib/shape.ml[19,1144+39]..[19,1144+42])
                              Ptyp_constr "int" (lib/shape.ml[19,1144+39]..[19,1144+42])
                              []
                        ]
                        None
                      (lib/shape.ml[20,1189+4]..[20,1189+14])
                        "Internal" (lib/shape.ml[20,1189+6]..[20,1189+14])
                        []
                        None
                      (lib/shape.ml[21,1204+4]..[21,1204+22])
                        "Predef" (lib/shape.ml[21,1204+6]..[21,1204+12])
                        [
                          core_type (lib/shape.ml[21,1204+16]..[21,1204+22])
                            Ptyp_constr "string" (lib/shape.ml[21,1204+16]..[21,1204+22])
                            []
                        ]
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (lib/shape.ml[41,1867+2]..[41,1867+19])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[41,1867+6]..[41,1867+8])
                  Ppat_var "id" (lib/shape.ml[41,1867+6]..[41,1867+8])
                expression (lib/shape.ml[41,1867+11]..[41,1867+19])
                  Pexp_apply
                  expression (lib/shape.ml[41,1867+11]..[41,1867+14])
                    Pexp_ident "ref" (lib/shape.ml[41,1867+11]..[41,1867+14])
                  [
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[41,1867+15]..[41,1867+19])
                        Pexp_constant PConst_int (-1,None)
                  ]
            ]
          structure_item (lib/shape.ml[43,1888+2]..[43,1888+28])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[43,1888+6]..[43,1888+12])
                  Ppat_var "reinit" (lib/shape.ml[43,1888+6]..[43,1888+12])
                expression (lib/shape.ml[43,1888+13]..[43,1888+28]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[43,1888+13]..[43,1888+15])
                      Nolabel
                      None
                      pattern (lib/shape.ml[43,1888+13]..[43,1888+15])
                        Ppat_construct "()" (lib/shape.ml[43,1888+13]..[43,1888+15])
                        None
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[43,1888+18]..[43,1888+28])
                      Pexp_apply
                      expression (lib/shape.ml[43,1888+21]..[43,1888+23])
                        Pexp_ident ":=" (lib/shape.ml[43,1888+21]..[43,1888+23])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[43,1888+18]..[43,1888+20])
                            Pexp_ident "id" (lib/shape.ml[43,1888+18]..[43,1888+20])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[43,1888+24]..[43,1888+28])
                            Pexp_constant PConst_int (-1,None)
                      ]
            ]
          structure_item (lib/shape.ml[45,1918+2]..[47,1959+49])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[45,1918+6]..[45,1918+8])
                  Ppat_var "mk" (lib/shape.ml[45,1918+6]..[45,1918+8])
                expression (lib/shape.ml[45,1918+10]..[47,1959+49]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[45,1918+10]..[45,1918+23])
                      Labelled "current_unit"
                      None
                      pattern (lib/shape.ml[45,1918+11]..[45,1918+23])
                        Ppat_var "current_unit" (lib/shape.ml[45,1918+11]..[45,1918+23])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[46,1944+6]..[47,1959+49])
                      Pexp_sequence
                      expression (lib/shape.ml[46,1944+6]..[46,1944+13])
                        Pexp_apply
                        expression (lib/shape.ml[46,1944+6]..[46,1944+10])
                          Pexp_ident "incr" (lib/shape.ml[46,1944+6]..[46,1944+10])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[46,1944+11]..[46,1944+13])
                              Pexp_ident "id" (lib/shape.ml[46,1944+11]..[46,1944+13])
                        ]
                      expression (lib/shape.ml[47,1959+6]..[47,1959+49])
                        Pexp_construct "Item" (lib/shape.ml[47,1959+6]..[47,1959+10])
                        Some
                          expression (lib/shape.ml[47,1959+11]..[47,1959+49])
                            Pexp_record
                            [
                              "comp_unit" (lib/shape.ml[47,1959+13]..[47,1959+22])
                                expression (lib/shape.ml[47,1959+25]..[47,1959+37])
                                  Pexp_ident "current_unit" (lib/shape.ml[47,1959+25]..[47,1959+37])
                              "id" (lib/shape.ml[47,1959+39]..[47,1959+41])
                                expression (lib/shape.ml[47,1959+44]..[47,1959+47])
                                  Pexp_apply
                                  expression (lib/shape.ml[47,1959+44]..[47,1959+45])
                                    Pexp_ident "!" (lib/shape.ml[47,1959+44]..[47,1959+45])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[47,1959+45]..[47,1959+47])
                                        Pexp_ident "id" (lib/shape.ml[47,1959+45]..[47,1959+47])
                                  ]
                            ]
                            None
            ]
          structure_item (lib/shape.ml[49,2010+2]..[52,2161+36])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[49,2010+6]..[49,2010+28])
                  Ppat_var "of_compilation_unit_id" (lib/shape.ml[49,2010+6]..[49,2010+28])
                expression (lib/shape.ml[49,2010+29]..[52,2161+36]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[49,2010+29]..[49,2010+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[49,2010+29]..[49,2010+31])
                        Ppat_var "id" (lib/shape.ml[49,2010+29]..[49,2010+31])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[50,2044+4]..[52,2161+36])
                      Pexp_sequence
                      expression (lib/shape.ml[50,2044+4]..[51,2082+77])
                        Pexp_ifthenelse
                        expression (lib/shape.ml[50,2044+7]..[50,2044+32])
                          Pexp_apply
                          expression (lib/shape.ml[50,2044+7]..[50,2044+10])
                            Pexp_ident "not" (lib/shape.ml[50,2044+7]..[50,2044+10])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[50,2044+11]..[50,2044+32])
                                Pexp_apply
                                expression (lib/shape.ml[50,2044+12]..[50,2044+28])
                                  Pexp_ident "Ident.persistent" (lib/shape.ml[50,2044+12]..[50,2044+28])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[50,2044+29]..[50,2044+31])
                                      Pexp_ident "id" (lib/shape.ml[50,2044+29]..[50,2044+31])
                                ]
                          ]
                        expression (lib/shape.ml[51,2082+6]..[51,2082+77])
                          Pexp_apply
                          expression (lib/shape.ml[51,2082+6]..[51,2082+23])
                            Pexp_ident "Misc.fatal_errorf" (lib/shape.ml[51,2082+6]..[51,2082+23])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[51,2082+24]..[51,2082+61])
                                Pexp_constant PConst_string("Types.Uid.of_compilation_unit_id %S",(lib/shape.ml[51,2082+25]..[51,2082+60]),None)
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[51,2082+62]..[51,2082+77])
                                Pexp_apply
                                expression (lib/shape.ml[51,2082+63]..[51,2082+73])
                                  Pexp_ident "Ident.name" (lib/shape.ml[51,2082+63]..[51,2082+73])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[51,2082+74]..[51,2082+76])
                                      Pexp_ident "id" (lib/shape.ml[51,2082+74]..[51,2082+76])
                                ]
                          ]
                        None
                      expression (lib/shape.ml[52,2161+4]..[52,2161+36])
                        Pexp_construct "Compilation_unit" (lib/shape.ml[52,2161+4]..[52,2161+20])
                        Some
                          expression (lib/shape.ml[52,2161+21]..[52,2161+36])
                            Pexp_apply
                            expression (lib/shape.ml[52,2161+22]..[52,2161+32])
                              Pexp_ident "Ident.name" (lib/shape.ml[52,2161+22]..[52,2161+32])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[52,2161+33]..[52,2161+35])
                                  Pexp_ident "id" (lib/shape.ml[52,2161+33]..[52,2161+35])
                            ]
            ]
          structure_item (lib/shape.ml[54,2199+2]..[57,2329+26])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[54,2199+6]..[54,2199+18])
                  Ppat_var "of_predef_id" (lib/shape.ml[54,2199+6]..[54,2199+18])
                expression (lib/shape.ml[54,2199+19]..[57,2329+26]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[54,2199+19]..[54,2199+21])
                      Nolabel
                      None
                      pattern (lib/shape.ml[54,2199+19]..[54,2199+21])
                        Ppat_var "id" (lib/shape.ml[54,2199+19]..[54,2199+21])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[55,2223+4]..[57,2329+26])
                      Pexp_sequence
                      expression (lib/shape.ml[55,2223+4]..[56,2260+67])
                        Pexp_ifthenelse
                        expression (lib/shape.ml[55,2223+7]..[55,2223+31])
                          Pexp_apply
                          expression (lib/shape.ml[55,2223+7]..[55,2223+10])
                            Pexp_ident "not" (lib/shape.ml[55,2223+7]..[55,2223+10])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[55,2223+11]..[55,2223+31])
                                Pexp_apply
                                expression (lib/shape.ml[55,2223+12]..[55,2223+27])
                                  Pexp_ident "Ident.is_predef" (lib/shape.ml[55,2223+12]..[55,2223+27])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[55,2223+28]..[55,2223+30])
                                      Pexp_ident "id" (lib/shape.ml[55,2223+28]..[55,2223+30])
                                ]
                          ]
                        expression (lib/shape.ml[56,2260+6]..[56,2260+67])
                          Pexp_apply
                          expression (lib/shape.ml[56,2260+6]..[56,2260+23])
                            Pexp_ident "Misc.fatal_errorf" (lib/shape.ml[56,2260+6]..[56,2260+23])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[56,2260+24]..[56,2260+51])
                                Pexp_constant PConst_string("Types.Uid.of_predef_id %S",(lib/shape.ml[56,2260+25]..[56,2260+50]),None)
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[56,2260+52]..[56,2260+67])
                                Pexp_apply
                                expression (lib/shape.ml[56,2260+53]..[56,2260+63])
                                  Pexp_ident "Ident.name" (lib/shape.ml[56,2260+53]..[56,2260+63])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[56,2260+64]..[56,2260+66])
                                      Pexp_ident "id" (lib/shape.ml[56,2260+64]..[56,2260+66])
                                ]
                          ]
                        None
                      expression (lib/shape.ml[57,2329+4]..[57,2329+26])
                        Pexp_construct "Predef" (lib/shape.ml[57,2329+4]..[57,2329+10])
                        Some
                          expression (lib/shape.ml[57,2329+11]..[57,2329+26])
                            Pexp_apply
                            expression (lib/shape.ml[57,2329+12]..[57,2329+22])
                              Pexp_ident "Ident.name" (lib/shape.ml[57,2329+12]..[57,2329+22])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[57,2329+23]..[57,2329+25])
                                  Pexp_ident "id" (lib/shape.ml[57,2329+23]..[57,2329+25])
                            ]
            ]
          structure_item (lib/shape.ml[59,2357+2]..[59,2357+45])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[59,2357+6]..[59,2357+34])
                  Ppat_var "internal_not_actually_unique" (lib/shape.ml[59,2357+6]..[59,2357+34])
                expression (lib/shape.ml[59,2357+37]..[59,2357+45])
                  Pexp_construct "Internal" (lib/shape.ml[59,2357+37]..[59,2357+45])
                  None
            ]
          structure_item (lib/shape.ml[61,2404+2]..[63,2465+16])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[61,2404+6]..[61,2404+28])
                  Ppat_var "for_actual_declaration" (lib/shape.ml[61,2404+6]..[61,2404+28])
                expression (lib/shape.ml[61,2404+31]..[63,2465+16])
                  Pexp_function
                  []
                  None
                  Pfunction_cases (lib/shape.ml[61,2404+31]..[63,2465+16])
                    [
                      <case>
                        pattern (lib/shape.ml[62,2444+6]..[62,2444+12])
                          Ppat_construct "Item" (lib/shape.ml[62,2444+6]..[62,2444+10])
                          Some
                            []
                            pattern (lib/shape.ml[62,2444+11]..[62,2444+12])
                              Ppat_any
                        expression (lib/shape.ml[62,2444+16]..[62,2444+20])
                          Pexp_construct "true" (lib/shape.ml[62,2444+16]..[62,2444+20])
                          None
                      <case>
                        pattern (lib/shape.ml[63,2465+6]..[63,2465+7])
                          Ppat_any
                        expression (lib/shape.ml[63,2465+11]..[63,2465+16])
                          Pexp_construct "false" (lib/shape.ml[63,2465+11]..[63,2465+16])
                          None
                    ]
            ]
        ]
  structure_item (lib/shape.ml[66,2487+0]..[95,3069+3])
    Pstr_module
    "Sig_component_kind" (lib/shape.ml[66,2487+7]..[66,2487+25])
      module_expr (lib/shape.ml[66,2487+28]..[95,3069+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[67,2522+2]..[74,2627+16])
            Pstr_type Rec
            [
              type_declaration "t" (lib/shape.ml[67,2522+7]..[67,2522+8]) (lib/shape.ml[67,2522+2]..[74,2627+16])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_variant
                    [
                      (lib/shape.ml[68,2533+4]..[68,2533+11])
                        "Value" (lib/shape.ml[68,2533+6]..[68,2533+11])
                        []
                        None
                      (lib/shape.ml[69,2545+4]..[69,2545+10])
                        "Type" (lib/shape.ml[69,2545+6]..[69,2545+10])
                        []
                        None
                      (lib/shape.ml[70,2556+4]..[70,2556+12])
                        "Module" (lib/shape.ml[70,2556+6]..[70,2556+12])
                        []
                        None
                      (lib/shape.ml[71,2569+4]..[71,2569+17])
                        "Module_type" (lib/shape.ml[71,2569+6]..[71,2569+17])
                        []
                        None
                      (lib/shape.ml[72,2587+4]..[72,2587+27])
                        "Extension_constructor" (lib/shape.ml[72,2587+6]..[72,2587+27])
                        []
                        None
                      (lib/shape.ml[73,2615+4]..[73,2615+11])
                        "Class" (lib/shape.ml[73,2615+6]..[73,2615+11])
                        []
                        None
                      (lib/shape.ml[74,2627+4]..[74,2627+16])
                        "Class_type" (lib/shape.ml[74,2627+6]..[74,2627+16])
                        []
                        None
                    ]
                ptype_private = Public
                ptype_manifest =
                  None
            ]
          structure_item (lib/shape.ml[76,2645+2]..[83,2854+32])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[76,2645+6]..[76,2645+15])
                  Ppat_var "to_string" (lib/shape.ml[76,2645+6]..[76,2645+15])
                expression (lib/shape.ml[76,2645+18]..[83,2854+32])
                  Pexp_function
                  []
                  None
                  Pfunction_cases (lib/shape.ml[76,2645+18]..[83,2854+32])
                    [
                      <case>
                        pattern (lib/shape.ml[77,2672+6]..[77,2672+11])
                          Ppat_construct "Value" (lib/shape.ml[77,2672+6]..[77,2672+11])
                          None
                        expression (lib/shape.ml[77,2672+15]..[77,2672+22])
                          Pexp_constant PConst_string("value",(lib/shape.ml[77,2672+16]..[77,2672+21]),None)
                      <case>
                        pattern (lib/shape.ml[78,2695+6]..[78,2695+10])
                          Ppat_construct "Type" (lib/shape.ml[78,2695+6]..[78,2695+10])
                          None
                        expression (lib/shape.ml[78,2695+14]..[78,2695+20])
                          Pexp_constant PConst_string("type",(lib/shape.ml[78,2695+15]..[78,2695+19]),None)
                      <case>
                        pattern (lib/shape.ml[79,2716+6]..[79,2716+12])
                          Ppat_construct "Module" (lib/shape.ml[79,2716+6]..[79,2716+12])
                          None
                        expression (lib/shape.ml[79,2716+16]..[79,2716+24])
                          Pexp_constant PConst_string("module",(lib/shape.ml[79,2716+17]..[79,2716+23]),None)
                      <case>
                        pattern (lib/shape.ml[80,2741+6]..[80,2741+17])
                          Ppat_construct "Module_type" (lib/shape.ml[80,2741+6]..[80,2741+17])
                          None
                        expression (lib/shape.ml[80,2741+21]..[80,2741+34])
                          Pexp_constant PConst_string("module type",(lib/shape.ml[80,2741+22]..[80,2741+33]),None)
                      <case>
                        pattern (lib/shape.ml[81,2776+6]..[81,2776+27])
                          Ppat_construct "Extension_constructor" (lib/shape.ml[81,2776+6]..[81,2776+27])
                          None
                        expression (lib/shape.ml[81,2776+31]..[81,2776+54])
                          Pexp_constant PConst_string("extension constructor",(lib/shape.ml[81,2776+32]..[81,2776+53]),None)
                      <case>
                        pattern (lib/shape.ml[82,2831+6]..[82,2831+11])
                          Ppat_construct "Class" (lib/shape.ml[82,2831+6]..[82,2831+11])
                          None
                        expression (lib/shape.ml[82,2831+15]..[82,2831+22])
                          Pexp_constant PConst_string("class",(lib/shape.ml[82,2831+16]..[82,2831+21]),None)
                      <case>
                        pattern (lib/shape.ml[83,2854+6]..[83,2854+16])
                          Ppat_construct "Class_type" (lib/shape.ml[83,2854+6]..[83,2854+16])
                          None
                        expression (lib/shape.ml[83,2854+20]..[83,2854+32])
                          Pexp_constant PConst_string("class type",(lib/shape.ml[83,2854+21]..[83,2854+31]),None)
                    ]
            ]
          structure_item (lib/shape.ml[85,2888+2]..[94,3056+12])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[85,2888+6]..[85,2888+25])
                  Ppat_var "can_appear_in_types" (lib/shape.ml[85,2888+6]..[85,2888+25])
                expression (lib/shape.ml[85,2888+28]..[94,3056+12])
                  Pexp_function
                  []
                  None
                  Pfunction_cases (lib/shape.ml[85,2888+28]..[94,3056+12])
                    [
                      <case>
                        pattern (lib/shape.ml[86,2925+6]..[87,2937+27])
                          Ppat_or
                          pattern (lib/shape.ml[86,2925+6]..[86,2925+11])
                            Ppat_construct "Value" (lib/shape.ml[86,2925+6]..[86,2925+11])
                            None
                          pattern (lib/shape.ml[87,2937+6]..[87,2937+27])
                            Ppat_construct "Extension_constructor" (lib/shape.ml[87,2937+6]..[87,2937+27])
                            None
                        expression (lib/shape.ml[88,2968+8]..[88,2968+13])
                          Pexp_construct "false" (lib/shape.ml[88,2968+8]..[88,2968+13])
                          None
                      <case>
                        pattern (lib/shape.ml[89,2982+6]..[93,3036+16])
                          Ppat_or
                          pattern (lib/shape.ml[89,2982+6]..[92,3024+11])
                            Ppat_or
                            pattern (lib/shape.ml[89,2982+6]..[91,3006+17])
                              Ppat_or
                              pattern (lib/shape.ml[89,2982+6]..[90,2993+12])
                                Ppat_or
                                pattern (lib/shape.ml[89,2982+6]..[89,2982+10])
                                  Ppat_construct "Type" (lib/shape.ml[89,2982+6]..[89,2982+10])
                                  None
                                pattern (lib/shape.ml[90,2993+6]..[90,2993+12])
                                  Ppat_construct "Module" (lib/shape.ml[90,2993+6]..[90,2993+12])
                                  None
                              pattern (lib/shape.ml[91,3006+6]..[91,3006+17])
                                Ppat_construct "Module_type" (lib/shape.ml[91,3006+6]..[91,3006+17])
                                None
                            pattern (lib/shape.ml[92,3024+6]..[92,3024+11])
                              Ppat_construct "Class" (lib/shape.ml[92,3024+6]..[92,3024+11])
                              None
                          pattern (lib/shape.ml[93,3036+6]..[93,3036+16])
                            Ppat_construct "Class_type" (lib/shape.ml[93,3036+6]..[93,3036+16])
                            None
                        expression (lib/shape.ml[94,3056+8]..[94,3056+12])
                          Pexp_construct "true" (lib/shape.ml[94,3056+8]..[94,3056+12])
                          None
                    ]
            ]
        ]
  structure_item (lib/shape.ml[97,3074+0]..[124,3872+3])
    Pstr_module
    "Item" (lib/shape.ml[97,3074+7]..[97,3074+11])
      module_expr (lib/shape.ml[97,3074+14]..[124,3872+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[98,3095+2]..[119,3825+5])
            Pstr_module
            "T" (lib/shape.ml[98,3095+9]..[98,3095+10])
              module_expr (lib/shape.ml[98,3095+13]..[119,3825+5])
                Pmod_structure
                [
                  structure_item (lib/shape.ml[99,3115+4]..[99,3115+42])
                    Pstr_type Rec
                    [
                      type_declaration "t" (lib/shape.ml[99,3115+9]..[99,3115+10]) (lib/shape.ml[99,3115+4]..[99,3115+42])
                        ptype_params =
                          []
                        ptype_cstrs =
                          []
                        ptype_kind =
                          Ptype_abstract
                        ptype_private = Public
                        ptype_manifest =
                          Some
                            core_type (lib/shape.ml[99,3115+13]..[99,3115+42])
                              Ptyp_tuple
                              [
                                core_type (lib/shape.ml[99,3115+13]..[99,3115+19])
                                  Ptyp_constr "string" (lib/shape.ml[99,3115+13]..[99,3115+19])
                                  []
                                core_type (lib/shape.ml[99,3115+22]..[99,3115+42])
                                  Ptyp_constr "Sig_component_kind.t" (lib/shape.ml[99,3115+22]..[99,3115+42])
                                  []
                              ]
                    ]
                  structure_item (lib/shape.ml[100,3158+4]..[100,3158+25])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[100,3158+8]..[100,3158+15])
                          Ppat_var "compare" (lib/shape.ml[100,3158+8]..[100,3158+15])
                        expression (lib/shape.ml[100,3158+18]..[100,3158+25])
                          Pexp_ident "compare" (lib/shape.ml[100,3158+18]..[100,3158+25])
                    ]
                  structure_item (lib/shape.ml[102,3185+4]..[102,3185+29])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[102,3185+8]..[102,3185+12])
                          Ppat_var "make" (lib/shape.ml[102,3185+8]..[102,3185+12])
                        expression (lib/shape.ml[102,3185+13]..[102,3185+29]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[102,3185+13]..[102,3185+16])
                              Nolabel
                              None
                              pattern (lib/shape.ml[102,3185+13]..[102,3185+16])
                                Ppat_var "str" (lib/shape.ml[102,3185+13]..[102,3185+16])
                            Pparam_val (lib/shape.ml[102,3185+17]..[102,3185+19])
                              Nolabel
                              None
                              pattern (lib/shape.ml[102,3185+17]..[102,3185+19])
                                Ppat_var "ns" (lib/shape.ml[102,3185+17]..[102,3185+19])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[102,3185+22]..[102,3185+29])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[102,3185+22]..[102,3185+25])
                                  Pexp_ident "str" (lib/shape.ml[102,3185+22]..[102,3185+25])
                                expression (lib/shape.ml[102,3185+27]..[102,3185+29])
                                  Pexp_ident "ns" (lib/shape.ml[102,3185+27]..[102,3185+29])
                              ]
                    ]
                  structure_item (lib/shape.ml[104,3216+4]..[104,3216+58])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[104,3216+8]..[104,3216+13])
                          Ppat_var "value" (lib/shape.ml[104,3216+8]..[104,3216+13])
                        expression (lib/shape.ml[104,3216+14]..[104,3216+58]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[104,3216+14]..[104,3216+16])
                              Nolabel
                              None
                              pattern (lib/shape.ml[104,3216+14]..[104,3216+16])
                                Ppat_var "id" (lib/shape.ml[104,3216+14]..[104,3216+16])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[104,3216+19]..[104,3216+58])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[104,3216+19]..[104,3216+32])
                                  Pexp_apply
                                  expression (lib/shape.ml[104,3216+19]..[104,3216+29])
                                    Pexp_ident "Ident.name" (lib/shape.ml[104,3216+19]..[104,3216+29])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[104,3216+30]..[104,3216+32])
                                        Pexp_ident "id" (lib/shape.ml[104,3216+30]..[104,3216+32])
                                  ]
                                expression (lib/shape.ml[104,3216+34]..[104,3216+58])
                                  Pexp_construct "Sig_component_kind.Value" (lib/shape.ml[104,3216+34]..[104,3216+58])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[105,3275+4]..[105,3275+57])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[105,3275+8]..[105,3275+13])
                          Ppat_var "type_" (lib/shape.ml[105,3275+8]..[105,3275+13])
                        expression (lib/shape.ml[105,3275+14]..[105,3275+57]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[105,3275+14]..[105,3275+16])
                              Nolabel
                              None
                              pattern (lib/shape.ml[105,3275+14]..[105,3275+16])
                                Ppat_var "id" (lib/shape.ml[105,3275+14]..[105,3275+16])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[105,3275+19]..[105,3275+57])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[105,3275+19]..[105,3275+32])
                                  Pexp_apply
                                  expression (lib/shape.ml[105,3275+19]..[105,3275+29])
                                    Pexp_ident "Ident.name" (lib/shape.ml[105,3275+19]..[105,3275+29])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[105,3275+30]..[105,3275+32])
                                        Pexp_ident "id" (lib/shape.ml[105,3275+30]..[105,3275+32])
                                  ]
                                expression (lib/shape.ml[105,3275+34]..[105,3275+57])
                                  Pexp_construct "Sig_component_kind.Type" (lib/shape.ml[105,3275+34]..[105,3275+57])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[106,3333+4]..[106,3333+61])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[106,3333+8]..[106,3333+15])
                          Ppat_var "module_" (lib/shape.ml[106,3333+8]..[106,3333+15])
                        expression (lib/shape.ml[106,3333+16]..[106,3333+61]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[106,3333+16]..[106,3333+18])
                              Nolabel
                              None
                              pattern (lib/shape.ml[106,3333+16]..[106,3333+18])
                                Ppat_var "id" (lib/shape.ml[106,3333+16]..[106,3333+18])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[106,3333+21]..[106,3333+61])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[106,3333+21]..[106,3333+34])
                                  Pexp_apply
                                  expression (lib/shape.ml[106,3333+21]..[106,3333+31])
                                    Pexp_ident "Ident.name" (lib/shape.ml[106,3333+21]..[106,3333+31])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[106,3333+32]..[106,3333+34])
                                        Pexp_ident "id" (lib/shape.ml[106,3333+32]..[106,3333+34])
                                  ]
                                expression (lib/shape.ml[106,3333+36]..[106,3333+61])
                                  Pexp_construct "Sig_component_kind.Module" (lib/shape.ml[106,3333+36]..[106,3333+61])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[107,3395+4]..[107,3395+70])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[107,3395+8]..[107,3395+19])
                          Ppat_var "module_type" (lib/shape.ml[107,3395+8]..[107,3395+19])
                        expression (lib/shape.ml[107,3395+20]..[107,3395+70]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[107,3395+20]..[107,3395+22])
                              Nolabel
                              None
                              pattern (lib/shape.ml[107,3395+20]..[107,3395+22])
                                Ppat_var "id" (lib/shape.ml[107,3395+20]..[107,3395+22])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[107,3395+25]..[107,3395+70])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[107,3395+25]..[107,3395+38])
                                  Pexp_apply
                                  expression (lib/shape.ml[107,3395+25]..[107,3395+35])
                                    Pexp_ident "Ident.name" (lib/shape.ml[107,3395+25]..[107,3395+35])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[107,3395+36]..[107,3395+38])
                                        Pexp_ident "id" (lib/shape.ml[107,3395+36]..[107,3395+38])
                                  ]
                                expression (lib/shape.ml[107,3395+40]..[107,3395+70])
                                  Pexp_construct "Sig_component_kind.Module_type" (lib/shape.ml[107,3395+40]..[107,3395+70])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[108,3466+4]..[109,3501+61])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[108,3466+8]..[108,3466+29])
                          Ppat_var "extension_constructor" (lib/shape.ml[108,3466+8]..[108,3466+29])
                        expression (lib/shape.ml[108,3466+30]..[109,3501+61]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[108,3466+30]..[108,3466+32])
                              Nolabel
                              None
                              pattern (lib/shape.ml[108,3466+30]..[108,3466+32])
                                Ppat_var "id" (lib/shape.ml[108,3466+30]..[108,3466+32])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[109,3501+6]..[109,3501+61])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[109,3501+6]..[109,3501+19])
                                  Pexp_apply
                                  expression (lib/shape.ml[109,3501+6]..[109,3501+16])
                                    Pexp_ident "Ident.name" (lib/shape.ml[109,3501+6]..[109,3501+16])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[109,3501+17]..[109,3501+19])
                                        Pexp_ident "id" (lib/shape.ml[109,3501+17]..[109,3501+19])
                                  ]
                                expression (lib/shape.ml[109,3501+21]..[109,3501+61])
                                  Pexp_construct "Sig_component_kind.Extension_constructor" (lib/shape.ml[109,3501+21]..[109,3501+61])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[110,3563+4]..[111,3583+45])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[110,3563+8]..[110,3563+14])
                          Ppat_var "class_" (lib/shape.ml[110,3563+8]..[110,3563+14])
                        expression (lib/shape.ml[110,3563+15]..[111,3583+45]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[110,3563+15]..[110,3563+17])
                              Nolabel
                              None
                              pattern (lib/shape.ml[110,3563+15]..[110,3563+17])
                                Ppat_var "id" (lib/shape.ml[110,3563+15]..[110,3563+17])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[111,3583+6]..[111,3583+45])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[111,3583+6]..[111,3583+19])
                                  Pexp_apply
                                  expression (lib/shape.ml[111,3583+6]..[111,3583+16])
                                    Pexp_ident "Ident.name" (lib/shape.ml[111,3583+6]..[111,3583+16])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[111,3583+17]..[111,3583+19])
                                        Pexp_ident "id" (lib/shape.ml[111,3583+17]..[111,3583+19])
                                  ]
                                expression (lib/shape.ml[111,3583+21]..[111,3583+45])
                                  Pexp_construct "Sig_component_kind.Class" (lib/shape.ml[111,3583+21]..[111,3583+45])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[112,3629+4]..[113,3653+50])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[112,3629+8]..[112,3629+18])
                          Ppat_var "class_type" (lib/shape.ml[112,3629+8]..[112,3629+18])
                        expression (lib/shape.ml[112,3629+19]..[113,3653+50]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[112,3629+19]..[112,3629+21])
                              Nolabel
                              None
                              pattern (lib/shape.ml[112,3629+19]..[112,3629+21])
                                Ppat_var "id" (lib/shape.ml[112,3629+19]..[112,3629+21])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[113,3653+6]..[113,3653+50])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[113,3653+6]..[113,3653+19])
                                  Pexp_apply
                                  expression (lib/shape.ml[113,3653+6]..[113,3653+16])
                                    Pexp_ident "Ident.name" (lib/shape.ml[113,3653+6]..[113,3653+16])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[113,3653+17]..[113,3653+19])
                                        Pexp_ident "id" (lib/shape.ml[113,3653+17]..[113,3653+19])
                                  ]
                                expression (lib/shape.ml[113,3653+21]..[113,3653+50])
                                  Pexp_construct "Sig_component_kind.Class_type" (lib/shape.ml[113,3653+21]..[113,3653+50])
                                  None
                              ]
                    ]
                  structure_item (lib/shape.ml[115,3705+4]..[118,3783+41])
                    Pstr_value Nonrec
                    [
                      <def>
                        pattern (lib/shape.ml[115,3705+8]..[115,3705+13])
                          Ppat_var "print" (lib/shape.ml[115,3705+8]..[115,3705+13])
                        expression (lib/shape.ml[115,3705+14]..[118,3783+41]) ghost
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[115,3705+14]..[115,3705+17])
                              Nolabel
                              None
                              pattern (lib/shape.ml[115,3705+14]..[115,3705+17])
                                Ppat_var "fmt" (lib/shape.ml[115,3705+14]..[115,3705+17])
                            Pparam_val (lib/shape.ml[115,3705+18]..[115,3705+28])
                              Nolabel
                              None
                              pattern (lib/shape.ml[115,3705+18]..[115,3705+28])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[115,3705+19]..[115,3705+23])
                                    Ppat_var "name" (lib/shape.ml[115,3705+19]..[115,3705+23])
                                  pattern (lib/shape.ml[115,3705+25]..[115,3705+27])
                                    Ppat_var "ns" (lib/shape.ml[115,3705+25]..[115,3705+27])
                                ]
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[116,3736+6]..[118,3783+41])
                              Pexp_apply
                              expression (lib/shape.ml[116,3736+6]..[116,3736+20])
                                Pexp_ident "Format.fprintf" (lib/shape.ml[116,3736+6]..[116,3736+20])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[116,3736+21]..[116,3736+24])
                                    Pexp_ident "fmt" (lib/shape.ml[116,3736+21]..[116,3736+24])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[116,3736+25]..[116,3736+33])
                                    Pexp_constant PConst_string("%S[%s]",(lib/shape.ml[116,3736+26]..[116,3736+32]),None)
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[117,3770+8]..[117,3770+12])
                                    Pexp_ident "name" (lib/shape.ml[117,3770+8]..[117,3770+12])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[118,3783+8]..[118,3783+41])
                                    Pexp_apply
                                    expression (lib/shape.ml[118,3783+9]..[118,3783+37])
                                      Pexp_ident "Sig_component_kind.to_string" (lib/shape.ml[118,3783+9]..[118,3783+37])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[118,3783+38]..[118,3783+40])
                                          Pexp_ident "ns" (lib/shape.ml[118,3783+38]..[118,3783+40])
                                    ]
                              ]
                    ]
                ]
          structure_item (lib/shape.ml[121,3832+2]..[121,3832+11])
            Pstr_include            module_expr (lib/shape.ml[121,3832+10]..[121,3832+11])
              Pmod_ident "T" (lib/shape.ml[121,3832+10]..[121,3832+11])
          structure_item (lib/shape.ml[123,3845+2]..[123,3845+26])
            Pstr_module
            "Map" (lib/shape.ml[123,3845+9]..[123,3845+12])
              module_expr (lib/shape.ml[123,3845+15]..[123,3845+26])
                Pmod_apply
                module_expr (lib/shape.ml[123,3845+15]..[123,3845+23])
                  Pmod_ident "Map.Make" (lib/shape.ml[123,3845+15]..[123,3845+23])
                module_expr (lib/shape.ml[123,3845+24]..[123,3845+25])
                  Pmod_ident "T" (lib/shape.ml[123,3845+24]..[123,3845+25])
        ]
  structure_item (lib/shape.ml[126,3877+0]..[126,3877+18])
    Pstr_type Rec
    [
      type_declaration "var" (lib/shape.ml[126,3877+5]..[126,3877+8]) (lib/shape.ml[126,3877+0]..[126,3877+18])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_abstract
        ptype_private = Public
        ptype_manifest =
          Some
            core_type (lib/shape.ml[126,3877+11]..[126,3877+18])
              Ptyp_constr "Ident.t" (lib/shape.ml[126,3877+11]..[126,3877+18])
              []
    ]
  structure_item (lib/shape.ml[127,3896+0]..[135,4060+23])
    Pstr_type Rec
    [
      type_declaration "t" (lib/shape.ml[127,3896+5]..[127,3896+6]) (lib/shape.ml[127,3896+0]..[127,3896+42])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_record
            [
              (lib/shape.ml[127,3896+11]..[127,3896+29])
                Immutable
                "uid" (lib/shape.ml[127,3896+11]..[127,3896+14])                core_type (lib/shape.ml[127,3896+16]..[127,3896+28])
                  Ptyp_constr "option" (lib/shape.ml[127,3896+22]..[127,3896+28])
                  [
                    core_type (lib/shape.ml[127,3896+16]..[127,3896+21])
                      Ptyp_constr "Uid.t" (lib/shape.ml[127,3896+16]..[127,3896+21])
                      []
                  ]
              (lib/shape.ml[127,3896+30]..[127,3896+40])
                Immutable
                "desc" (lib/shape.ml[127,3896+30]..[127,3896+34])                core_type (lib/shape.ml[127,3896+36]..[127,3896+40])
                  Ptyp_constr "desc" (lib/shape.ml[127,3896+36]..[127,3896+40])
                  []
            ]
        ptype_private = Public
        ptype_manifest =
          None
      type_declaration "desc" (lib/shape.ml[128,3939+4]..[128,3939+8]) (lib/shape.ml[128,3939+0]..[135,4060+23])
        ptype_params =
          []
        ptype_cstrs =
          []
        ptype_kind =
          Ptype_variant
            [
              (lib/shape.ml[129,3950+2]..[129,3950+14])
                "Var" (lib/shape.ml[129,3950+4]..[129,3950+7])
                [
                  core_type (lib/shape.ml[129,3950+11]..[129,3950+14])
                    Ptyp_constr "var" (lib/shape.ml[129,3950+11]..[129,3950+14])
                    []
                ]
                None
              (lib/shape.ml[130,3965+2]..[130,3965+18])
                "Abs" (lib/shape.ml[130,3965+4]..[130,3965+7])
                [
                  core_type (lib/shape.ml[130,3965+11]..[130,3965+14])
                    Ptyp_constr "var" (lib/shape.ml[130,3965+11]..[130,3965+14])
                    []
                  core_type (lib/shape.ml[130,3965+17]..[130,3965+18])
                    Ptyp_constr "t" (lib/shape.ml[130,3965+17]..[130,3965+18])
                    []
                ]
                None
              (lib/shape.ml[131,3984+2]..[131,3984+16])
                "App" (lib/shape.ml[131,3984+4]..[131,3984+7])
                [
                  core_type (lib/shape.ml[131,3984+11]..[131,3984+12])
                    Ptyp_constr "t" (lib/shape.ml[131,3984+11]..[131,3984+12])
                    []
                  core_type (lib/shape.ml[131,3984+15]..[131,3984+16])
                    Ptyp_constr "t" (lib/shape.ml[131,3984+15]..[131,3984+16])
                    []
                ]
                None
              (lib/shape.ml[132,4001+2]..[132,4001+26])
                "Struct" (lib/shape.ml[132,4001+4]..[132,4001+10])
                [
                  core_type (lib/shape.ml[132,4001+14]..[132,4001+26])
                    Ptyp_constr "Item.Map.t" (lib/shape.ml[132,4001+16]..[132,4001+26])
                    [
                      core_type (lib/shape.ml[132,4001+14]..[132,4001+15])
                        Ptyp_constr "t" (lib/shape.ml[132,4001+14]..[132,4001+15])
                        []
                    ]
                ]
                None
              (lib/shape.ml[133,4028+2]..[133,4028+8])
                "Leaf" (lib/shape.ml[133,4028+4]..[133,4028+8])
                []
                None
              (lib/shape.ml[134,4037+2]..[134,4037+22])
                "Proj" (lib/shape.ml[134,4037+4]..[134,4037+8])
                [
                  core_type (lib/shape.ml[134,4037+12]..[134,4037+13])
                    Ptyp_constr "t" (lib/shape.ml[134,4037+12]..[134,4037+13])
                    []
                  core_type (lib/shape.ml[134,4037+16]..[134,4037+22])
                    Ptyp_constr "Item.t" (lib/shape.ml[134,4037+16]..[134,4037+22])
                    []
                ]
                None
              (lib/shape.ml[135,4060+2]..[135,4060+23])
                "Comp_unit" (lib/shape.ml[135,4060+4]..[135,4060+13])
                [
                  core_type (lib/shape.ml[135,4060+17]..[135,4060+23])
                    Ptyp_constr "string" (lib/shape.ml[135,4060+17]..[135,4060+23])
                    []
                ]
                None
            ]
        ptype_private = Public
        ptype_manifest =
          None
    ]
  structure_item (lib/shape.ml[137,4085+0]..[188,5822+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[137,4085+4]..[137,4085+9])
          Ppat_var "print" (lib/shape.ml[137,4085+4]..[137,4085+9])
        expression (lib/shape.ml[137,4085+10]..[188,5822+34]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[137,4085+10]..[137,4085+13])
              Nolabel
              None
              pattern (lib/shape.ml[137,4085+10]..[137,4085+13])
                Ppat_var "fmt" (lib/shape.ml[137,4085+10]..[137,4085+13])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[138,4101+2]..[188,5822+34])
              Pexp_let Nonrec
              [
                <def>
                  pattern (lib/shape.ml[138,4101+6]..[138,4101+19])
                    Ppat_var "print_uid_opt" (lib/shape.ml[138,4101+6]..[138,4101+19])
                  expression (lib/shape.ml[139,4123+4]..[139,4123+75])
                    Pexp_apply
                    expression (lib/shape.ml[139,4123+4]..[139,4123+26])
                      Pexp_ident "Format.pp_print_option" (lib/shape.ml[139,4123+4]..[139,4123+26])
                    [
                      <arg>
                      Nolabel
                        expression (lib/shape.ml[139,4123+27]..[139,4123+75])
                          Pexp_function
                          [
                            Pparam_val (lib/shape.ml[139,4123+32]..[139,4123+35])
                              Nolabel
                              None
                              pattern (lib/shape.ml[139,4123+32]..[139,4123+35])
                                Ppat_var "fmt" (lib/shape.ml[139,4123+32]..[139,4123+35])
                          ]
                          None
                          Pfunction_body
                            expression (lib/shape.ml[139,4123+39]..[139,4123+74])
                              Pexp_apply
                              expression (lib/shape.ml[139,4123+39]..[139,4123+53])
                                Pexp_ident "Format.fprintf" (lib/shape.ml[139,4123+39]..[139,4123+53])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[139,4123+54]..[139,4123+57])
                                    Pexp_ident "fmt" (lib/shape.ml[139,4123+54]..[139,4123+57])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[139,4123+58]..[139,4123+64])
                                    Pexp_constant PConst_string("<%a>",(lib/shape.ml[139,4123+59]..[139,4123+63]),None)
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[139,4123+65]..[139,4123+74])
                                    Pexp_ident "Uid.print" (lib/shape.ml[139,4123+65]..[139,4123+74])
                              ]
                    ]
              ]
              expression (lib/shape.ml[141,4204+2]..[188,5822+34])
                Pexp_let Rec
                [
                  <def>
                    pattern (lib/shape.ml[141,4204+10]..[141,4204+13])
                      Ppat_var "aux" (lib/shape.ml[141,4204+10]..[141,4204+13])
                    expression (lib/shape.ml[141,4204+14]..[186,5740+76]) ghost
                      Pexp_function
                      [
                        Pparam_val (lib/shape.ml[141,4204+14]..[141,4204+17])
                          Nolabel
                          None
                          pattern (lib/shape.ml[141,4204+14]..[141,4204+17])
                            Ppat_var "fmt" (lib/shape.ml[141,4204+14]..[141,4204+17])
                        Pparam_val (lib/shape.ml[141,4204+18]..[141,4204+31])
                          Nolabel
                          None
                          pattern (lib/shape.ml[141,4204+18]..[141,4204+31])
                            Ppat_record Closed
                            [
                              "uid" (lib/shape.ml[141,4204+20]..[141,4204+23]) ghost
                                pattern (lib/shape.ml[141,4204+20]..[141,4204+23])
                                  Ppat_var "uid" (lib/shape.ml[141,4204+20]..[141,4204+23])
                              "desc" (lib/shape.ml[141,4204+25]..[141,4204+29]) ghost
                                pattern (lib/shape.ml[141,4204+25]..[141,4204+29])
                                  Ppat_var "desc" (lib/shape.ml[141,4204+25]..[141,4204+29])
                            ]
                      ]
                      None
                      Pfunction_body
                        expression (lib/shape.ml[142,4238+4]..[186,5740+76])
                          Pexp_match
                          expression (lib/shape.ml[142,4238+10]..[142,4238+14])
                            Pexp_ident "desc" (lib/shape.ml[142,4238+10]..[142,4238+14])
                          [
                            <case>
                              pattern (lib/shape.ml[143,4258+6]..[143,4258+12])
                                Ppat_construct "Var" (lib/shape.ml[143,4258+6]..[143,4258+9])
                                Some
                                  []
                                  pattern (lib/shape.ml[143,4258+10]..[143,4258+12])
                                    Ppat_var "id" (lib/shape.ml[143,4258+10]..[143,4258+12])
                              expression (lib/shape.ml[144,4274+8]..[144,4274+66])
                                Pexp_apply
                                expression (lib/shape.ml[144,4274+8]..[144,4274+22])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[144,4274+8]..[144,4274+22])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4274+23]..[144,4274+26])
                                      Pexp_ident "fmt" (lib/shape.ml[144,4274+23]..[144,4274+26])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4274+27]..[144,4274+33])
                                      Pexp_constant PConst_string("%a%a",(lib/shape.ml[144,4274+28]..[144,4274+32]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4274+34]..[144,4274+45])
                                      Pexp_ident "Ident.print" (lib/shape.ml[144,4274+34]..[144,4274+45])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4274+46]..[144,4274+48])
                                      Pexp_ident "id" (lib/shape.ml[144,4274+46]..[144,4274+48])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4274+49]..[144,4274+62])
                                      Pexp_ident "print_uid_opt" (lib/shape.ml[144,4274+49]..[144,4274+62])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[144,4274+63]..[144,4274+66])
                                      Pexp_ident "uid" (lib/shape.ml[144,4274+63]..[144,4274+66])
                                ]
                            <case>
                              pattern (lib/shape.ml[145,4341+6]..[145,4341+17])
                                Ppat_construct "Abs" (lib/shape.ml[145,4341+6]..[145,4341+9])
                                Some
                                  []
                                  pattern (lib/shape.ml[145,4341+10]..[145,4341+17])
                                    Ppat_tuple
                                    [
                                      pattern (lib/shape.ml[145,4341+11]..[145,4341+13])
                                        Ppat_var "id" (lib/shape.ml[145,4341+11]..[145,4341+13])
                                      pattern (lib/shape.ml[145,4341+15]..[145,4341+16])
                                        Ppat_var "t" (lib/shape.ml[145,4341+15]..[145,4341+16])
                                    ]
                              expression (lib/shape.ml[146,4362+8]..[159,4864+67])
                                Pexp_let Rec
                                [
                                  <def>
                                    pattern (lib/shape.ml[146,4362+16]..[146,4362+30])
                                      Ppat_var "collect_idents" (lib/shape.ml[146,4362+16]..[146,4362+30])
                                    expression (lib/shape.ml[146,4362+33]..[151,4551+22])
                                      Pexp_function
                                      []
                                      None
                                      Pfunction_cases (lib/shape.ml[146,4362+33]..[151,4551+22])
                                        [
                                          <case>
                                            pattern (lib/shape.ml[147,4404+12]..[147,4404+45])
                                              Ppat_record Closed
                                              [
                                                "uid" (lib/shape.ml[147,4404+14]..[147,4404+17])
                                                  pattern (lib/shape.ml[147,4404+20]..[147,4404+24])
                                                    Ppat_construct "None" (lib/shape.ml[147,4404+20]..[147,4404+24])
                                                    None
                                                "desc" (lib/shape.ml[147,4404+26]..[147,4404+30])
                                                  pattern (lib/shape.ml[147,4404+33]..[147,4404+43])
                                                    Ppat_construct "Abs" (lib/shape.ml[147,4404+33]..[147,4404+36])
                                                    Some
                                                      []
                                                      pattern (lib/shape.ml[147,4404+36]..[147,4404+43])
                                                        Ppat_tuple
                                                        [
                                                          pattern (lib/shape.ml[147,4404+37]..[147,4404+39])
                                                            Ppat_var "id" (lib/shape.ml[147,4404+37]..[147,4404+39])
                                                          pattern (lib/shape.ml[147,4404+41]..[147,4404+42])
                                                            Ppat_var "t" (lib/shape.ml[147,4404+41]..[147,4404+42])
                                                        ]
                                              ]
                                            expression (lib/shape.ml[148,4453+12]..[149,4503+27])
                                              Pexp_let Nonrec
                                              [
                                                <def>
                                                  pattern (lib/shape.ml[148,4453+16]..[148,4453+27])
                                                    Ppat_tuple
                                                    [
                                                      pattern (lib/shape.ml[148,4453+17]..[148,4453+20])
                                                        Ppat_var "ids" (lib/shape.ml[148,4453+17]..[148,4453+20])
                                                      pattern (lib/shape.ml[148,4453+22]..[148,4453+26])
                                                        Ppat_var "body" (lib/shape.ml[148,4453+22]..[148,4453+26])
                                                    ]
                                                  expression (lib/shape.ml[148,4453+30]..[148,4453+46])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[148,4453+30]..[148,4453+44])
                                                      Pexp_ident "collect_idents" (lib/shape.ml[148,4453+30]..[148,4453+44])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[148,4453+45]..[148,4453+46])
                                                          Pexp_ident "t" (lib/shape.ml[148,4453+45]..[148,4453+46])
                                                    ]
                                              ]
                                              expression (lib/shape.ml[149,4503+12]..[149,4503+27])
                                                Pexp_tuple
                                                [
                                                  expression (lib/shape.ml[149,4503+12]..[149,4503+21])
                                                    Pexp_construct "::" (lib/shape.ml[149,4503+15]..[149,4503+17])
                                                    Some
                                                      expression (lib/shape.ml[149,4503+12]..[149,4503+21]) ghost
                                                        Pexp_tuple
                                                        [
                                                          expression (lib/shape.ml[149,4503+12]..[149,4503+14])
                                                            Pexp_ident "id" (lib/shape.ml[149,4503+12]..[149,4503+14])
                                                          expression (lib/shape.ml[149,4503+18]..[149,4503+21])
                                                            Pexp_ident "ids" (lib/shape.ml[149,4503+18]..[149,4503+21])
                                                        ]
                                                  expression (lib/shape.ml[149,4503+23]..[149,4503+27])
                                                    Pexp_ident "body" (lib/shape.ml[149,4503+23]..[149,4503+27])
                                                ]
                                          <case>
                                            pattern (lib/shape.ml[150,4531+12]..[150,4531+16])
                                              Ppat_var "body" (lib/shape.ml[150,4531+12]..[150,4531+16])
                                            expression (lib/shape.ml[151,4551+12]..[151,4551+22])
                                              Pexp_tuple
                                              [
                                                expression (lib/shape.ml[151,4551+13]..[151,4551+15])
                                                  Pexp_construct "[]" (lib/shape.ml[151,4551+13]..[151,4551+15])
                                                  None
                                                expression (lib/shape.ml[151,4551+17]..[151,4551+21])
                                                  Pexp_ident "body" (lib/shape.ml[151,4551+17]..[151,4551+21])
                                              ]
                                        ]
                                ]
                                expression (lib/shape.ml[153,4585+8]..[159,4864+67])
                                  Pexp_let Nonrec
                                  [
                                    <def>
                                      pattern (lib/shape.ml[153,4585+12]..[153,4585+32])
                                        Ppat_tuple
                                        [
                                          pattern (lib/shape.ml[153,4585+13]..[153,4585+25])
                                            Ppat_var "other_idents" (lib/shape.ml[153,4585+13]..[153,4585+25])
                                          pattern (lib/shape.ml[153,4585+27]..[153,4585+31])
                                            Ppat_var "body" (lib/shape.ml[153,4585+27]..[153,4585+31])
                                        ]
                                      expression (lib/shape.ml[153,4585+35]..[153,4585+51])
                                        Pexp_apply
                                        expression (lib/shape.ml[153,4585+35]..[153,4585+49])
                                          Pexp_ident "collect_idents" (lib/shape.ml[153,4585+35]..[153,4585+49])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[153,4585+50]..[153,4585+51])
                                              Pexp_ident "t" (lib/shape.ml[153,4585+50]..[153,4585+51])
                                        ]
                                  ]
                                  expression (lib/shape.ml[154,4640+8]..[159,4864+67])
                                    Pexp_let Nonrec
                                    [
                                      <def>
                                        pattern (lib/shape.ml[154,4640+12]..[154,4640+21])
                                          Ppat_var "pp_idents" (lib/shape.ml[154,4640+12]..[154,4640+21])
                                        expression (lib/shape.ml[154,4640+22]..[156,4733+61]) ghost
                                          Pexp_function
                                          [
                                            Pparam_val (lib/shape.ml[154,4640+22]..[154,4640+25])
                                              Nolabel
                                              None
                                              pattern (lib/shape.ml[154,4640+22]..[154,4640+25])
                                                Ppat_var "fmt" (lib/shape.ml[154,4640+22]..[154,4640+25])
                                            Pparam_val (lib/shape.ml[154,4640+26]..[154,4640+32])
                                              Nolabel
                                              None
                                              pattern (lib/shape.ml[154,4640+26]..[154,4640+32])
                                                Ppat_var "idents" (lib/shape.ml[154,4640+26]..[154,4640+32])
                                          ]
                                          None
                                          Pfunction_body
                                            expression (lib/shape.ml[155,4675+10]..[156,4733+61])
                                              Pexp_let Nonrec
                                              [
                                                <def>
                                                  pattern (lib/shape.ml[155,4675+14]..[155,4675+20])
                                                    Ppat_var "pp_sep" (lib/shape.ml[155,4675+14]..[155,4675+20])
                                                  expression (lib/shape.ml[155,4675+21]..[155,4675+54]) ghost
                                                    Pexp_function
                                                    [
                                                      Pparam_val (lib/shape.ml[155,4675+21]..[155,4675+24])
                                                        Nolabel
                                                        None
                                                        pattern (lib/shape.ml[155,4675+21]..[155,4675+24])
                                                          Ppat_var "fmt" (lib/shape.ml[155,4675+21]..[155,4675+24])
                                                      Pparam_val (lib/shape.ml[155,4675+25]..[155,4675+27])
                                                        Nolabel
                                                        None
                                                        pattern (lib/shape.ml[155,4675+25]..[155,4675+27])
                                                          Ppat_construct "()" (lib/shape.ml[155,4675+25]..[155,4675+27])
                                                          None
                                                    ]
                                                    None
                                                    Pfunction_body
                                                      expression (lib/shape.ml[155,4675+30]..[155,4675+54])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[155,4675+30]..[155,4675+44])
                                                          Pexp_ident "Format.fprintf" (lib/shape.ml[155,4675+30]..[155,4675+44])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[155,4675+45]..[155,4675+48])
                                                              Pexp_ident "fmt" (lib/shape.ml[155,4675+45]..[155,4675+48])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[155,4675+49]..[155,4675+54])
                                                              Pexp_constant PConst_string(",@ ",(lib/shape.ml[155,4675+50]..[155,4675+53]),None)
                                                        ]
                                              ]
                                              expression (lib/shape.ml[156,4733+10]..[156,4733+61])
                                                Pexp_apply
                                                expression (lib/shape.ml[156,4733+10]..[156,4733+30])
                                                  Pexp_ident "Format.pp_print_list" (lib/shape.ml[156,4733+10]..[156,4733+30])
                                                [
                                                  <arg>
                                                  Labelled "pp_sep"
                                                    expression (lib/shape.ml[156,4733+32]..[156,4733+38])
                                                      Pexp_ident "pp_sep" (lib/shape.ml[156,4733+32]..[156,4733+38])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[156,4733+39]..[156,4733+50])
                                                      Pexp_ident "Ident.print" (lib/shape.ml[156,4733+39]..[156,4733+50])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[156,4733+51]..[156,4733+54])
                                                      Pexp_ident "fmt" (lib/shape.ml[156,4733+51]..[156,4733+54])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[156,4733+55]..[156,4733+61])
                                                      Pexp_ident "idents" (lib/shape.ml[156,4733+55]..[156,4733+61])
                                                ]
                                    ]
                                    expression (lib/shape.ml[158,4806+8]..[159,4864+67])
                                      Pexp_apply
                                      expression (lib/shape.ml[158,4806+8]..[158,4806+22])
                                        Pexp_ident "Format.fprintf" (lib/shape.ml[158,4806+8]..[158,4806+22])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[158,4806+23]..[158,4806+26])
                                            Pexp_ident "fmt" (lib/shape.ml[158,4806+23]..[158,4806+26])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[158,4806+27]..[158,4806+57])
                                            Pexp_constant PConst_string("Abs@[%a@,(@[%a,@ @[%a@]@])@]",(lib/shape.ml[158,4806+28]..[158,4806+56]),None)
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4864+10]..[159,4864+23])
                                            Pexp_ident "print_uid_opt" (lib/shape.ml[159,4864+10]..[159,4864+23])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4864+24]..[159,4864+27])
                                            Pexp_ident "uid" (lib/shape.ml[159,4864+24]..[159,4864+27])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4864+28]..[159,4864+37])
                                            Pexp_ident "pp_idents" (lib/shape.ml[159,4864+28]..[159,4864+37])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4864+38]..[159,4864+58])
                                            Pexp_construct "::" (lib/shape.ml[159,4864+42]..[159,4864+44])
                                            Some
                                              expression (lib/shape.ml[159,4864+39]..[159,4864+57]) ghost
                                                Pexp_tuple
                                                [
                                                  expression (lib/shape.ml[159,4864+39]..[159,4864+41])
                                                    Pexp_ident "id" (lib/shape.ml[159,4864+39]..[159,4864+41])
                                                  expression (lib/shape.ml[159,4864+45]..[159,4864+57])
                                                    Pexp_ident "other_idents" (lib/shape.ml[159,4864+45]..[159,4864+57])
                                                ]
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4864+59]..[159,4864+62])
                                            Pexp_ident "aux" (lib/shape.ml[159,4864+59]..[159,4864+62])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[159,4864+63]..[159,4864+67])
                                            Pexp_ident "body" (lib/shape.ml[159,4864+63]..[159,4864+67])
                                      ]
                            <case>
                              pattern (lib/shape.ml[160,4932+6]..[160,4932+18])
                                Ppat_construct "App" (lib/shape.ml[160,4932+6]..[160,4932+9])
                                Some
                                  []
                                  pattern (lib/shape.ml[160,4932+10]..[160,4932+18])
                                    Ppat_tuple
                                    [
                                      pattern (lib/shape.ml[160,4932+11]..[160,4932+13])
                                        Ppat_var "t1" (lib/shape.ml[160,4932+11]..[160,4932+13])
                                      pattern (lib/shape.ml[160,4932+15]..[160,4932+17])
                                        Ppat_var "t2" (lib/shape.ml[160,4932+15]..[160,4932+17])
                                    ]
                              expression (lib/shape.ml[161,4954+8]..[162,5012+27])
                                Pexp_apply
                                expression (lib/shape.ml[161,4954+8]..[161,4954+22])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[161,4954+8]..[161,4954+22])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4954+23]..[161,4954+26])
                                      Pexp_ident "fmt" (lib/shape.ml[161,4954+23]..[161,4954+26])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4954+27]..[161,4954+43])
                                      Pexp_constant PConst_string("@[%a(@,%a)%a@]",(lib/shape.ml[161,4954+28]..[161,4954+42]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4954+44]..[161,4954+47])
                                      Pexp_ident "aux" (lib/shape.ml[161,4954+44]..[161,4954+47])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4954+48]..[161,4954+50])
                                      Pexp_ident "t1" (lib/shape.ml[161,4954+48]..[161,4954+50])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4954+51]..[161,4954+54])
                                      Pexp_ident "aux" (lib/shape.ml[161,4954+51]..[161,4954+54])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[161,4954+55]..[161,4954+57])
                                      Pexp_ident "t2" (lib/shape.ml[161,4954+55]..[161,4954+57])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[162,5012+10]..[162,5012+23])
                                      Pexp_ident "print_uid_opt" (lib/shape.ml[162,5012+10]..[162,5012+23])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[162,5012+24]..[162,5012+27])
                                      Pexp_ident "uid" (lib/shape.ml[162,5012+24]..[162,5012+27])
                                ]
                            <case>
                              pattern (lib/shape.ml[163,5040+6]..[163,5040+10])
                                Ppat_construct "Leaf" (lib/shape.ml[163,5040+6]..[163,5040+10])
                                None
                              expression (lib/shape.ml[164,5054+8]..[164,5054+72])
                                Pexp_apply
                                expression (lib/shape.ml[164,5054+8]..[164,5054+22])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[164,5054+8]..[164,5054+22])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,5054+23]..[164,5054+26])
                                      Pexp_ident "fmt" (lib/shape.ml[164,5054+23]..[164,5054+26])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,5054+27]..[164,5054+33])
                                      Pexp_constant PConst_string("<%a>",(lib/shape.ml[164,5054+28]..[164,5054+32]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,5054+34]..[164,5054+68])
                                      Pexp_apply
                                      expression (lib/shape.ml[164,5054+35]..[164,5054+57])
                                        Pexp_ident "Format.pp_print_option" (lib/shape.ml[164,5054+35]..[164,5054+57])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[164,5054+58]..[164,5054+67])
                                            Pexp_ident "Uid.print" (lib/shape.ml[164,5054+58]..[164,5054+67])
                                      ]
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[164,5054+69]..[164,5054+72])
                                      Pexp_ident "uid" (lib/shape.ml[164,5054+69]..[164,5054+72])
                                ]
                            <case>
                              pattern (lib/shape.ml[165,5127+6]..[165,5127+20])
                                Ppat_construct "Proj" (lib/shape.ml[165,5127+6]..[165,5127+10])
                                Some
                                  []
                                  pattern (lib/shape.ml[165,5127+11]..[165,5127+20])
                                    Ppat_tuple
                                    [
                                      pattern (lib/shape.ml[165,5127+12]..[165,5127+13])
                                        Ppat_var "t" (lib/shape.ml[165,5127+12]..[165,5127+13])
                                      pattern (lib/shape.ml[165,5127+15]..[165,5127+19])
                                        Ppat_var "item" (lib/shape.ml[165,5127+15]..[165,5127+19])
                                    ]
                              expression (lib/shape.ml[166,5151+8]..[176,5448+11])
                                Pexp_match
                                expression (lib/shape.ml[166,5151+20]..[166,5151+23])
                                  Pexp_ident "uid" (lib/shape.ml[166,5151+20]..[166,5151+23])
                                [
                                  <case>
                                    pattern (lib/shape.ml[167,5180+10]..[167,5180+14])
                                      Ppat_construct "None" (lib/shape.ml[167,5180+10]..[167,5180+14])
                                      None
                                    expression (lib/shape.ml[168,5198+12]..[170,5265+29])
                                      Pexp_apply
                                      expression (lib/shape.ml[168,5198+12]..[168,5198+26])
                                        Pexp_ident "Format.fprintf" (lib/shape.ml[168,5198+12]..[168,5198+26])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[168,5198+27]..[168,5198+30])
                                            Pexp_ident "fmt" (lib/shape.ml[168,5198+27]..[168,5198+30])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[168,5198+31]..[168,5198+46])
                                            Pexp_constant PConst_string("@[%a@ .@ %a@]",(lib/shape.ml[168,5198+32]..[168,5198+45]),None)
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[169,5245+14]..[169,5245+17])
                                            Pexp_ident "aux" (lib/shape.ml[169,5245+14]..[169,5245+17])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[169,5245+18]..[169,5245+19])
                                            Pexp_ident "t" (lib/shape.ml[169,5245+18]..[169,5245+19])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[170,5265+14]..[170,5265+24])
                                            Pexp_ident "Item.print" (lib/shape.ml[170,5265+14]..[170,5265+24])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[170,5265+25]..[170,5265+29])
                                            Pexp_ident "item" (lib/shape.ml[170,5265+25]..[170,5265+29])
                                      ]
                                  <case>
                                    pattern (lib/shape.ml[171,5295+10]..[171,5295+18])
                                      Ppat_construct "Some" (lib/shape.ml[171,5295+10]..[171,5295+14])
                                      Some
                                        []
                                        pattern (lib/shape.ml[171,5295+15]..[171,5295+18])
                                          Ppat_var "uid" (lib/shape.ml[171,5295+15]..[171,5295+18])
                                    expression (lib/shape.ml[172,5317+12]..[175,5420+27])
                                      Pexp_apply
                                      expression (lib/shape.ml[172,5317+12]..[172,5317+26])
                                        Pexp_ident "Format.fprintf" (lib/shape.ml[172,5317+12]..[172,5317+26])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[172,5317+27]..[172,5317+30])
                                            Pexp_ident "fmt" (lib/shape.ml[172,5317+27]..[172,5317+30])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[172,5317+31]..[172,5317+52])
                                            Pexp_constant PConst_string("@[(%a@ .@ %a)<%a>@]",(lib/shape.ml[172,5317+32]..[172,5317+51]),None)
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[173,5370+14]..[173,5370+17])
                                            Pexp_ident "aux" (lib/shape.ml[173,5370+14]..[173,5370+17])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[173,5370+18]..[173,5370+19])
                                            Pexp_ident "t" (lib/shape.ml[173,5370+18]..[173,5370+19])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[174,5390+14]..[174,5390+24])
                                            Pexp_ident "Item.print" (lib/shape.ml[174,5390+14]..[174,5390+24])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[174,5390+25]..[174,5390+29])
                                            Pexp_ident "item" (lib/shape.ml[174,5390+25]..[174,5390+29])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[175,5420+14]..[175,5420+23])
                                            Pexp_ident "Uid.print" (lib/shape.ml[175,5420+14]..[175,5420+23])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[175,5420+24]..[175,5420+27])
                                            Pexp_ident "uid" (lib/shape.ml[175,5420+24]..[175,5420+27])
                                      ]
                                ]
                            <case>
                              pattern (lib/shape.ml[177,5460+6]..[177,5460+20])
                                Ppat_construct "Comp_unit" (lib/shape.ml[177,5460+6]..[177,5460+15])
                                Some
                                  []
                                  pattern (lib/shape.ml[177,5460+16]..[177,5460+20])
                                    Ppat_var "name" (lib/shape.ml[177,5460+16]..[177,5460+20])
                              expression (lib/shape.ml[177,5460+24]..[177,5460+55])
                                Pexp_apply
                                expression (lib/shape.ml[177,5460+24]..[177,5460+38])
                                  Pexp_ident "Format.fprintf" (lib/shape.ml[177,5460+24]..[177,5460+38])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[177,5460+39]..[177,5460+42])
                                      Pexp_ident "fmt" (lib/shape.ml[177,5460+39]..[177,5460+42])
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[177,5460+43]..[177,5460+50])
                                      Pexp_constant PConst_string("CU %s",(lib/shape.ml[177,5460+44]..[177,5460+49]),None)
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[177,5460+51]..[177,5460+55])
                                      Pexp_ident "name" (lib/shape.ml[177,5460+51]..[177,5460+55])
                                ]
                            <case>
                              pattern (lib/shape.ml[178,5516+6]..[178,5516+16])
                                Ppat_construct "Struct" (lib/shape.ml[178,5516+6]..[178,5516+12])
                                Some
                                  []
                                  pattern (lib/shape.ml[178,5516+13]..[178,5516+16])
                                    Ppat_var "map" (lib/shape.ml[178,5516+13]..[178,5516+16])
                              expression (lib/shape.ml[179,5536+8]..[186,5740+76])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (lib/shape.ml[179,5536+12]..[179,5536+21])
                                      Ppat_var "print_map" (lib/shape.ml[179,5536+12]..[179,5536+21])
                                    expression (lib/shape.ml[179,5536+22]..[184,5715+13]) ghost
                                      Pexp_function
                                      [
                                        Pparam_val (lib/shape.ml[179,5536+22]..[179,5536+25])
                                          Nolabel
                                          None
                                          pattern (lib/shape.ml[179,5536+22]..[179,5536+25])
                                            Ppat_var "fmt" (lib/shape.ml[179,5536+22]..[179,5536+25])
                                      ]
                                      None
                                      Pfunction_body
                                        expression (lib/shape.ml[180,5564+10]..[184,5715+13])
                                          Pexp_apply
                                          expression (lib/shape.ml[180,5564+10]..[180,5564+23])
                                            Pexp_ident "Item.Map.iter" (lib/shape.ml[180,5564+10]..[180,5564+23])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[180,5564+24]..[184,5715+13])
                                                Pexp_function
                                                [
                                                  Pparam_val (lib/shape.ml[180,5564+29]..[180,5564+33])
                                                    Nolabel
                                                    None
                                                    pattern (lib/shape.ml[180,5564+29]..[180,5564+33])
                                                      Ppat_var "item" (lib/shape.ml[180,5564+29]..[180,5564+33])
                                                  Pparam_val (lib/shape.ml[180,5564+34]..[180,5564+35])
                                                    Nolabel
                                                    None
                                                    pattern (lib/shape.ml[180,5564+34]..[180,5564+35])
                                                      Ppat_var "t" (lib/shape.ml[180,5564+34]..[180,5564+35])
                                                ]
                                                None
                                                Pfunction_body
                                                  expression (lib/shape.ml[181,5603+14]..[183,5693+21])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[181,5603+14]..[181,5603+28])
                                                      Pexp_ident "Format.fprintf" (lib/shape.ml[181,5603+14]..[181,5603+28])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[181,5603+29]..[181,5603+32])
                                                          Pexp_ident "fmt" (lib/shape.ml[181,5603+29]..[181,5603+32])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[181,5603+33]..[181,5603+57])
                                                          Pexp_constant PConst_string("@[<hv 2>%a ->@ %a;@]@,",(lib/shape.ml[181,5603+34]..[181,5603+56]),None)
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[182,5661+16]..[182,5661+26])
                                                          Pexp_ident "Item.print" (lib/shape.ml[182,5661+16]..[182,5661+26])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[182,5661+27]..[182,5661+31])
                                                          Pexp_ident "item" (lib/shape.ml[182,5661+27]..[182,5661+31])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[183,5693+16]..[183,5693+19])
                                                          Pexp_ident "aux" (lib/shape.ml[183,5693+16]..[183,5693+19])
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[183,5693+20]..[183,5693+21])
                                                          Pexp_ident "t" (lib/shape.ml[183,5693+20]..[183,5693+21])
                                                    ]
                                          ]
                                ]
                                expression (lib/shape.ml[186,5740+8]..[186,5740+76])
                                  Pexp_apply
                                  expression (lib/shape.ml[186,5740+8]..[186,5740+22])
                                    Pexp_ident "Format.fprintf" (lib/shape.ml[186,5740+8]..[186,5740+22])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5740+23]..[186,5740+26])
                                        Pexp_ident "fmt" (lib/shape.ml[186,5740+23]..[186,5740+26])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5740+27]..[186,5740+44])
                                        Pexp_constant PConst_string("{@[<v>%a@,%a@]}",(lib/shape.ml[186,5740+28]..[186,5740+43]),None)
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5740+45]..[186,5740+58])
                                        Pexp_ident "print_uid_opt" (lib/shape.ml[186,5740+45]..[186,5740+58])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5740+59]..[186,5740+62])
                                        Pexp_ident "uid" (lib/shape.ml[186,5740+59]..[186,5740+62])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5740+63]..[186,5740+72])
                                        Pexp_ident "print_map" (lib/shape.ml[186,5740+63]..[186,5740+72])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[186,5740+73]..[186,5740+76])
                                        Pexp_ident "map" (lib/shape.ml[186,5740+73]..[186,5740+76])
                                  ]
                          ]
                ]
                expression (lib/shape.ml[188,5822+2]..[188,5822+34])
                  Pexp_apply
                  expression (lib/shape.ml[188,5822+2]..[188,5822+16])
                    Pexp_ident "Format.fprintf" (lib/shape.ml[188,5822+2]..[188,5822+16])
                  [
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[188,5822+17]..[188,5822+20])
                        Pexp_ident "fmt" (lib/shape.ml[188,5822+17]..[188,5822+20])
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[188,5822+20]..[188,5822+30])
                        Pexp_constant PConst_string("@[%a@]@;",(lib/shape.ml[188,5822+21]..[188,5822+29]),None)
                    <arg>
                    Nolabel
                      expression (lib/shape.ml[188,5822+31]..[188,5822+34])
                        Pexp_ident "aux" (lib/shape.ml[188,5822+31]..[188,5822+34])
                  ]
    ]
  structure_item (lib/shape.ml[190,5858+0]..[192,5937+41])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[190,5858+4]..[190,5858+13])
          Ppat_var "fresh_var" (lib/shape.ml[190,5858+4]..[190,5858+13])
        expression (lib/shape.ml[190,5858+14]..[192,5937+41]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[190,5858+14]..[190,5858+33])
              Optional "name"
              Some
                expression (lib/shape.ml[190,5858+21]..[190,5858+32])
                  Pexp_constant PConst_string("shape-var",(lib/shape.ml[190,5858+22]..[190,5858+31]),None)
              pattern (lib/shape.ml[190,5858+16]..[190,5858+20])
                Ppat_var "name" (lib/shape.ml[190,5858+16]..[190,5858+20])
            Pparam_val (lib/shape.ml[190,5858+34]..[190,5858+37])
              Nolabel
              None
              pattern (lib/shape.ml[190,5858+34]..[190,5858+37])
                Ppat_var "uid" (lib/shape.ml[190,5858+34]..[190,5858+37])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[191,5898+2]..[192,5937+41])
              Pexp_let Nonrec
              [
                <def>
                  pattern (lib/shape.ml[191,5898+6]..[191,5898+9])
                    Ppat_var "var" (lib/shape.ml[191,5898+6]..[191,5898+9])
                  expression (lib/shape.ml[191,5898+12]..[191,5898+35])
                    Pexp_apply
                    expression (lib/shape.ml[191,5898+12]..[191,5898+30])
                      Pexp_ident "Ident.create_local" (lib/shape.ml[191,5898+12]..[191,5898+30])
                    [
                      <arg>
                      Nolabel
                        expression (lib/shape.ml[191,5898+31]..[191,5898+35])
                          Pexp_ident "name" (lib/shape.ml[191,5898+31]..[191,5898+35])
                    ]
              ]
              expression (lib/shape.ml[192,5937+2]..[192,5937+41])
                Pexp_tuple
                [
                  expression (lib/shape.ml[192,5937+2]..[192,5937+5])
                    Pexp_ident "var" (lib/shape.ml[192,5937+2]..[192,5937+5])
                  expression (lib/shape.ml[192,5937+7]..[192,5937+41])
                    Pexp_record
                    [
                      "uid" (lib/shape.ml[192,5937+9]..[192,5937+12])
                        expression (lib/shape.ml[192,5937+15]..[192,5937+23])
                          Pexp_construct "Some" (lib/shape.ml[192,5937+15]..[192,5937+19])
                          Some
                            expression (lib/shape.ml[192,5937+20]..[192,5937+23])
                              Pexp_ident "uid" (lib/shape.ml[192,5937+20]..[192,5937+23])
                      "desc" (lib/shape.ml[192,5937+25]..[192,5937+29])
                        expression (lib/shape.ml[192,5937+32]..[192,5937+39])
                          Pexp_construct "Var" (lib/shape.ml[192,5937+32]..[192,5937+35])
                          Some
                            expression (lib/shape.ml[192,5937+36]..[192,5937+39])
                              Pexp_ident "var" (lib/shape.ml[192,5937+36]..[192,5937+39])
                    ]
                    None
                ]
    ]
  structure_item (lib/shape.ml[194,5980+0]..[194,5980+55])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[194,5980+4]..[194,5980+29])
          Ppat_var "for_unnamed_functor_param" (lib/shape.ml[194,5980+4]..[194,5980+29])
        expression (lib/shape.ml[194,5980+32]..[194,5980+55])
          Pexp_apply
          expression (lib/shape.ml[194,5980+32]..[194,5980+50])
            Pexp_ident "Ident.create_local" (lib/shape.ml[194,5980+32]..[194,5980+50])
          [
            <arg>
            Nolabel
              expression (lib/shape.ml[194,5980+51]..[194,5980+55])
                Pexp_constant PConst_string("()",(lib/shape.ml[194,5980+52]..[194,5980+54]),None)
          ]
    ]
  structure_item (lib/shape.ml[196,6037+0]..[197,6054+35])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[196,6037+4]..[196,6037+7])
          Ppat_var "var" (lib/shape.ml[196,6037+4]..[196,6037+7])
        expression (lib/shape.ml[196,6037+8]..[197,6054+35]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[196,6037+8]..[196,6037+11])
              Nolabel
              None
              pattern (lib/shape.ml[196,6037+8]..[196,6037+11])
                Ppat_var "uid" (lib/shape.ml[196,6037+8]..[196,6037+11])
            Pparam_val (lib/shape.ml[196,6037+12]..[196,6037+14])
              Nolabel
              None
              pattern (lib/shape.ml[196,6037+12]..[196,6037+14])
                Ppat_var "id" (lib/shape.ml[196,6037+12]..[196,6037+14])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[197,6054+2]..[197,6054+35])
              Pexp_record
              [
                "uid" (lib/shape.ml[197,6054+4]..[197,6054+7])
                  expression (lib/shape.ml[197,6054+10]..[197,6054+18])
                    Pexp_construct "Some" (lib/shape.ml[197,6054+10]..[197,6054+14])
                    Some
                      expression (lib/shape.ml[197,6054+15]..[197,6054+18])
                        Pexp_ident "uid" (lib/shape.ml[197,6054+15]..[197,6054+18])
                "desc" (lib/shape.ml[197,6054+20]..[197,6054+24])
                  expression (lib/shape.ml[197,6054+27]..[197,6054+33])
                    Pexp_construct "Var" (lib/shape.ml[197,6054+27]..[197,6054+30])
                    Some
                      expression (lib/shape.ml[197,6054+31]..[197,6054+33])
                        Pexp_ident "id" (lib/shape.ml[197,6054+31]..[197,6054+33])
              ]
              None
    ]
  structure_item (lib/shape.ml[199,6091+0]..[200,6115+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[199,6091+4]..[199,6091+7])
          Ppat_var "abs" (lib/shape.ml[199,6091+4]..[199,6091+7])
        expression (lib/shape.ml[199,6091+8]..[200,6115+33]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[199,6091+8]..[199,6091+12])
              Optional "uid"
              None
              pattern (lib/shape.ml[199,6091+9]..[199,6091+12])
                Ppat_var "uid" (lib/shape.ml[199,6091+9]..[199,6091+12])
            Pparam_val (lib/shape.ml[199,6091+13]..[199,6091+16])
              Nolabel
              None
              pattern (lib/shape.ml[199,6091+13]..[199,6091+16])
                Ppat_var "var" (lib/shape.ml[199,6091+13]..[199,6091+16])
            Pparam_val (lib/shape.ml[199,6091+17]..[199,6091+21])
              Nolabel
              None
              pattern (lib/shape.ml[199,6091+17]..[199,6091+21])
                Ppat_var "body" (lib/shape.ml[199,6091+17]..[199,6091+21])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[200,6115+2]..[200,6115+33])
              Pexp_record
              [
                "uid" (lib/shape.ml[200,6115+4]..[200,6115+7]) ghost
                  expression (lib/shape.ml[200,6115+4]..[200,6115+7])
                    Pexp_ident "uid" (lib/shape.ml[200,6115+4]..[200,6115+7])
                "desc" (lib/shape.ml[200,6115+9]..[200,6115+13])
                  expression (lib/shape.ml[200,6115+16]..[200,6115+31])
                    Pexp_construct "Abs" (lib/shape.ml[200,6115+16]..[200,6115+19])
                    Some
                      expression (lib/shape.ml[200,6115+20]..[200,6115+31])
                        Pexp_tuple
                        [
                          expression (lib/shape.ml[200,6115+21]..[200,6115+24])
                            Pexp_ident "var" (lib/shape.ml[200,6115+21]..[200,6115+24])
                          expression (lib/shape.ml[200,6115+26]..[200,6115+30])
                            Pexp_ident "body" (lib/shape.ml[200,6115+26]..[200,6115+30])
                        ]
              ]
              None
    ]
  structure_item (lib/shape.ml[202,6150+0]..[203,6169+28])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[202,6150+4]..[202,6150+7])
          Ppat_var "str" (lib/shape.ml[202,6150+4]..[202,6150+7])
        expression (lib/shape.ml[202,6150+8]..[203,6169+28]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[202,6150+8]..[202,6150+12])
              Optional "uid"
              None
              pattern (lib/shape.ml[202,6150+9]..[202,6150+12])
                Ppat_var "uid" (lib/shape.ml[202,6150+9]..[202,6150+12])
            Pparam_val (lib/shape.ml[202,6150+13]..[202,6150+16])
              Nolabel
              None
              pattern (lib/shape.ml[202,6150+13]..[202,6150+16])
                Ppat_var "map" (lib/shape.ml[202,6150+13]..[202,6150+16])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[203,6169+2]..[203,6169+28])
              Pexp_record
              [
                "uid" (lib/shape.ml[203,6169+4]..[203,6169+7]) ghost
                  expression (lib/shape.ml[203,6169+4]..[203,6169+7])
                    Pexp_ident "uid" (lib/shape.ml[203,6169+4]..[203,6169+7])
                "desc" (lib/shape.ml[203,6169+9]..[203,6169+13])
                  expression (lib/shape.ml[203,6169+16]..[203,6169+26])
                    Pexp_construct "Struct" (lib/shape.ml[203,6169+16]..[203,6169+22])
                    Some
                      expression (lib/shape.ml[203,6169+23]..[203,6169+26])
                        Pexp_ident "map" (lib/shape.ml[203,6169+23]..[203,6169+26])
              ]
              None
    ]
  structure_item (lib/shape.ml[205,6199+0]..[206,6214+33])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[205,6199+4]..[205,6199+8])
          Ppat_var "leaf" (lib/shape.ml[205,6199+4]..[205,6199+8])
        expression (lib/shape.ml[205,6199+9]..[206,6214+33]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[205,6199+9]..[205,6199+12])
              Nolabel
              None
              pattern (lib/shape.ml[205,6199+9]..[205,6199+12])
                Ppat_var "uid" (lib/shape.ml[205,6199+9]..[205,6199+12])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[206,6214+2]..[206,6214+33])
              Pexp_record
              [
                "uid" (lib/shape.ml[206,6214+4]..[206,6214+7])
                  expression (lib/shape.ml[206,6214+10]..[206,6214+18])
                    Pexp_construct "Some" (lib/shape.ml[206,6214+10]..[206,6214+14])
                    Some
                      expression (lib/shape.ml[206,6214+15]..[206,6214+18])
                        Pexp_ident "uid" (lib/shape.ml[206,6214+15]..[206,6214+18])
                "desc" (lib/shape.ml[206,6214+20]..[206,6214+24])
                  expression (lib/shape.ml[206,6214+27]..[206,6214+31])
                    Pexp_construct "Leaf" (lib/shape.ml[206,6214+27]..[206,6214+31])
                    None
              ]
              None
    ]
  structure_item (lib/shape.ml[208,6249+0]..[219,6529+36])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[208,6249+4]..[208,6249+8])
          Ppat_var "proj" (lib/shape.ml[208,6249+4]..[208,6249+8])
        expression (lib/shape.ml[208,6249+9]..[219,6529+36]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[208,6249+9]..[208,6249+13])
              Optional "uid"
              None
              pattern (lib/shape.ml[208,6249+10]..[208,6249+13])
                Ppat_var "uid" (lib/shape.ml[208,6249+10]..[208,6249+13])
            Pparam_val (lib/shape.ml[208,6249+14]..[208,6249+15])
              Nolabel
              None
              pattern (lib/shape.ml[208,6249+14]..[208,6249+15])
                Ppat_var "t" (lib/shape.ml[208,6249+14]..[208,6249+15])
            Pparam_val (lib/shape.ml[208,6249+16]..[208,6249+20])
              Nolabel
              None
              pattern (lib/shape.ml[208,6249+16]..[208,6249+20])
                Ppat_var "item" (lib/shape.ml[208,6249+16]..[208,6249+20])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[209,6272+2]..[219,6529+36])
              Pexp_match
              expression (lib/shape.ml[209,6272+8]..[209,6272+14])
                Pexp_field
                expression (lib/shape.ml[209,6272+8]..[209,6272+9])
                  Pexp_ident "t" (lib/shape.ml[209,6272+8]..[209,6272+9])
                "desc" (lib/shape.ml[209,6272+10]..[209,6272+14])
              [
                <case>
                  pattern (lib/shape.ml[210,6292+4]..[210,6292+8])
                    Ppat_construct "Leaf" (lib/shape.ml[210,6292+4]..[210,6292+8])
                    None
                  expression (lib/shape.ml[213,6395+6]..[213,6395+7])
                    Pexp_ident "t" (lib/shape.ml[213,6395+6]..[213,6395+7])
                <case>
                  pattern (lib/shape.ml[214,6403+4]..[214,6403+14])
                    Ppat_construct "Struct" (lib/shape.ml[214,6403+4]..[214,6403+10])
                    Some
                      []
                      pattern (lib/shape.ml[214,6403+11]..[214,6403+14])
                        Ppat_var "map" (lib/shape.ml[214,6403+11]..[214,6403+14])
                  expression (lib/shape.ml[215,6421+6]..[217,6510+9])
                    Pexp_try
                    expression (lib/shape.ml[215,6421+16]..[215,6421+38])
                      Pexp_apply
                      expression (lib/shape.ml[215,6421+16]..[215,6421+29])
                        Pexp_ident "Item.Map.find" (lib/shape.ml[215,6421+16]..[215,6421+29])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[215,6421+30]..[215,6421+34])
                            Pexp_ident "item" (lib/shape.ml[215,6421+30]..[215,6421+34])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[215,6421+35]..[215,6421+38])
                            Pexp_ident "map" (lib/shape.ml[215,6421+35]..[215,6421+38])
                      ]
                    [
                      <case>
                        pattern (lib/shape.ml[216,6460+11]..[216,6460+20])
                          Ppat_construct "Not_found" (lib/shape.ml[216,6460+11]..[216,6460+20])
                          None
                        expression (lib/shape.ml[216,6460+24]..[216,6460+25])
                          Pexp_ident "t" (lib/shape.ml[216,6460+24]..[216,6460+25])
                    ]
                <case>
                  pattern (lib/shape.ml[218,6520+4]..[218,6520+5])
                    Ppat_any
                  expression (lib/shape.ml[219,6529+6]..[219,6529+36])
                    Pexp_record
                    [
                      "uid" (lib/shape.ml[219,6529+8]..[219,6529+11]) ghost
                        expression (lib/shape.ml[219,6529+8]..[219,6529+11])
                          Pexp_ident "uid" (lib/shape.ml[219,6529+8]..[219,6529+11])
                      "desc" (lib/shape.ml[219,6529+13]..[219,6529+17])
                        expression (lib/shape.ml[219,6529+20]..[219,6529+34])
                          Pexp_construct "Proj" (lib/shape.ml[219,6529+20]..[219,6529+24])
                          Some
                            expression (lib/shape.ml[219,6529+25]..[219,6529+34])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[219,6529+26]..[219,6529+27])
                                  Pexp_ident "t" (lib/shape.ml[219,6529+26]..[219,6529+27])
                                expression (lib/shape.ml[219,6529+29]..[219,6529+33])
                                  Pexp_ident "item" (lib/shape.ml[219,6529+29]..[219,6529+33])
                              ]
                    ]
                    None
              ]
    ]
  structure_item (lib/shape.ml[221,6567+0]..[222,6589+34])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[221,6567+4]..[221,6567+7])
          Ppat_var "app" (lib/shape.ml[221,6567+4]..[221,6567+7])
        expression (lib/shape.ml[221,6567+8]..[222,6589+34]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[221,6567+8]..[221,6567+12])
              Optional "uid"
              None
              pattern (lib/shape.ml[221,6567+9]..[221,6567+12])
                Ppat_var "uid" (lib/shape.ml[221,6567+9]..[221,6567+12])
            Pparam_val (lib/shape.ml[221,6567+13]..[221,6567+14])
              Nolabel
              None
              pattern (lib/shape.ml[221,6567+13]..[221,6567+14])
                Ppat_var "f" (lib/shape.ml[221,6567+13]..[221,6567+14])
            Pparam_val (lib/shape.ml[221,6567+15]..[221,6567+19])
              Labelled "arg"
              None
              pattern (lib/shape.ml[221,6567+16]..[221,6567+19])
                Ppat_var "arg" (lib/shape.ml[221,6567+16]..[221,6567+19])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[222,6589+6]..[222,6589+34])
              Pexp_record
              [
                "uid" (lib/shape.ml[222,6589+8]..[222,6589+11]) ghost
                  expression (lib/shape.ml[222,6589+8]..[222,6589+11])
                    Pexp_ident "uid" (lib/shape.ml[222,6589+8]..[222,6589+11])
                "desc" (lib/shape.ml[222,6589+13]..[222,6589+17])
                  expression (lib/shape.ml[222,6589+20]..[222,6589+32])
                    Pexp_construct "App" (lib/shape.ml[222,6589+20]..[222,6589+23])
                    Some
                      expression (lib/shape.ml[222,6589+24]..[222,6589+32])
                        Pexp_tuple
                        [
                          expression (lib/shape.ml[222,6589+25]..[222,6589+26])
                            Pexp_ident "f" (lib/shape.ml[222,6589+25]..[222,6589+26])
                          expression (lib/shape.ml[222,6589+28]..[222,6589+31])
                            Pexp_ident "arg" (lib/shape.ml[222,6589+28]..[222,6589+31])
                        ]
              ]
              None
    ]
  structure_item (lib/shape.ml[224,6625+0]..[227,6697+13])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[224,6625+4]..[224,6625+17])
          Ppat_var "decompose_abs" (lib/shape.ml[224,6625+4]..[224,6625+17])
        expression (lib/shape.ml[224,6625+18]..[227,6697+13]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[224,6625+18]..[224,6625+19])
              Nolabel
              None
              pattern (lib/shape.ml[224,6625+18]..[224,6625+19])
                Ppat_var "t" (lib/shape.ml[224,6625+18]..[224,6625+19])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[225,6647+2]..[227,6697+13])
              Pexp_match
              expression (lib/shape.ml[225,6647+8]..[225,6647+14])
                Pexp_field
                expression (lib/shape.ml[225,6647+8]..[225,6647+9])
                  Pexp_ident "t" (lib/shape.ml[225,6647+8]..[225,6647+9])
                "desc" (lib/shape.ml[225,6647+10]..[225,6647+14])
              [
                <case>
                  pattern (lib/shape.ml[226,6667+4]..[226,6667+14])
                    Ppat_construct "Abs" (lib/shape.ml[226,6667+4]..[226,6667+7])
                    Some
                      []
                      pattern (lib/shape.ml[226,6667+8]..[226,6667+14])
                        Ppat_tuple
                        [
                          pattern (lib/shape.ml[226,6667+9]..[226,6667+10])
                            Ppat_var "x" (lib/shape.ml[226,6667+9]..[226,6667+10])
                          pattern (lib/shape.ml[226,6667+12]..[226,6667+13])
                            Ppat_var "t" (lib/shape.ml[226,6667+12]..[226,6667+13])
                        ]
                  expression (lib/shape.ml[226,6667+18]..[226,6667+29])
                    Pexp_construct "Some" (lib/shape.ml[226,6667+18]..[226,6667+22])
                    Some
                      expression (lib/shape.ml[226,6667+23]..[226,6667+29])
                        Pexp_tuple
                        [
                          expression (lib/shape.ml[226,6667+24]..[226,6667+25])
                            Pexp_ident "x" (lib/shape.ml[226,6667+24]..[226,6667+25])
                          expression (lib/shape.ml[226,6667+27]..[226,6667+28])
                            Pexp_ident "t" (lib/shape.ml[226,6667+27]..[226,6667+28])
                        ]
                <case>
                  pattern (lib/shape.ml[227,6697+4]..[227,6697+5])
                    Ppat_any
                  expression (lib/shape.ml[227,6697+9]..[227,6697+13])
                    Pexp_construct "None" (lib/shape.ml[227,6697+9]..[227,6697+13])
                    None
              ]
    ]
  structure_item (lib/shape.ml[229,6712+0]..[450,15321+3])
    Pstr_module
    "Make_reduce" (lib/shape.ml[229,6712+7]..[229,6712+18])
      module_expr (lib/shape.ml[229,6712+18]..[450,15321+3])
        Pmod_functor "Params" (lib/shape.ml[229,6712+19]..[229,6712+25])
        module_type (lib/shape.ml[229,6712+28]..[234,6864+3])
          Pmty_signature
          [
            signature_item (lib/shape.ml[230,6744+2]..[230,6744+10])
              Psig_type Rec
              [
                type_declaration "env" (lib/shape.ml[230,6744+7]..[230,6744+10]) (lib/shape.ml[230,6744+2]..[230,6744+10])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            signature_item (lib/shape.ml[231,6755+2]..[231,6755+16])
              Psig_value
              value_description "fuel" (lib/shape.ml[231,6755+6]..[231,6755+10]) (lib/shape.ml[231,6755+2]..[231,6755+16])
                core_type (lib/shape.ml[231,6755+13]..[231,6755+16])
                  Ptyp_constr "int" (lib/shape.ml[231,6755+13]..[231,6755+16])
                  []
                []
            signature_item (lib/shape.ml[232,6772+2]..[232,6772+52])
              Psig_value
              value_description "read_unit_shape" (lib/shape.ml[232,6772+6]..[232,6772+21]) (lib/shape.ml[232,6772+2]..[232,6772+52])
                core_type (lib/shape.ml[232,6772+24]..[232,6772+52])
                  Ptyp_arrow
                  Labelled "unit_name"
                  core_type (lib/shape.ml[232,6772+34]..[232,6772+40])
                    Ptyp_constr "string" (lib/shape.ml[232,6772+34]..[232,6772+40])
                    []
                  core_type (lib/shape.ml[232,6772+44]..[232,6772+52])
                    Ptyp_constr "option" (lib/shape.ml[232,6772+46]..[232,6772+52])
                    [
                      core_type (lib/shape.ml[232,6772+44]..[232,6772+45])
                        Ptyp_constr "t" (lib/shape.ml[232,6772+44]..[232,6772+45])
                        []
                    ]
                []
            signature_item (lib/shape.ml[233,6825+2]..[233,6825+38])
              Psig_value
              value_description "find_shape" (lib/shape.ml[233,6825+6]..[233,6825+16]) (lib/shape.ml[233,6825+2]..[233,6825+38])
                core_type (lib/shape.ml[233,6825+19]..[233,6825+38])
                  Ptyp_arrow
                  Nolabel
                  core_type (lib/shape.ml[233,6825+19]..[233,6825+22])
                    Ptyp_constr "env" (lib/shape.ml[233,6825+19]..[233,6825+22])
                    []
                  core_type (lib/shape.ml[233,6825+26]..[233,6825+38])
                    Ptyp_arrow
                    Nolabel
                    core_type (lib/shape.ml[233,6825+26]..[233,6825+33])
                      Ptyp_constr "Ident.t" (lib/shape.ml[233,6825+26]..[233,6825+33])
                      []
                    core_type (lib/shape.ml[233,6825+37]..[233,6825+38])
                      Ptyp_constr "t" (lib/shape.ml[233,6825+37]..[233,6825+38])
                      []
                []
          ]
        module_expr (lib/shape.ml[234,6864+7]..[450,15321+3])
          Pmod_structure
          [
            structure_item (lib/shape.ml[238,6987+2]..[268,8161+47])
              Pstr_type Rec
              [
                type_declaration "nf" (lib/shape.ml[238,6987+7]..[238,6987+9]) (lib/shape.ml[238,6987+2]..[238,6987+48])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_record
                      [
                        (lib/shape.ml[238,6987+14]..[238,6987+32])
                          Immutable
                          "uid" (lib/shape.ml[238,6987+14]..[238,6987+17])                          core_type (lib/shape.ml[238,6987+19]..[238,6987+31])
                            Ptyp_constr "option" (lib/shape.ml[238,6987+25]..[238,6987+31])
                            [
                              core_type (lib/shape.ml[238,6987+19]..[238,6987+24])
                                Ptyp_constr "Uid.t" (lib/shape.ml[238,6987+19]..[238,6987+24])
                                []
                            ]
                        (lib/shape.ml[238,6987+33]..[238,6987+46])
                          Immutable
                          "desc" (lib/shape.ml[238,6987+33]..[238,6987+37])                          core_type (lib/shape.ml[238,6987+39]..[238,6987+46])
                            Ptyp_constr "nf_desc" (lib/shape.ml[238,6987+39]..[238,6987+46])
                            []
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
                type_declaration "nf_desc" (lib/shape.ml[239,7036+6]..[239,7036+13]) (lib/shape.ml[239,7036+2]..[247,7244+24])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (lib/shape.ml[240,7052+4]..[240,7052+17])
                          "NVar" (lib/shape.ml[240,7052+6]..[240,7052+10])
                          [
                            core_type (lib/shape.ml[240,7052+14]..[240,7052+17])
                              Ptyp_constr "var" (lib/shape.ml[240,7052+14]..[240,7052+17])
                              []
                          ]
                          None
                        (lib/shape.ml[241,7070+4]..[241,7070+21])
                          "NApp" (lib/shape.ml[241,7070+6]..[241,7070+10])
                          [
                            core_type (lib/shape.ml[241,7070+14]..[241,7070+16])
                              Ptyp_constr "nf" (lib/shape.ml[241,7070+14]..[241,7070+16])
                              []
                            core_type (lib/shape.ml[241,7070+19]..[241,7070+21])
                              Ptyp_constr "nf" (lib/shape.ml[241,7070+19]..[241,7070+21])
                              []
                          ]
                          None
                        (lib/shape.ml[242,7092+4]..[242,7092+46])
                          "NAbs" (lib/shape.ml[242,7092+6]..[242,7092+10])
                          [
                            core_type (lib/shape.ml[242,7092+14]..[242,7092+23])
                              Ptyp_constr "local_env" (lib/shape.ml[242,7092+14]..[242,7092+23])
                              []
                            core_type (lib/shape.ml[242,7092+26]..[242,7092+29])
                              Ptyp_constr "var" (lib/shape.ml[242,7092+26]..[242,7092+29])
                              []
                            core_type (lib/shape.ml[242,7092+32]..[242,7092+33])
                              Ptyp_constr "t" (lib/shape.ml[242,7092+32]..[242,7092+33])
                              []
                            core_type (lib/shape.ml[242,7092+36]..[242,7092+46])
                              Ptyp_constr "delayed_nf" (lib/shape.ml[242,7092+36]..[242,7092+46])
                              []
                          ]
                          None
                        (lib/shape.ml[243,7139+4]..[243,7139+38])
                          "NStruct" (lib/shape.ml[243,7139+6]..[243,7139+13])
                          [
                            core_type (lib/shape.ml[243,7139+17]..[243,7139+38])
                              Ptyp_constr "Item.Map.t" (lib/shape.ml[243,7139+28]..[243,7139+38])
                              [
                                core_type (lib/shape.ml[243,7139+17]..[243,7139+27])
                                  Ptyp_constr "delayed_nf" (lib/shape.ml[243,7139+17]..[243,7139+27])
                                  []
                              ]
                          ]
                          None
                        (lib/shape.ml[244,7178+4]..[244,7178+26])
                          "NProj" (lib/shape.ml[244,7178+6]..[244,7178+11])
                          [
                            core_type (lib/shape.ml[244,7178+15]..[244,7178+17])
                              Ptyp_constr "nf" (lib/shape.ml[244,7178+15]..[244,7178+17])
                              []
                            core_type (lib/shape.ml[244,7178+20]..[244,7178+26])
                              Ptyp_constr "Item.t" (lib/shape.ml[244,7178+20]..[244,7178+26])
                              []
                          ]
                          None
                        (lib/shape.ml[245,7205+4]..[245,7205+11])
                          "NLeaf" (lib/shape.ml[245,7205+6]..[245,7205+11])
                          []
                          None
                        (lib/shape.ml[246,7217+4]..[246,7217+26])
                          "NComp_unit" (lib/shape.ml[246,7217+6]..[246,7217+16])
                          [
                            core_type (lib/shape.ml[246,7217+20]..[246,7217+26])
                              Ptyp_constr "string" (lib/shape.ml[246,7217+20]..[246,7217+26])
                              []
                          ]
                          None
                        (lib/shape.ml[247,7244+4]..[247,7244+24])
                          "NoFuelLeft" (lib/shape.ml[247,7244+6]..[247,7244+16])
                          [
                            core_type (lib/shape.ml[247,7244+20]..[247,7244+24])
                              Ptyp_constr "desc" (lib/shape.ml[247,7244+20]..[247,7244+24])
                              []
                          ]
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
                type_declaration "delayed_nf" (lib/shape.ml[266,8118+6]..[266,8118+16]) (lib/shape.ml[266,8118+2]..[266,8118+41])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_variant
                      [
                        (lib/shape.ml[266,8118+19]..[266,8118+41])
                          "Thunk" (lib/shape.ml[266,8118+19]..[266,8118+24])
                          [
                            core_type (lib/shape.ml[266,8118+28]..[266,8118+37])
                              Ptyp_constr "local_env" (lib/shape.ml[266,8118+28]..[266,8118+37])
                              []
                            core_type (lib/shape.ml[266,8118+40]..[266,8118+41])
                              Ptyp_constr "t" (lib/shape.ml[266,8118+40]..[266,8118+41])
                              []
                          ]
                          None
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
                type_declaration "local_env" (lib/shape.ml[268,8161+6]..[268,8161+15]) (lib/shape.ml[268,8161+2]..[268,8161+47])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (lib/shape.ml[268,8161+18]..[268,8161+47])
                        Ptyp_constr "Ident.Map.t" (lib/shape.ml[268,8161+36]..[268,8161+47])
                        [
                          core_type (lib/shape.ml[268,8161+18]..[268,8161+35])
                            Ptyp_constr "option" (lib/shape.ml[268,8161+29]..[268,8161+35])
                            [
                              core_type (lib/shape.ml[268,8161+18]..[268,8161+28])
                                Ptyp_constr "delayed_nf" (lib/shape.ml[268,8161+18]..[268,8161+28])
                                []
                            ]
                        ]
              ]
            structure_item (lib/shape.ml[274,8483+2]..[277,8558+29])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[274,8483+6]..[274,8483+17])
                    Ppat_var "improve_uid" (lib/shape.ml[274,8483+6]..[274,8483+17])
                  expression (lib/shape.ml[274,8483+18]..[277,8558+29]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[274,8483+18]..[274,8483+21])
                        Nolabel
                        None
                        pattern (lib/shape.ml[274,8483+18]..[274,8483+21])
                          Ppat_var "uid" (lib/shape.ml[274,8483+18]..[274,8483+21])
                      Pparam_val (lib/shape.ml[274,8483+22]..[274,8483+31])
                        Nolabel
                        None
                        pattern (lib/shape.ml[274,8483+22]..[274,8483+31])
                          Ppat_constraint
                          pattern (lib/shape.ml[274,8483+23]..[274,8483+25])
                            Ppat_var "nf" (lib/shape.ml[274,8483+23]..[274,8483+25])
                          core_type (lib/shape.ml[274,8483+28]..[274,8483+30])
                            Ptyp_constr "nf" (lib/shape.ml[274,8483+28]..[274,8483+30])
                            []
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[275,8517+4]..[277,8558+29])
                        Pexp_match
                        expression (lib/shape.ml[275,8517+10]..[275,8517+16])
                          Pexp_field
                          expression (lib/shape.ml[275,8517+10]..[275,8517+12])
                            Pexp_ident "nf" (lib/shape.ml[275,8517+10]..[275,8517+12])
                          "uid" (lib/shape.ml[275,8517+13]..[275,8517+16])
                        [
                          <case>
                            pattern (lib/shape.ml[276,8539+6]..[276,8539+12])
                              Ppat_construct "Some" (lib/shape.ml[276,8539+6]..[276,8539+10])
                              Some
                                []
                                pattern (lib/shape.ml[276,8539+11]..[276,8539+12])
                                  Ppat_any
                            expression (lib/shape.ml[276,8539+16]..[276,8539+18])
                              Pexp_ident "nf" (lib/shape.ml[276,8539+16]..[276,8539+18])
                          <case>
                            pattern (lib/shape.ml[277,8558+6]..[277,8558+10])
                              Ppat_construct "None" (lib/shape.ml[277,8558+6]..[277,8558+10])
                              None
                            expression (lib/shape.ml[277,8558+14]..[277,8558+29])
                              Pexp_record
                              [
                                "uid" (lib/shape.ml[277,8558+24]..[277,8558+27]) ghost
                                  expression (lib/shape.ml[277,8558+24]..[277,8558+27])
                                    Pexp_ident "uid" (lib/shape.ml[277,8558+24]..[277,8558+27])
                              ]
                              Some
                                expression (lib/shape.ml[277,8558+16]..[277,8558+18])
                                  Pexp_ident "nf" (lib/shape.ml[277,8558+16]..[277,8558+18])
                        ]
              ]
            structure_item (lib/shape.ml[279,8589+2]..[285,8807+11])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[279,8589+6]..[279,8589+19])
                    Ppat_var "in_memo_table" (lib/shape.ml[279,8589+6]..[279,8589+19])
                  expression (lib/shape.ml[279,8589+20]..[285,8807+11]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[279,8589+20]..[279,8589+30])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8589+20]..[279,8589+30])
                          Ppat_var "memo_table" (lib/shape.ml[279,8589+20]..[279,8589+30])
                      Pparam_val (lib/shape.ml[279,8589+31]..[279,8589+39])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8589+31]..[279,8589+39])
                          Ppat_var "memo_key" (lib/shape.ml[279,8589+31]..[279,8589+39])
                      Pparam_val (lib/shape.ml[279,8589+40]..[279,8589+41])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8589+40]..[279,8589+41])
                          Ppat_var "f" (lib/shape.ml[279,8589+40]..[279,8589+41])
                      Pparam_val (lib/shape.ml[279,8589+42]..[279,8589+45])
                        Nolabel
                        None
                        pattern (lib/shape.ml[279,8589+42]..[279,8589+45])
                          Ppat_var "arg" (lib/shape.ml[279,8589+42]..[279,8589+45])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[280,8637+4]..[285,8807+11])
                        Pexp_match
                        expression (lib/shape.ml[280,8637+10]..[280,8637+42])
                          Pexp_apply
                          expression (lib/shape.ml[280,8637+10]..[280,8637+22])
                            Pexp_ident "Hashtbl.find" (lib/shape.ml[280,8637+10]..[280,8637+22])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[280,8637+23]..[280,8637+33])
                                Pexp_ident "memo_table" (lib/shape.ml[280,8637+23]..[280,8637+33])
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[280,8637+34]..[280,8637+42])
                                Pexp_ident "memo_key" (lib/shape.ml[280,8637+34]..[280,8637+42])
                          ]
                        [
                          <case>
                            pattern (lib/shape.ml[281,8685+6]..[281,8685+9])
                              Ppat_var "res" (lib/shape.ml[281,8685+6]..[281,8685+9])
                            expression (lib/shape.ml[281,8685+13]..[281,8685+16])
                              Pexp_ident "res" (lib/shape.ml[281,8685+13]..[281,8685+16])
                          <case>
                            pattern (lib/shape.ml[282,8702+6]..[282,8702+25])
                              Ppat_exception
                              pattern (lib/shape.ml[282,8702+16]..[282,8702+25])
                                Ppat_construct "Not_found" (lib/shape.ml[282,8702+16]..[282,8702+25])
                                None
                            expression (lib/shape.ml[283,8731+8]..[285,8807+11])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[283,8731+12]..[283,8731+15])
                                    Ppat_var "res" (lib/shape.ml[283,8731+12]..[283,8731+15])
                                  expression (lib/shape.ml[283,8731+18]..[283,8731+23])
                                    Pexp_apply
                                    expression (lib/shape.ml[283,8731+18]..[283,8731+19])
                                      Pexp_ident "f" (lib/shape.ml[283,8731+18]..[283,8731+19])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[283,8731+20]..[283,8731+23])
                                          Pexp_ident "arg" (lib/shape.ml[283,8731+20]..[283,8731+23])
                                    ]
                              ]
                              expression (lib/shape.ml[284,8758+8]..[285,8807+11])
                                Pexp_sequence
                                expression (lib/shape.ml[284,8758+8]..[284,8758+47])
                                  Pexp_apply
                                  expression (lib/shape.ml[284,8758+8]..[284,8758+23])
                                    Pexp_ident "Hashtbl.replace" (lib/shape.ml[284,8758+8]..[284,8758+23])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[284,8758+24]..[284,8758+34])
                                        Pexp_ident "memo_table" (lib/shape.ml[284,8758+24]..[284,8758+34])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[284,8758+35]..[284,8758+43])
                                        Pexp_ident "memo_key" (lib/shape.ml[284,8758+35]..[284,8758+43])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[284,8758+44]..[284,8758+47])
                                        Pexp_ident "res" (lib/shape.ml[284,8758+44]..[284,8758+47])
                                  ]
                                expression (lib/shape.ml[285,8807+8]..[285,8807+11])
                                  Pexp_ident "res" (lib/shape.ml[285,8807+8]..[285,8807+11])
                        ]
              ]
            structure_item (lib/shape.ml[287,8820+2]..[293,9007+3])
              Pstr_type Rec
              [
                type_declaration "env" (lib/shape.ml[287,8820+7]..[287,8820+10]) (lib/shape.ml[287,8820+2]..[293,9007+3])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_record
                      [
                        (lib/shape.ml[288,8835+4]..[288,8835+18])
                          Immutable
                          "fuel" (lib/shape.ml[288,8835+4]..[288,8835+8])                          core_type (lib/shape.ml[288,8835+10]..[288,8835+17])
                            Ptyp_constr "ref" (lib/shape.ml[288,8835+14]..[288,8835+17])
                            [
                              core_type (lib/shape.ml[288,8835+10]..[288,8835+13])
                                Ptyp_constr "int" (lib/shape.ml[288,8835+10]..[288,8835+13])
                                []
                            ]
                        (lib/shape.ml[289,8854+4]..[289,8854+27])
                          Immutable
                          "global_env" (lib/shape.ml[289,8854+4]..[289,8854+14])                          core_type (lib/shape.ml[289,8854+16]..[289,8854+26])
                            Ptyp_constr "Params.env" (lib/shape.ml[289,8854+16]..[289,8854+26])
                            []
                        (lib/shape.ml[290,8882+4]..[290,8882+25])
                          Immutable
                          "local_env" (lib/shape.ml[290,8882+4]..[290,8882+13])                          core_type (lib/shape.ml[290,8882+15]..[290,8882+24])
                            Ptyp_constr "local_env" (lib/shape.ml[290,8882+15]..[290,8882+24])
                            []
                        (lib/shape.ml[291,8908+4]..[291,8908+53])
                          Immutable
                          "reduce_memo_table" (lib/shape.ml[291,8908+4]..[291,8908+21])                          core_type (lib/shape.ml[291,8908+23]..[291,8908+52])
                            Ptyp_constr "Hashtbl.t" (lib/shape.ml[291,8908+43]..[291,8908+52])
                            [
                              core_type (lib/shape.ml[291,8908+24]..[291,8908+37])
                                Ptyp_tuple
                                [
                                  core_type (lib/shape.ml[291,8908+24]..[291,8908+33])
                                    Ptyp_constr "local_env" (lib/shape.ml[291,8908+24]..[291,8908+33])
                                    []
                                  core_type (lib/shape.ml[291,8908+36]..[291,8908+37])
                                    Ptyp_constr "t" (lib/shape.ml[291,8908+36]..[291,8908+37])
                                    []
                                ]
                              core_type (lib/shape.ml[291,8908+39]..[291,8908+41])
                                Ptyp_constr "nf" (lib/shape.ml[291,8908+39]..[291,8908+41])
                                []
                            ]
                        (lib/shape.ml[292,8962+4]..[292,8962+44])
                          Immutable
                          "read_back_memo_table" (lib/shape.ml[292,8962+4]..[292,8962+24])                          core_type (lib/shape.ml[292,8962+26]..[292,8962+43])
                            Ptyp_constr "Hashtbl.t" (lib/shape.ml[292,8962+34]..[292,8962+43])
                            [
                              core_type (lib/shape.ml[292,8962+27]..[292,8962+29])
                                Ptyp_constr "nf" (lib/shape.ml[292,8962+27]..[292,8962+29])
                                []
                              core_type (lib/shape.ml[292,8962+31]..[292,8962+32])
                                Ptyp_constr "t" (lib/shape.ml[292,8962+31]..[292,8962+32])
                                []
                            ]
                      ]
                  ptype_private = Public
                  ptype_manifest =
                    None
              ]
            structure_item (lib/shape.ml[295,9012+2]..[296,9039+66])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[295,9012+6]..[295,9012+10])
                    Ppat_var "bind" (lib/shape.ml[295,9012+6]..[295,9012+10])
                  expression (lib/shape.ml[295,9012+11]..[296,9039+66]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[295,9012+11]..[295,9012+14])
                        Nolabel
                        None
                        pattern (lib/shape.ml[295,9012+11]..[295,9012+14])
                          Ppat_var "env" (lib/shape.ml[295,9012+11]..[295,9012+14])
                      Pparam_val (lib/shape.ml[295,9012+15]..[295,9012+18])
                        Nolabel
                        None
                        pattern (lib/shape.ml[295,9012+15]..[295,9012+18])
                          Ppat_var "var" (lib/shape.ml[295,9012+15]..[295,9012+18])
                      Pparam_val (lib/shape.ml[295,9012+19]..[295,9012+24])
                        Nolabel
                        None
                        pattern (lib/shape.ml[295,9012+19]..[295,9012+24])
                          Ppat_var "shape" (lib/shape.ml[295,9012+19]..[295,9012+24])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[296,9039+4]..[296,9039+66])
                        Pexp_record
                        [
                          "local_env" (lib/shape.ml[296,9039+15]..[296,9039+24])
                            expression (lib/shape.ml[296,9039+27]..[296,9039+64])
                              Pexp_apply
                              expression (lib/shape.ml[296,9039+27]..[296,9039+40])
                                Pexp_ident "Ident.Map.add" (lib/shape.ml[296,9039+27]..[296,9039+40])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[296,9039+41]..[296,9039+44])
                                    Pexp_ident "var" (lib/shape.ml[296,9039+41]..[296,9039+44])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[296,9039+45]..[296,9039+50])
                                    Pexp_ident "shape" (lib/shape.ml[296,9039+45]..[296,9039+50])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[296,9039+51]..[296,9039+64])
                                    Pexp_field
                                    expression (lib/shape.ml[296,9039+51]..[296,9039+54])
                                      Pexp_ident "env" (lib/shape.ml[296,9039+51]..[296,9039+54])
                                    "local_env" (lib/shape.ml[296,9039+55]..[296,9039+64])
                              ]
                        ]
                        Some
                          expression (lib/shape.ml[296,9039+6]..[296,9039+9])
                            Pexp_ident "env" (lib/shape.ml[296,9039+6]..[296,9039+9])
              ]
            structure_item (lib/shape.ml[298,9107+2]..[406,13914+30])
              Pstr_value Rec
              [
                <def>
                  pattern (lib/shape.ml[298,9107+10]..[298,9107+17])
                    Ppat_var "reduce_" (lib/shape.ml[298,9107+10]..[298,9107+17])
                  expression (lib/shape.ml[298,9107+18]..[300,9174+65]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[298,9107+18]..[298,9107+21])
                        Nolabel
                        None
                        pattern (lib/shape.ml[298,9107+18]..[298,9107+21])
                          Ppat_var "env" (lib/shape.ml[298,9107+18]..[298,9107+21])
                      Pparam_val (lib/shape.ml[298,9107+22]..[298,9107+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[298,9107+22]..[298,9107+23])
                          Ppat_var "t" (lib/shape.ml[298,9107+22]..[298,9107+23])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[299,9133+4]..[300,9174+65])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[299,9133+8]..[299,9133+16])
                              Ppat_var "memo_key" (lib/shape.ml[299,9133+8]..[299,9133+16])
                            expression (lib/shape.ml[299,9133+19]..[299,9133+37])
                              Pexp_tuple
                              [
                                expression (lib/shape.ml[299,9133+20]..[299,9133+33])
                                  Pexp_field
                                  expression (lib/shape.ml[299,9133+20]..[299,9133+23])
                                    Pexp_ident "env" (lib/shape.ml[299,9133+20]..[299,9133+23])
                                  "local_env" (lib/shape.ml[299,9133+24]..[299,9133+33])
                                expression (lib/shape.ml[299,9133+35]..[299,9133+36])
                                  Pexp_ident "t" (lib/shape.ml[299,9133+35]..[299,9133+36])
                              ]
                        ]
                        expression (lib/shape.ml[300,9174+4]..[300,9174+65])
                          Pexp_apply
                          expression (lib/shape.ml[300,9174+4]..[300,9174+17])
                            Pexp_ident "in_memo_table" (lib/shape.ml[300,9174+4]..[300,9174+17])
                          [
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9174+18]..[300,9174+39])
                                Pexp_field
                                expression (lib/shape.ml[300,9174+18]..[300,9174+21])
                                  Pexp_ident "env" (lib/shape.ml[300,9174+18]..[300,9174+21])
                                "reduce_memo_table" (lib/shape.ml[300,9174+22]..[300,9174+39])
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9174+40]..[300,9174+48])
                                Pexp_ident "memo_key" (lib/shape.ml[300,9174+40]..[300,9174+48])
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9174+49]..[300,9174+63])
                                Pexp_apply
                                expression (lib/shape.ml[300,9174+50]..[300,9174+58])
                                  Pexp_ident "reduce__" (lib/shape.ml[300,9174+50]..[300,9174+58])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[300,9174+59]..[300,9174+62])
                                      Pexp_ident "env" (lib/shape.ml[300,9174+59]..[300,9174+62])
                                ]
                            <arg>
                            Nolabel
                              expression (lib/shape.ml[300,9174+64]..[300,9174+65])
                                Pexp_ident "t" (lib/shape.ml[300,9174+64]..[300,9174+65])
                          ]
                <def>
                  pattern (lib/shape.ml[339,11276+6]..[339,11276+14])
                    Ppat_var "reduce__" (lib/shape.ml[339,11276+6]..[339,11276+14])
                  expression (lib/shape.ml[339,11276+15]..[406,13914+30]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[339,11276+15]..[339,11276+56])
                        Nolabel
                        None
                        pattern (lib/shape.ml[339,11276+15]..[339,11276+56])
                          Ppat_alias "env" (lib/shape.ml[339,11276+52]..[339,11276+55])
                          pattern (lib/shape.ml[339,11276+16]..[339,11276+48])
                            Ppat_record Open
                            [
                              "fuel" (lib/shape.ml[339,11276+17]..[339,11276+21]) ghost
                                pattern (lib/shape.ml[339,11276+17]..[339,11276+21])
                                  Ppat_var "fuel" (lib/shape.ml[339,11276+17]..[339,11276+21])
                              "global_env" (lib/shape.ml[339,11276+23]..[339,11276+33]) ghost
                                pattern (lib/shape.ml[339,11276+23]..[339,11276+33])
                                  Ppat_var "global_env" (lib/shape.ml[339,11276+23]..[339,11276+33])
                              "local_env" (lib/shape.ml[339,11276+35]..[339,11276+44]) ghost
                                pattern (lib/shape.ml[339,11276+35]..[339,11276+44])
                                  Ppat_var "local_env" (lib/shape.ml[339,11276+35]..[339,11276+44])
                            ]
                      Pparam_val (lib/shape.ml[339,11276+57]..[339,11276+64])
                        Nolabel
                        None
                        pattern (lib/shape.ml[339,11276+57]..[339,11276+64])
                          Ppat_constraint
                          pattern (lib/shape.ml[339,11276+58]..[339,11276+59])
                            Ppat_var "t" (lib/shape.ml[339,11276+58]..[339,11276+59])
                          core_type (lib/shape.ml[339,11276+62]..[339,11276+63])
                            Ptyp_constr "t" (lib/shape.ml[339,11276+62]..[339,11276+63])
                            []
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[340,11343+4]..[406,13914+30])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[340,11343+8]..[340,11343+14])
                              Ppat_var "reduce" (lib/shape.ml[340,11343+8]..[340,11343+14])
                            expression (lib/shape.ml[340,11343+15]..[340,11343+36]) ghost
                              Pexp_function
                              [
                                Pparam_val (lib/shape.ml[340,11343+15]..[340,11343+18])
                                  Nolabel
                                  None
                                  pattern (lib/shape.ml[340,11343+15]..[340,11343+18])
                                    Ppat_var "env" (lib/shape.ml[340,11343+15]..[340,11343+18])
                                Pparam_val (lib/shape.ml[340,11343+19]..[340,11343+20])
                                  Nolabel
                                  None
                                  pattern (lib/shape.ml[340,11343+19]..[340,11343+20])
                                    Ppat_var "t" (lib/shape.ml[340,11343+19]..[340,11343+20])
                              ]
                              None
                              Pfunction_body
                                expression (lib/shape.ml[340,11343+23]..[340,11343+36])
                                  Pexp_apply
                                  expression (lib/shape.ml[340,11343+23]..[340,11343+30])
                                    Pexp_ident "reduce_" (lib/shape.ml[340,11343+23]..[340,11343+30])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[340,11343+31]..[340,11343+34])
                                        Pexp_ident "env" (lib/shape.ml[340,11343+31]..[340,11343+34])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[340,11343+35]..[340,11343+36])
                                        Pexp_ident "t" (lib/shape.ml[340,11343+35]..[340,11343+36])
                                  ]
                        ]
                        expression (lib/shape.ml[341,11383+4]..[406,13914+30])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (lib/shape.ml[341,11383+8]..[341,11383+20])
                                Ppat_var "delay_reduce" (lib/shape.ml[341,11383+8]..[341,11383+20])
                              expression (lib/shape.ml[341,11383+21]..[341,11383+53]) ghost
                                Pexp_function
                                [
                                  Pparam_val (lib/shape.ml[341,11383+21]..[341,11383+24])
                                    Nolabel
                                    None
                                    pattern (lib/shape.ml[341,11383+21]..[341,11383+24])
                                      Ppat_var "env" (lib/shape.ml[341,11383+21]..[341,11383+24])
                                  Pparam_val (lib/shape.ml[341,11383+25]..[341,11383+26])
                                    Nolabel
                                    None
                                    pattern (lib/shape.ml[341,11383+25]..[341,11383+26])
                                      Ppat_var "t" (lib/shape.ml[341,11383+25]..[341,11383+26])
                                ]
                                None
                                Pfunction_body
                                  expression (lib/shape.ml[341,11383+29]..[341,11383+53])
                                    Pexp_construct "Thunk" (lib/shape.ml[341,11383+29]..[341,11383+34])
                                    Some
                                      expression (lib/shape.ml[341,11383+35]..[341,11383+53])
                                        Pexp_tuple
                                        [
                                          expression (lib/shape.ml[341,11383+36]..[341,11383+49])
                                            Pexp_field
                                            expression (lib/shape.ml[341,11383+36]..[341,11383+39])
                                              Pexp_ident "env" (lib/shape.ml[341,11383+36]..[341,11383+39])
                                            "local_env" (lib/shape.ml[341,11383+40]..[341,11383+49])
                                          expression (lib/shape.ml[341,11383+51]..[341,11383+52])
                                            Pexp_ident "t" (lib/shape.ml[341,11383+51]..[341,11383+52])
                                        ]
                          ]
                          expression (lib/shape.ml[342,11440+4]..[406,13914+30])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (lib/shape.ml[342,11440+8]..[342,11440+13])
                                  Ppat_var "force" (lib/shape.ml[342,11440+8]..[342,11440+13])
                                expression (lib/shape.ml[342,11440+14]..[343,11479+37]) ghost
                                  Pexp_function
                                  [
                                    Pparam_val (lib/shape.ml[342,11440+14]..[342,11440+36])
                                      Nolabel
                                      None
                                      pattern (lib/shape.ml[342,11440+14]..[342,11440+36])
                                        Ppat_construct "Thunk" (lib/shape.ml[342,11440+15]..[342,11440+20])
                                        Some
                                          []
                                          pattern (lib/shape.ml[342,11440+21]..[342,11440+35])
                                            Ppat_tuple
                                            [
                                              pattern (lib/shape.ml[342,11440+22]..[342,11440+31])
                                                Ppat_var "local_env" (lib/shape.ml[342,11440+22]..[342,11440+31])
                                              pattern (lib/shape.ml[342,11440+33]..[342,11440+34])
                                                Ppat_var "t" (lib/shape.ml[342,11440+33]..[342,11440+34])
                                            ]
                                  ]
                                  None
                                  Pfunction_body
                                    expression (lib/shape.ml[343,11479+6]..[343,11479+37])
                                      Pexp_apply
                                      expression (lib/shape.ml[343,11479+6]..[343,11479+12])
                                        Pexp_ident "reduce" (lib/shape.ml[343,11479+6]..[343,11479+12])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[343,11479+13]..[343,11479+35])
                                            Pexp_record
                                            [
                                              "local_env" (lib/shape.ml[343,11479+24]..[343,11479+33]) ghost
                                                expression (lib/shape.ml[343,11479+24]..[343,11479+33])
                                                  Pexp_ident "local_env" (lib/shape.ml[343,11479+24]..[343,11479+33])
                                            ]
                                            Some
                                              expression (lib/shape.ml[343,11479+15]..[343,11479+18])
                                                Pexp_ident "env" (lib/shape.ml[343,11479+15]..[343,11479+18])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[343,11479+36]..[343,11479+37])
                                            Pexp_ident "t" (lib/shape.ml[343,11479+36]..[343,11479+37])
                                      ]
                            ]
                            expression (lib/shape.ml[344,11520+4]..[406,13914+30])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[344,11520+8]..[344,11520+14])
                                    Ppat_var "return" (lib/shape.ml[344,11520+8]..[344,11520+14])
                                  expression (lib/shape.ml[344,11520+15]..[344,11520+48]) ghost
                                    Pexp_function
                                    [
                                      Pparam_val (lib/shape.ml[344,11520+15]..[344,11520+19])
                                        Nolabel
                                        None
                                        pattern (lib/shape.ml[344,11520+15]..[344,11520+19])
                                          Ppat_var "desc" (lib/shape.ml[344,11520+15]..[344,11520+19])
                                    ]
                                    Some
                                      Pconstraint
                                        core_type (lib/shape.ml[344,11520+22]..[344,11520+24])
                                          Ptyp_constr "nf" (lib/shape.ml[344,11520+22]..[344,11520+24])
                                          []
                                    Pfunction_body
                                      expression (lib/shape.ml[344,11520+27]..[344,11520+48])
                                        Pexp_record
                                        [
                                          "uid" (lib/shape.ml[344,11520+29]..[344,11520+32])
                                            expression (lib/shape.ml[344,11520+35]..[344,11520+40])
                                              Pexp_field
                                              expression (lib/shape.ml[344,11520+35]..[344,11520+36])
                                                Pexp_ident "t" (lib/shape.ml[344,11520+35]..[344,11520+36])
                                              "uid" (lib/shape.ml[344,11520+37]..[344,11520+40])
                                          "desc" (lib/shape.ml[344,11520+42]..[344,11520+46]) ghost
                                            expression (lib/shape.ml[344,11520+42]..[344,11520+46])
                                              Pexp_ident "desc" (lib/shape.ml[344,11520+42]..[344,11520+46])
                                        ]
                                        None
                              ]
                              expression (lib/shape.ml[345,11572+4]..[406,13914+30])
                                Pexp_ifthenelse
                                expression (lib/shape.ml[345,11572+7]..[345,11572+16])
                                  Pexp_apply
                                  expression (lib/shape.ml[345,11572+13]..[345,11572+14])
                                    Pexp_ident "<" (lib/shape.ml[345,11572+13]..[345,11572+14])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[345,11572+7]..[345,11572+12])
                                        Pexp_apply
                                        expression (lib/shape.ml[345,11572+7]..[345,11572+8])
                                          Pexp_ident "!" (lib/shape.ml[345,11572+7]..[345,11572+8])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[345,11572+8]..[345,11572+12])
                                              Pexp_ident "fuel" (lib/shape.ml[345,11572+8]..[345,11572+12])
                                        ]
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[345,11572+15]..[345,11572+16])
                                        Pexp_constant PConst_int (0,None)
                                  ]
                                expression (lib/shape.ml[345,11572+22]..[345,11572+48])
                                  Pexp_apply
                                  expression (lib/shape.ml[345,11572+22]..[345,11572+28])
                                    Pexp_ident "return" (lib/shape.ml[345,11572+22]..[345,11572+28])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[345,11572+29]..[345,11572+48])
                                        Pexp_construct "NoFuelLeft" (lib/shape.ml[345,11572+30]..[345,11572+40])
                                        Some
                                          expression (lib/shape.ml[345,11572+41]..[345,11572+47])
                                            Pexp_field
                                            expression (lib/shape.ml[345,11572+41]..[345,11572+42])
                                              Pexp_ident "t" (lib/shape.ml[345,11572+41]..[345,11572+42])
                                            "desc" (lib/shape.ml[345,11572+43]..[345,11572+47])
                                  ]
                                Some
                                  expression (lib/shape.ml[347,11630+6]..[406,13914+30])
                                    Pexp_match
                                    expression (lib/shape.ml[347,11630+12]..[347,11630+18])
                                      Pexp_field
                                      expression (lib/shape.ml[347,11630+12]..[347,11630+13])
                                        Pexp_ident "t" (lib/shape.ml[347,11630+12]..[347,11630+13])
                                      "desc" (lib/shape.ml[347,11630+14]..[347,11630+18])
                                    [
                                      <case>
                                        pattern (lib/shape.ml[348,11654+8]..[348,11654+27])
                                          Ppat_construct "Comp_unit" (lib/shape.ml[348,11654+8]..[348,11654+17])
                                          Some
                                            []
                                            pattern (lib/shape.ml[348,11654+18]..[348,11654+27])
                                              Ppat_var "unit_name" (lib/shape.ml[348,11654+18]..[348,11654+27])
                                        expression (lib/shape.ml[349,11685+10]..[352,11831+13])
                                          Pexp_match
                                          expression (lib/shape.ml[349,11685+22]..[349,11685+55])
                                            Pexp_apply
                                            expression (lib/shape.ml[349,11685+22]..[349,11685+44])
                                              Pexp_ident "Params.read_unit_shape" (lib/shape.ml[349,11685+22]..[349,11685+44])
                                            [
                                              <arg>
                                              Labelled "unit_name"
                                                expression (lib/shape.ml[349,11685+46]..[349,11685+55])
                                                  Pexp_ident "unit_name" (lib/shape.ml[349,11685+46]..[349,11685+55])
                                            ]
                                          [
                                            <case>
                                              pattern (lib/shape.ml[350,11746+12]..[350,11746+18])
                                                Ppat_construct "Some" (lib/shape.ml[350,11746+12]..[350,11746+16])
                                                Some
                                                  []
                                                  pattern (lib/shape.ml[350,11746+17]..[350,11746+18])
                                                    Ppat_var "t" (lib/shape.ml[350,11746+17]..[350,11746+18])
                                              expression (lib/shape.ml[350,11746+22]..[350,11746+34])
                                                Pexp_apply
                                                expression (lib/shape.ml[350,11746+22]..[350,11746+28])
                                                  Pexp_ident "reduce" (lib/shape.ml[350,11746+22]..[350,11746+28])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[350,11746+29]..[350,11746+32])
                                                      Pexp_ident "env" (lib/shape.ml[350,11746+29]..[350,11746+32])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[350,11746+33]..[350,11746+34])
                                                      Pexp_ident "t" (lib/shape.ml[350,11746+33]..[350,11746+34])
                                                ]
                                            <case>
                                              pattern (lib/shape.ml[351,11781+12]..[351,11781+16])
                                                Ppat_construct "None" (lib/shape.ml[351,11781+12]..[351,11781+16])
                                                None
                                              expression (lib/shape.ml[351,11781+20]..[351,11781+49])
                                                Pexp_apply
                                                expression (lib/shape.ml[351,11781+20]..[351,11781+26])
                                                  Pexp_ident "return" (lib/shape.ml[351,11781+20]..[351,11781+26])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[351,11781+27]..[351,11781+49])
                                                      Pexp_construct "NComp_unit" (lib/shape.ml[351,11781+28]..[351,11781+38])
                                                      Some
                                                        expression (lib/shape.ml[351,11781+39]..[351,11781+48])
                                                          Pexp_ident "unit_name" (lib/shape.ml[351,11781+39]..[351,11781+48])
                                                ]
                                          ]
                                      <case>
                                        pattern (lib/shape.ml[353,11845+8]..[353,11845+19])
                                          Ppat_construct "App" (lib/shape.ml[353,11845+8]..[353,11845+11])
                                          Some
                                            []
                                            pattern (lib/shape.ml[353,11845+11]..[353,11845+19])
                                              Ppat_tuple
                                              [
                                                pattern (lib/shape.ml[353,11845+12]..[353,11845+13])
                                                  Ppat_var "f" (lib/shape.ml[353,11845+12]..[353,11845+13])
                                                pattern (lib/shape.ml[353,11845+15]..[353,11845+18])
                                                  Ppat_var "arg" (lib/shape.ml[353,11845+15]..[353,11845+18])
                                              ]
                                        expression (lib/shape.ml[354,11868+10]..[364,12276+13])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[354,11868+14]..[354,11868+15])
                                                Ppat_var "f" (lib/shape.ml[354,11868+14]..[354,11868+15])
                                              expression (lib/shape.ml[354,11868+18]..[354,11868+30])
                                                Pexp_apply
                                                expression (lib/shape.ml[354,11868+18]..[354,11868+24])
                                                  Pexp_ident "reduce" (lib/shape.ml[354,11868+18]..[354,11868+24])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[354,11868+25]..[354,11868+28])
                                                      Pexp_ident "env" (lib/shape.ml[354,11868+25]..[354,11868+28])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[354,11868+29]..[354,11868+30])
                                                      Pexp_ident "f" (lib/shape.ml[354,11868+29]..[354,11868+30])
                                                ]
                                          ]
                                          expression (lib/shape.ml[355,11902+10]..[364,12276+13])
                                            Pexp_match
                                            expression (lib/shape.ml[355,11902+22]..[355,11902+28])
                                              Pexp_field
                                              expression (lib/shape.ml[355,11902+22]..[355,11902+23])
                                                Pexp_ident "f" (lib/shape.ml[355,11902+22]..[355,11902+23])
                                              "desc" (lib/shape.ml[355,11902+24]..[355,11902+28])
                                            [
                                              <case>
                                                pattern (lib/shape.ml[356,11936+12]..[356,11936+47])
                                                  Ppat_construct "NAbs" (lib/shape.ml[356,11936+12]..[356,11936+16])
                                                  Some
                                                    []
                                                    pattern (lib/shape.ml[356,11936+16]..[356,11936+47])
                                                      Ppat_tuple
                                                      [
                                                        pattern (lib/shape.ml[356,11936+17]..[356,11936+25])
                                                          Ppat_var "clos_env" (lib/shape.ml[356,11936+17]..[356,11936+25])
                                                        pattern (lib/shape.ml[356,11936+27]..[356,11936+30])
                                                          Ppat_var "var" (lib/shape.ml[356,11936+27]..[356,11936+30])
                                                        pattern (lib/shape.ml[356,11936+32]..[356,11936+36])
                                                          Ppat_var "body" (lib/shape.ml[356,11936+32]..[356,11936+36])
                                                        pattern (lib/shape.ml[356,11936+38]..[356,11936+46])
                                                          Ppat_var "_body_nf" (lib/shape.ml[356,11936+38]..[356,11936+46])
                                                      ]
                                                expression (lib/shape.ml[357,11987+14]..[360,12146+34])
                                                  Pexp_let Nonrec
                                                  [
                                                    <def>
                                                      pattern (lib/shape.ml[357,11987+18]..[357,11987+21])
                                                        Ppat_var "arg" (lib/shape.ml[357,11987+18]..[357,11987+21])
                                                      expression (lib/shape.ml[357,11987+24]..[357,11987+44])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[357,11987+24]..[357,11987+36])
                                                          Pexp_ident "delay_reduce" (lib/shape.ml[357,11987+24]..[357,11987+36])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[357,11987+37]..[357,11987+40])
                                                              Pexp_ident "env" (lib/shape.ml[357,11987+37]..[357,11987+40])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[357,11987+41]..[357,11987+44])
                                                              Pexp_ident "arg" (lib/shape.ml[357,11987+41]..[357,11987+44])
                                                        ]
                                                  ]
                                                  expression (lib/shape.ml[358,12035+14]..[360,12146+34])
                                                    Pexp_let Nonrec
                                                    [
                                                      <def>
                                                        pattern (lib/shape.ml[358,12035+18]..[358,12035+21])
                                                          Ppat_var "env" (lib/shape.ml[358,12035+18]..[358,12035+21])
                                                        expression (lib/shape.ml[358,12035+24]..[358,12035+77])
                                                          Pexp_apply
                                                          expression (lib/shape.ml[358,12035+24]..[358,12035+28])
                                                            Pexp_ident "bind" (lib/shape.ml[358,12035+24]..[358,12035+28])
                                                          [
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[358,12035+29]..[358,12035+62])
                                                                Pexp_record
                                                                [
                                                                  "local_env" (lib/shape.ml[358,12035+40]..[358,12035+49])
                                                                    expression (lib/shape.ml[358,12035+52]..[358,12035+60])
                                                                      Pexp_ident "clos_env" (lib/shape.ml[358,12035+52]..[358,12035+60])
                                                                ]
                                                                Some
                                                                  expression (lib/shape.ml[358,12035+31]..[358,12035+34])
                                                                    Pexp_ident "env" (lib/shape.ml[358,12035+31]..[358,12035+34])
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[358,12035+63]..[358,12035+66])
                                                                Pexp_ident "var" (lib/shape.ml[358,12035+63]..[358,12035+66])
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[358,12035+67]..[358,12035+77])
                                                                Pexp_construct "Some" (lib/shape.ml[358,12035+68]..[358,12035+72])
                                                                Some
                                                                  expression (lib/shape.ml[358,12035+73]..[358,12035+76])
                                                                    Pexp_ident "arg" (lib/shape.ml[358,12035+73]..[358,12035+76])
                                                          ]
                                                    ]
                                                    expression (lib/shape.ml[359,12116+14]..[360,12146+34])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[360,12146+14]..[360,12146+16])
                                                        Pexp_ident "|>" (lib/shape.ml[360,12146+14]..[360,12146+16])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[359,12116+14]..[359,12116+29])
                                                            Pexp_apply
                                                            expression (lib/shape.ml[359,12116+14]..[359,12116+20])
                                                              Pexp_ident "reduce" (lib/shape.ml[359,12116+14]..[359,12116+20])
                                                            [
                                                              <arg>
                                                              Nolabel
                                                                expression (lib/shape.ml[359,12116+21]..[359,12116+24])
                                                                  Pexp_ident "env" (lib/shape.ml[359,12116+21]..[359,12116+24])
                                                              <arg>
                                                              Nolabel
                                                                expression (lib/shape.ml[359,12116+25]..[359,12116+29])
                                                                  Pexp_ident "body" (lib/shape.ml[359,12116+25]..[359,12116+29])
                                                            ]
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[360,12146+17]..[360,12146+34])
                                                            Pexp_apply
                                                            expression (lib/shape.ml[360,12146+17]..[360,12146+28])
                                                              Pexp_ident "improve_uid" (lib/shape.ml[360,12146+17]..[360,12146+28])
                                                            [
                                                              <arg>
                                                              Nolabel
                                                                expression (lib/shape.ml[360,12146+29]..[360,12146+34])
                                                                  Pexp_field
                                                                  expression (lib/shape.ml[360,12146+29]..[360,12146+30])
                                                                    Pexp_ident "t" (lib/shape.ml[360,12146+29]..[360,12146+30])
                                                                  "uid" (lib/shape.ml[360,12146+31]..[360,12146+34])
                                                            ]
                                                      ]
                                              <case>
                                                pattern (lib/shape.ml[361,12181+12]..[361,12181+13])
                                                  Ppat_any
                                                expression (lib/shape.ml[362,12198+14]..[363,12240+35])
                                                  Pexp_let Nonrec
                                                  [
                                                    <def>
                                                      pattern (lib/shape.ml[362,12198+18]..[362,12198+21])
                                                        Ppat_var "arg" (lib/shape.ml[362,12198+18]..[362,12198+21])
                                                      expression (lib/shape.ml[362,12198+24]..[362,12198+38])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[362,12198+24]..[362,12198+30])
                                                          Pexp_ident "reduce" (lib/shape.ml[362,12198+24]..[362,12198+30])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[362,12198+31]..[362,12198+34])
                                                              Pexp_ident "env" (lib/shape.ml[362,12198+31]..[362,12198+34])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[362,12198+35]..[362,12198+38])
                                                              Pexp_ident "arg" (lib/shape.ml[362,12198+35]..[362,12198+38])
                                                        ]
                                                  ]
                                                  expression (lib/shape.ml[363,12240+14]..[363,12240+35])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[363,12240+14]..[363,12240+20])
                                                      Pexp_ident "return" (lib/shape.ml[363,12240+14]..[363,12240+20])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[363,12240+21]..[363,12240+35])
                                                          Pexp_construct "NApp" (lib/shape.ml[363,12240+22]..[363,12240+26])
                                                          Some
                                                            expression (lib/shape.ml[363,12240+26]..[363,12240+34])
                                                              Pexp_tuple
                                                              [
                                                                expression (lib/shape.ml[363,12240+27]..[363,12240+28])
                                                                  Pexp_ident "f" (lib/shape.ml[363,12240+27]..[363,12240+28])
                                                                expression (lib/shape.ml[363,12240+30]..[363,12240+33])
                                                                  Pexp_ident "arg" (lib/shape.ml[363,12240+30]..[363,12240+33])
                                                              ]
                                                    ]
                                            ]
                                      <case>
                                        pattern (lib/shape.ml[365,12290+8]..[365,12290+23])
                                          Ppat_construct "Proj" (lib/shape.ml[365,12290+8]..[365,12290+12])
                                          Some
                                            []
                                            pattern (lib/shape.ml[365,12290+12]..[365,12290+23])
                                              Ppat_tuple
                                              [
                                                pattern (lib/shape.ml[365,12290+13]..[365,12290+16])
                                                  Ppat_var "str" (lib/shape.ml[365,12290+13]..[365,12290+16])
                                                pattern (lib/shape.ml[365,12290+18]..[365,12290+22])
                                                  Ppat_var "item" (lib/shape.ml[365,12290+18]..[365,12290+22])
                                              ]
                                        expression (lib/shape.ml[366,12317+10]..[378,12726+13])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[366,12317+14]..[366,12317+17])
                                                Ppat_var "str" (lib/shape.ml[366,12317+14]..[366,12317+17])
                                              expression (lib/shape.ml[366,12317+20]..[366,12317+34])
                                                Pexp_apply
                                                expression (lib/shape.ml[366,12317+20]..[366,12317+26])
                                                  Pexp_ident "reduce" (lib/shape.ml[366,12317+20]..[366,12317+26])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[366,12317+27]..[366,12317+30])
                                                      Pexp_ident "env" (lib/shape.ml[366,12317+27]..[366,12317+30])
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[366,12317+31]..[366,12317+34])
                                                      Pexp_ident "str" (lib/shape.ml[366,12317+31]..[366,12317+34])
                                                ]
                                          ]
                                          expression (lib/shape.ml[367,12355+10]..[378,12726+13])
                                            Pexp_let Nonrec
                                            [
                                              <def>
                                                pattern (lib/shape.ml[367,12355+14]..[367,12355+19])
                                                  Ppat_var "nored" (lib/shape.ml[367,12355+14]..[367,12355+19])
                                                expression (lib/shape.ml[367,12355+20]..[367,12355+50]) ghost
                                                  Pexp_function
                                                  [
                                                    Pparam_val (lib/shape.ml[367,12355+20]..[367,12355+22])
                                                      Nolabel
                                                      None
                                                      pattern (lib/shape.ml[367,12355+20]..[367,12355+22])
                                                        Ppat_construct "()" (lib/shape.ml[367,12355+20]..[367,12355+22])
                                                        None
                                                  ]
                                                  None
                                                  Pfunction_body
                                                    expression (lib/shape.ml[367,12355+25]..[367,12355+50])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[367,12355+25]..[367,12355+31])
                                                        Pexp_ident "return" (lib/shape.ml[367,12355+25]..[367,12355+31])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[367,12355+32]..[367,12355+50])
                                                            Pexp_construct "NProj" (lib/shape.ml[367,12355+33]..[367,12355+38])
                                                            Some
                                                              expression (lib/shape.ml[367,12355+38]..[367,12355+49])
                                                                Pexp_tuple
                                                                [
                                                                  expression (lib/shape.ml[367,12355+39]..[367,12355+42])
                                                                    Pexp_ident "str" (lib/shape.ml[367,12355+39]..[367,12355+42])
                                                                  expression (lib/shape.ml[367,12355+44]..[367,12355+48])
                                                                    Pexp_ident "item" (lib/shape.ml[367,12355+44]..[367,12355+48])
                                                                ]
                                                      ]
                                            ]
                                            expression (lib/shape.ml[368,12409+10]..[378,12726+13])
                                              Pexp_match
                                              expression (lib/shape.ml[368,12409+22]..[368,12409+30])
                                                Pexp_field
                                                expression (lib/shape.ml[368,12409+22]..[368,12409+25])
                                                  Pexp_ident "str" (lib/shape.ml[368,12409+22]..[368,12409+25])
                                                "desc" (lib/shape.ml[368,12409+26]..[368,12409+30])
                                              [
                                                <case>
                                                  pattern (lib/shape.ml[369,12445+12]..[369,12445+27])
                                                    Ppat_construct "NStruct" (lib/shape.ml[369,12445+12]..[369,12445+19])
                                                    Some
                                                      []
                                                      pattern (lib/shape.ml[369,12445+20]..[369,12445+27])
                                                        Ppat_var "items" (lib/shape.ml[369,12445+21]..[369,12445+26])
                                                  expression (lib/shape.ml[370,12476+14]..[375,12668+17])
                                                    Pexp_match
                                                    expression (lib/shape.ml[370,12476+26]..[370,12476+50])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[370,12476+26]..[370,12476+39])
                                                        Pexp_ident "Item.Map.find" (lib/shape.ml[370,12476+26]..[370,12476+39])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[370,12476+40]..[370,12476+44])
                                                            Pexp_ident "item" (lib/shape.ml[370,12476+40]..[370,12476+44])
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[370,12476+45]..[370,12476+50])
                                                            Pexp_ident "items" (lib/shape.ml[370,12476+45]..[370,12476+50])
                                                      ]
                                                    [
                                                      <case>
                                                        pattern (lib/shape.ml[371,12532+16]..[371,12532+35])
                                                          Ppat_exception
                                                          pattern (lib/shape.ml[371,12532+26]..[371,12532+35])
                                                            Ppat_construct "Not_found" (lib/shape.ml[371,12532+26]..[371,12532+35])
                                                            None
                                                        expression (lib/shape.ml[371,12532+39]..[371,12532+47])
                                                          Pexp_apply
                                                          expression (lib/shape.ml[371,12532+39]..[371,12532+44])
                                                            Pexp_ident "nored" (lib/shape.ml[371,12532+39]..[371,12532+44])
                                                          [
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[371,12532+45]..[371,12532+47])
                                                                Pexp_construct "()" (lib/shape.ml[371,12532+45]..[371,12532+47])
                                                                None
                                                          ]
                                                      <case>
                                                        pattern (lib/shape.ml[372,12580+16]..[372,12580+18])
                                                          Ppat_var "nf" (lib/shape.ml[372,12580+16]..[372,12580+18])
                                                        expression (lib/shape.ml[373,12602+18]..[374,12629+38])
                                                          Pexp_apply
                                                          expression (lib/shape.ml[374,12629+18]..[374,12629+20])
                                                            Pexp_ident "|>" (lib/shape.ml[374,12629+18]..[374,12629+20])
                                                          [
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[373,12602+18]..[373,12602+26])
                                                                Pexp_apply
                                                                expression (lib/shape.ml[373,12602+18]..[373,12602+23])
                                                                  Pexp_ident "force" (lib/shape.ml[373,12602+18]..[373,12602+23])
                                                                [
                                                                  <arg>
                                                                  Nolabel
                                                                    expression (lib/shape.ml[373,12602+24]..[373,12602+26])
                                                                      Pexp_ident "nf" (lib/shape.ml[373,12602+24]..[373,12602+26])
                                                                ]
                                                            <arg>
                                                            Nolabel
                                                              expression (lib/shape.ml[374,12629+21]..[374,12629+38])
                                                                Pexp_apply
                                                                expression (lib/shape.ml[374,12629+21]..[374,12629+32])
                                                                  Pexp_ident "improve_uid" (lib/shape.ml[374,12629+21]..[374,12629+32])
                                                                [
                                                                  <arg>
                                                                  Nolabel
                                                                    expression (lib/shape.ml[374,12629+33]..[374,12629+38])
                                                                      Pexp_field
                                                                      expression (lib/shape.ml[374,12629+33]..[374,12629+34])
Pexp_ident "t" (lib/shape.ml[374,12629+33]..[374,12629+34])
                                                                      "uid" (lib/shape.ml[374,12629+35]..[374,12629+38])
                                                                ]
                                                          ]
                                                    ]
                                                <case>
                                                  pattern (lib/shape.ml[376,12686+12]..[376,12686+13])
                                                    Ppat_any
                                                  expression (lib/shape.ml[377,12703+14]..[377,12703+22])
                                                    Pexp_apply
                                                    expression (lib/shape.ml[377,12703+14]..[377,12703+19])
                                                      Pexp_ident "nored" (lib/shape.ml[377,12703+14]..[377,12703+19])
                                                    [
                                                      <arg>
                                                      Nolabel
                                                        expression (lib/shape.ml[377,12703+20]..[377,12703+22])
                                                          Pexp_construct "()" (lib/shape.ml[377,12703+20]..[377,12703+22])
                                                          None
                                                    ]
                                              ]
                                      <case>
                                        pattern (lib/shape.ml[379,12740+8]..[379,12740+22])
                                          Ppat_construct "Abs" (lib/shape.ml[379,12740+8]..[379,12740+11])
                                          Some
                                            []
                                            pattern (lib/shape.ml[379,12740+11]..[379,12740+22])
                                              Ppat_tuple
                                              [
                                                pattern (lib/shape.ml[379,12740+12]..[379,12740+15])
                                                  Ppat_var "var" (lib/shape.ml[379,12740+12]..[379,12740+15])
                                                pattern (lib/shape.ml[379,12740+17]..[379,12740+21])
                                                  Ppat_var "body" (lib/shape.ml[379,12740+17]..[379,12740+21])
                                              ]
                                        expression (lib/shape.ml[380,12766+10]..[381,12831+54])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[380,12766+14]..[380,12766+21])
                                                Ppat_var "body_nf" (lib/shape.ml[380,12766+14]..[380,12766+21])
                                              expression (lib/shape.ml[380,12766+24]..[380,12766+61])
                                                Pexp_apply
                                                expression (lib/shape.ml[380,12766+24]..[380,12766+36])
                                                  Pexp_ident "delay_reduce" (lib/shape.ml[380,12766+24]..[380,12766+36])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[380,12766+37]..[380,12766+56])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[380,12766+38]..[380,12766+42])
                                                        Pexp_ident "bind" (lib/shape.ml[380,12766+38]..[380,12766+42])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[380,12766+43]..[380,12766+46])
                                                            Pexp_ident "env" (lib/shape.ml[380,12766+43]..[380,12766+46])
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[380,12766+47]..[380,12766+50])
                                                            Pexp_ident "var" (lib/shape.ml[380,12766+47]..[380,12766+50])
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[380,12766+51]..[380,12766+55])
                                                            Pexp_construct "None" (lib/shape.ml[380,12766+51]..[380,12766+55])
                                                            None
                                                      ]
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[380,12766+57]..[380,12766+61])
                                                      Pexp_ident "body" (lib/shape.ml[380,12766+57]..[380,12766+61])
                                                ]
                                          ]
                                          expression (lib/shape.ml[381,12831+10]..[381,12831+54])
                                            Pexp_apply
                                            expression (lib/shape.ml[381,12831+10]..[381,12831+16])
                                              Pexp_ident "return" (lib/shape.ml[381,12831+10]..[381,12831+16])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[381,12831+17]..[381,12831+54])
                                                  Pexp_construct "NAbs" (lib/shape.ml[381,12831+18]..[381,12831+22])
                                                  Some
                                                    expression (lib/shape.ml[381,12831+22]..[381,12831+53])
                                                      Pexp_tuple
                                                      [
                                                        expression (lib/shape.ml[381,12831+23]..[381,12831+32])
                                                          Pexp_ident "local_env" (lib/shape.ml[381,12831+23]..[381,12831+32])
                                                        expression (lib/shape.ml[381,12831+34]..[381,12831+37])
                                                          Pexp_ident "var" (lib/shape.ml[381,12831+34]..[381,12831+37])
                                                        expression (lib/shape.ml[381,12831+39]..[381,12831+43])
                                                          Pexp_ident "body" (lib/shape.ml[381,12831+39]..[381,12831+43])
                                                        expression (lib/shape.ml[381,12831+45]..[381,12831+52])
                                                          Pexp_ident "body_nf" (lib/shape.ml[381,12831+45]..[381,12831+52])
                                                      ]
                                            ]
                                      <case>
                                        pattern (lib/shape.ml[382,12886+8]..[382,12886+14])
                                          Ppat_construct "Var" (lib/shape.ml[382,12886+8]..[382,12886+11])
                                          Some
                                            []
                                            pattern (lib/shape.ml[382,12886+12]..[382,12886+14])
                                              Ppat_var "id" (lib/shape.ml[382,12886+12]..[382,12886+14])
                                        expression (lib/shape.ml[383,12904+10]..[402,13794+13])
                                          Pexp_match
                                          expression (lib/shape.ml[383,12904+22]..[383,12904+49])
                                            Pexp_apply
                                            expression (lib/shape.ml[383,12904+22]..[383,12904+36])
                                              Pexp_ident "Ident.Map.find" (lib/shape.ml[383,12904+22]..[383,12904+36])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[383,12904+37]..[383,12904+39])
                                                  Pexp_ident "id" (lib/shape.ml[383,12904+37]..[383,12904+39])
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[383,12904+40]..[383,12904+49])
                                                  Pexp_ident "local_env" (lib/shape.ml[383,12904+40]..[383,12904+49])
                                            ]
                                          [
                                            <case>
                                              pattern (lib/shape.ml[393,13461+12]..[393,13461+16])
                                                Ppat_construct "None" (lib/shape.ml[393,13461+12]..[393,13461+16])
                                                None
                                              expression (lib/shape.ml[393,13461+20]..[393,13461+36])
                                                Pexp_apply
                                                expression (lib/shape.ml[393,13461+20]..[393,13461+26])
                                                  Pexp_ident "return" (lib/shape.ml[393,13461+20]..[393,13461+26])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[393,13461+27]..[393,13461+36])
                                                      Pexp_construct "NVar" (lib/shape.ml[393,13461+28]..[393,13461+32])
                                                      Some
                                                        expression (lib/shape.ml[393,13461+33]..[393,13461+35])
                                                          Pexp_ident "id" (lib/shape.ml[393,13461+33]..[393,13461+35])
                                                ]
                                            <case>
                                              pattern (lib/shape.ml[394,13498+12]..[394,13498+20])
                                                Ppat_construct "Some" (lib/shape.ml[394,13498+12]..[394,13498+16])
                                                Some
                                                  []
                                                  pattern (lib/shape.ml[394,13498+17]..[394,13498+20])
                                                    Ppat_var "def" (lib/shape.ml[394,13498+17]..[394,13498+20])
                                              expression (lib/shape.ml[394,13498+24]..[394,13498+33])
                                                Pexp_apply
                                                expression (lib/shape.ml[394,13498+24]..[394,13498+29])
                                                  Pexp_ident "force" (lib/shape.ml[394,13498+24]..[394,13498+29])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[394,13498+30]..[394,13498+33])
                                                      Pexp_ident "def" (lib/shape.ml[394,13498+30]..[394,13498+33])
                                                ]
                                            <case>
                                              pattern (lib/shape.ml[395,13532+12]..[395,13532+31])
                                                Ppat_exception
                                                pattern (lib/shape.ml[395,13532+22]..[395,13532+31])
                                                  Ppat_construct "Not_found" (lib/shape.ml[395,13532+22]..[395,13532+31])
                                                  None
                                              expression (lib/shape.ml[396,13567+10]..[401,13765+28])
                                                Pexp_match
                                                expression (lib/shape.ml[396,13567+16]..[396,13567+47])
                                                  Pexp_apply
                                                  expression (lib/shape.ml[396,13567+16]..[396,13567+33])
                                                    Pexp_ident "Params.find_shape" (lib/shape.ml[396,13567+16]..[396,13567+33])
                                                  [
                                                    <arg>
                                                    Nolabel
                                                      expression (lib/shape.ml[396,13567+34]..[396,13567+44])
                                                        Pexp_ident "global_env" (lib/shape.ml[396,13567+34]..[396,13567+44])
                                                    <arg>
                                                    Nolabel
                                                      expression (lib/shape.ml[396,13567+45]..[396,13567+47])
                                                        Pexp_ident "id" (lib/shape.ml[396,13567+45]..[396,13567+47])
                                                  ]
                                                [
                                                  <case>
                                                    pattern (lib/shape.ml[397,13620+12]..[397,13620+31])
                                                      Ppat_exception
                                                      pattern (lib/shape.ml[397,13620+22]..[397,13620+31])
                                                        Ppat_construct "Not_found" (lib/shape.ml[397,13620+22]..[397,13620+31])
                                                        None
                                                    expression (lib/shape.ml[397,13620+35]..[397,13620+51])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[397,13620+35]..[397,13620+41])
                                                        Pexp_ident "return" (lib/shape.ml[397,13620+35]..[397,13620+41])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[397,13620+42]..[397,13620+51])
                                                            Pexp_construct "NVar" (lib/shape.ml[397,13620+43]..[397,13620+47])
                                                            Some
                                                              expression (lib/shape.ml[397,13620+48]..[397,13620+50])
                                                                Pexp_ident "id" (lib/shape.ml[397,13620+48]..[397,13620+50])
                                                      ]
                                                  <case>
                                                    pattern (lib/shape.ml[398,13672+12]..[398,13672+15])
                                                      Ppat_var "res" (lib/shape.ml[398,13672+12]..[398,13672+15])
                                                    <when>
                                                      expression (lib/shape.ml[398,13672+21]..[398,13672+28])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[398,13672+25]..[398,13672+26])
                                                          Pexp_ident "=" (lib/shape.ml[398,13672+25]..[398,13672+26])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[398,13672+21]..[398,13672+24])
                                                              Pexp_ident "res" (lib/shape.ml[398,13672+21]..[398,13672+24])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[398,13672+27]..[398,13672+28])
                                                              Pexp_ident "t" (lib/shape.ml[398,13672+27]..[398,13672+28])
                                                        ]
                                                    expression (lib/shape.ml[398,13672+32]..[398,13672+48])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[398,13672+32]..[398,13672+38])
                                                        Pexp_ident "return" (lib/shape.ml[398,13672+32]..[398,13672+38])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[398,13672+39]..[398,13672+48])
                                                            Pexp_construct "NVar" (lib/shape.ml[398,13672+40]..[398,13672+44])
                                                            Some
                                                              expression (lib/shape.ml[398,13672+45]..[398,13672+47])
                                                                Pexp_ident "id" (lib/shape.ml[398,13672+45]..[398,13672+47])
                                                      ]
                                                  <case>
                                                    pattern (lib/shape.ml[399,13721+12]..[399,13721+15])
                                                      Ppat_var "res" (lib/shape.ml[399,13721+12]..[399,13721+15])
                                                    expression (lib/shape.ml[400,13740+14]..[401,13765+28])
                                                      Pexp_sequence
                                                      expression (lib/shape.ml[400,13740+14]..[400,13740+23])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[400,13740+14]..[400,13740+18])
                                                          Pexp_ident "decr" (lib/shape.ml[400,13740+14]..[400,13740+18])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[400,13740+19]..[400,13740+23])
                                                              Pexp_ident "fuel" (lib/shape.ml[400,13740+19]..[400,13740+23])
                                                        ]
                                                      expression (lib/shape.ml[401,13765+14]..[401,13765+28])
                                                        Pexp_apply
                                                        expression (lib/shape.ml[401,13765+14]..[401,13765+20])
                                                          Pexp_ident "reduce" (lib/shape.ml[401,13765+14]..[401,13765+20])
                                                        [
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[401,13765+21]..[401,13765+24])
                                                              Pexp_ident "env" (lib/shape.ml[401,13765+21]..[401,13765+24])
                                                          <arg>
                                                          Nolabel
                                                            expression (lib/shape.ml[401,13765+25]..[401,13765+28])
                                                              Pexp_ident "res" (lib/shape.ml[401,13765+25]..[401,13765+28])
                                                        ]
                                                ]
                                          ]
                                      <case>
                                        pattern (lib/shape.ml[403,13808+8]..[403,13808+12])
                                          Ppat_construct "Leaf" (lib/shape.ml[403,13808+8]..[403,13808+12])
                                          None
                                        expression (lib/shape.ml[403,13808+16]..[403,13808+28])
                                          Pexp_apply
                                          expression (lib/shape.ml[403,13808+16]..[403,13808+22])
                                            Pexp_ident "return" (lib/shape.ml[403,13808+16]..[403,13808+22])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[403,13808+23]..[403,13808+28])
                                                Pexp_construct "NLeaf" (lib/shape.ml[403,13808+23]..[403,13808+28])
                                                None
                                          ]
                                      <case>
                                        pattern (lib/shape.ml[404,13837+8]..[404,13837+16])
                                          Ppat_construct "Struct" (lib/shape.ml[404,13837+8]..[404,13837+14])
                                          Some
                                            []
                                            pattern (lib/shape.ml[404,13837+15]..[404,13837+16])
                                              Ppat_var "m" (lib/shape.ml[404,13837+15]..[404,13837+16])
                                        expression (lib/shape.ml[405,13857+10]..[406,13914+30])
                                          Pexp_let Nonrec
                                          [
                                            <def>
                                              pattern (lib/shape.ml[405,13857+14]..[405,13857+17])
                                                Ppat_var "mnf" (lib/shape.ml[405,13857+14]..[405,13857+17])
                                              expression (lib/shape.ml[405,13857+20]..[405,13857+53])
                                                Pexp_apply
                                                expression (lib/shape.ml[405,13857+20]..[405,13857+32])
                                                  Pexp_ident "Item.Map.map" (lib/shape.ml[405,13857+20]..[405,13857+32])
                                                [
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[405,13857+33]..[405,13857+51])
                                                      Pexp_apply
                                                      expression (lib/shape.ml[405,13857+34]..[405,13857+46])
                                                        Pexp_ident "delay_reduce" (lib/shape.ml[405,13857+34]..[405,13857+46])
                                                      [
                                                        <arg>
                                                        Nolabel
                                                          expression (lib/shape.ml[405,13857+47]..[405,13857+50])
                                                            Pexp_ident "env" (lib/shape.ml[405,13857+47]..[405,13857+50])
                                                      ]
                                                  <arg>
                                                  Nolabel
                                                    expression (lib/shape.ml[405,13857+52]..[405,13857+53])
                                                      Pexp_ident "m" (lib/shape.ml[405,13857+52]..[405,13857+53])
                                                ]
                                          ]
                                          expression (lib/shape.ml[406,13914+10]..[406,13914+30])
                                            Pexp_apply
                                            expression (lib/shape.ml[406,13914+10]..[406,13914+16])
                                              Pexp_ident "return" (lib/shape.ml[406,13914+10]..[406,13914+16])
                                            [
                                              <arg>
                                              Nolabel
                                                expression (lib/shape.ml[406,13914+17]..[406,13914+30])
                                                  Pexp_construct "NStruct" (lib/shape.ml[406,13914+18]..[406,13914+25])
                                                  Some
                                                    expression (lib/shape.ml[406,13914+26]..[406,13914+29])
                                                      Pexp_ident "mnf" (lib/shape.ml[406,13914+26]..[406,13914+29])
                                            ]
                                    ]
              ]
            structure_item (lib/shape.ml[408,13946+2]..[435,14934+23])
              Pstr_value Rec
              [
                <def>
                  pattern (lib/shape.ml[408,13946+10]..[408,13946+19])
                    Ppat_var "read_back" (lib/shape.ml[408,13946+10]..[408,13946+19])
                  expression (lib/shape.ml[408,13946+20]..[409,13986+65]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[408,13946+20]..[408,13946+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[408,13946+20]..[408,13946+23])
                          Ppat_var "env" (lib/shape.ml[408,13946+20]..[408,13946+23])
                      Pparam_val (lib/shape.ml[408,13946+24]..[408,13946+33])
                        Nolabel
                        None
                        pattern (lib/shape.ml[408,13946+24]..[408,13946+33])
                          Ppat_constraint
                          pattern (lib/shape.ml[408,13946+25]..[408,13946+27])
                            Ppat_var "nf" (lib/shape.ml[408,13946+25]..[408,13946+27])
                          core_type (lib/shape.ml[408,13946+30]..[408,13946+32])
                            Ptyp_constr "nf" (lib/shape.ml[408,13946+30]..[408,13946+32])
                            []
                    ]
                    Some
                      Pconstraint
                        core_type (lib/shape.ml[408,13946+36]..[408,13946+37])
                          Ptyp_constr "t" (lib/shape.ml[408,13946+36]..[408,13946+37])
                          []
                    Pfunction_body
                      expression (lib/shape.ml[409,13986+4]..[409,13986+65])
                        Pexp_apply
                        expression (lib/shape.ml[409,13986+4]..[409,13986+17])
                          Pexp_ident "in_memo_table" (lib/shape.ml[409,13986+4]..[409,13986+17])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13986+18]..[409,13986+42])
                              Pexp_field
                              expression (lib/shape.ml[409,13986+18]..[409,13986+21])
                                Pexp_ident "env" (lib/shape.ml[409,13986+18]..[409,13986+21])
                              "read_back_memo_table" (lib/shape.ml[409,13986+22]..[409,13986+42])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13986+43]..[409,13986+45])
                              Pexp_ident "nf" (lib/shape.ml[409,13986+43]..[409,13986+45])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13986+46]..[409,13986+62])
                              Pexp_apply
                              expression (lib/shape.ml[409,13986+47]..[409,13986+57])
                                Pexp_ident "read_back_" (lib/shape.ml[409,13986+47]..[409,13986+57])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[409,13986+58]..[409,13986+61])
                                    Pexp_ident "env" (lib/shape.ml[409,13986+58]..[409,13986+61])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[409,13986+63]..[409,13986+65])
                              Pexp_ident "nf" (lib/shape.ml[409,13986+63]..[409,13986+65])
                        ]
                <def>
                  pattern (lib/shape.ml[415,14291+6]..[415,14291+16])
                    Ppat_var "read_back_" (lib/shape.ml[415,14291+6]..[415,14291+16])
                  expression (lib/shape.ml[415,14291+17]..[416,14328+55]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[415,14291+17]..[415,14291+20])
                        Nolabel
                        None
                        pattern (lib/shape.ml[415,14291+17]..[415,14291+20])
                          Ppat_var "env" (lib/shape.ml[415,14291+17]..[415,14291+20])
                      Pparam_val (lib/shape.ml[415,14291+21]..[415,14291+30])
                        Nolabel
                        None
                        pattern (lib/shape.ml[415,14291+21]..[415,14291+30])
                          Ppat_constraint
                          pattern (lib/shape.ml[415,14291+22]..[415,14291+24])
                            Ppat_var "nf" (lib/shape.ml[415,14291+22]..[415,14291+24])
                          core_type (lib/shape.ml[415,14291+27]..[415,14291+29])
                            Ptyp_constr "nf" (lib/shape.ml[415,14291+27]..[415,14291+29])
                            []
                    ]
                    Some
                      Pconstraint
                        core_type (lib/shape.ml[415,14291+33]..[415,14291+34])
                          Ptyp_constr "t" (lib/shape.ml[415,14291+33]..[415,14291+34])
                          []
                    Pfunction_body
                      expression (lib/shape.ml[416,14328+4]..[416,14328+55])
                        Pexp_record
                        [
                          "uid" (lib/shape.ml[416,14328+6]..[416,14328+9])
                            expression (lib/shape.ml[416,14328+12]..[416,14328+18])
                              Pexp_field
                              expression (lib/shape.ml[416,14328+12]..[416,14328+14])
                                Pexp_ident "nf" (lib/shape.ml[416,14328+12]..[416,14328+14])
                              "uid" (lib/shape.ml[416,14328+15]..[416,14328+18])
                          "desc" (lib/shape.ml[416,14328+20]..[416,14328+24])
                            expression (lib/shape.ml[416,14328+27]..[416,14328+53])
                              Pexp_apply
                              expression (lib/shape.ml[416,14328+27]..[416,14328+41])
                                Pexp_ident "read_back_desc" (lib/shape.ml[416,14328+27]..[416,14328+41])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[416,14328+42]..[416,14328+45])
                                    Pexp_ident "env" (lib/shape.ml[416,14328+42]..[416,14328+45])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[416,14328+46]..[416,14328+53])
                                    Pexp_field
                                    expression (lib/shape.ml[416,14328+46]..[416,14328+48])
                                      Pexp_ident "nf" (lib/shape.ml[416,14328+46]..[416,14328+48])
                                    "desc" (lib/shape.ml[416,14328+49]..[416,14328+53])
                              ]
                        ]
                        None
                <def>
                  pattern (lib/shape.ml[418,14385+6]..[418,14385+20])
                    Ppat_var "read_back_desc" (lib/shape.ml[418,14385+6]..[418,14385+20])
                  expression (lib/shape.ml[418,14385+21]..[435,14934+23]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[418,14385+21]..[418,14385+24])
                        Nolabel
                        None
                        pattern (lib/shape.ml[418,14385+21]..[418,14385+24])
                          Ppat_var "env" (lib/shape.ml[418,14385+21]..[418,14385+24])
                      Pparam_val (lib/shape.ml[418,14385+25]..[418,14385+29])
                        Nolabel
                        None
                        pattern (lib/shape.ml[418,14385+25]..[418,14385+29])
                          Ppat_var "desc" (lib/shape.ml[418,14385+25]..[418,14385+29])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[419,14417+4]..[435,14934+23])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[419,14417+8]..[419,14417+17])
                              Ppat_var "read_back" (lib/shape.ml[419,14417+8]..[419,14417+17])
                            expression (lib/shape.ml[419,14417+18]..[419,14417+39]) ghost
                              Pexp_function
                              [
                                Pparam_val (lib/shape.ml[419,14417+18]..[419,14417+20])
                                  Nolabel
                                  None
                                  pattern (lib/shape.ml[419,14417+18]..[419,14417+20])
                                    Ppat_var "nf" (lib/shape.ml[419,14417+18]..[419,14417+20])
                              ]
                              None
                              Pfunction_body
                                expression (lib/shape.ml[419,14417+23]..[419,14417+39])
                                  Pexp_apply
                                  expression (lib/shape.ml[419,14417+23]..[419,14417+32])
                                    Pexp_ident "read_back" (lib/shape.ml[419,14417+23]..[419,14417+32])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[419,14417+33]..[419,14417+36])
                                        Pexp_ident "env" (lib/shape.ml[419,14417+33]..[419,14417+36])
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[419,14417+37]..[419,14417+39])
                                        Pexp_ident "nf" (lib/shape.ml[419,14417+37]..[419,14417+39])
                                  ]
                        ]
                        expression (lib/shape.ml[420,14460+4]..[435,14934+23])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (lib/shape.ml[420,14460+8]..[420,14460+23])
                                Ppat_var "read_back_force" (lib/shape.ml[420,14460+8]..[420,14460+23])
                              expression (lib/shape.ml[420,14460+24]..[421,14509+50]) ghost
                                Pexp_function
                                [
                                  Pparam_val (lib/shape.ml[420,14460+24]..[420,14460+46])
                                    Nolabel
                                    None
                                    pattern (lib/shape.ml[420,14460+24]..[420,14460+46])
                                      Ppat_construct "Thunk" (lib/shape.ml[420,14460+25]..[420,14460+30])
                                      Some
                                        []
                                        pattern (lib/shape.ml[420,14460+31]..[420,14460+45])
                                          Ppat_tuple
                                          [
                                            pattern (lib/shape.ml[420,14460+32]..[420,14460+41])
                                              Ppat_var "local_env" (lib/shape.ml[420,14460+32]..[420,14460+41])
                                            pattern (lib/shape.ml[420,14460+43]..[420,14460+44])
                                              Ppat_var "t" (lib/shape.ml[420,14460+43]..[420,14460+44])
                                          ]
                                ]
                                None
                                Pfunction_body
                                  expression (lib/shape.ml[421,14509+6]..[421,14509+50])
                                    Pexp_apply
                                    expression (lib/shape.ml[421,14509+6]..[421,14509+15])
                                      Pexp_ident "read_back" (lib/shape.ml[421,14509+6]..[421,14509+15])
                                    [
                                      <arg>
                                      Nolabel
                                        expression (lib/shape.ml[421,14509+16]..[421,14509+50])
                                          Pexp_apply
                                          expression (lib/shape.ml[421,14509+17]..[421,14509+24])
                                            Pexp_ident "reduce_" (lib/shape.ml[421,14509+17]..[421,14509+24])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[421,14509+25]..[421,14509+47])
                                                Pexp_record
                                                [
                                                  "local_env" (lib/shape.ml[421,14509+36]..[421,14509+45]) ghost
                                                    expression (lib/shape.ml[421,14509+36]..[421,14509+45])
                                                      Pexp_ident "local_env" (lib/shape.ml[421,14509+36]..[421,14509+45])
                                                ]
                                                Some
                                                  expression (lib/shape.ml[421,14509+27]..[421,14509+30])
                                                    Pexp_ident "env" (lib/shape.ml[421,14509+27]..[421,14509+30])
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[421,14509+48]..[421,14509+49])
                                                Pexp_ident "t" (lib/shape.ml[421,14509+48]..[421,14509+49])
                                          ]
                                    ]
                          ]
                          expression (lib/shape.ml[422,14563+4]..[435,14934+23])
                            Pexp_match
                            expression (lib/shape.ml[422,14563+10]..[422,14563+14])
                              Pexp_ident "desc" (lib/shape.ml[422,14563+10]..[422,14563+14])
                            [
                              <case>
                                pattern (lib/shape.ml[423,14583+6]..[423,14583+12])
                                  Ppat_construct "NVar" (lib/shape.ml[423,14583+6]..[423,14583+10])
                                  Some
                                    []
                                    pattern (lib/shape.ml[423,14583+11]..[423,14583+12])
                                      Ppat_var "v" (lib/shape.ml[423,14583+11]..[423,14583+12])
                                expression (lib/shape.ml[424,14599+8]..[424,14599+13])
                                  Pexp_construct "Var" (lib/shape.ml[424,14599+8]..[424,14599+11])
                                  Some
                                    expression (lib/shape.ml[424,14599+12]..[424,14599+13])
                                      Pexp_ident "v" (lib/shape.ml[424,14599+12]..[424,14599+13])
                              <case>
                                pattern (lib/shape.ml[425,14613+6]..[425,14613+21])
                                  Ppat_construct "NApp" (lib/shape.ml[425,14613+6]..[425,14613+10])
                                  Some
                                    []
                                    pattern (lib/shape.ml[425,14613+11]..[425,14613+21])
                                      Ppat_tuple
                                      [
                                        pattern (lib/shape.ml[425,14613+12]..[425,14613+15])
                                          Ppat_var "nft" (lib/shape.ml[425,14613+12]..[425,14613+15])
                                        pattern (lib/shape.ml[425,14613+17]..[425,14613+20])
                                          Ppat_var "nfu" (lib/shape.ml[425,14613+17]..[425,14613+20])
                                      ]
                                expression (lib/shape.ml[426,14638+8]..[426,14638+41])
                                  Pexp_construct "App" (lib/shape.ml[426,14638+8]..[426,14638+11])
                                  Some
                                    expression (lib/shape.ml[426,14638+11]..[426,14638+41])
                                      Pexp_tuple
                                      [
                                        expression (lib/shape.ml[426,14638+12]..[426,14638+25])
                                          Pexp_apply
                                          expression (lib/shape.ml[426,14638+12]..[426,14638+21])
                                            Pexp_ident "read_back" (lib/shape.ml[426,14638+12]..[426,14638+21])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[426,14638+22]..[426,14638+25])
                                                Pexp_ident "nft" (lib/shape.ml[426,14638+22]..[426,14638+25])
                                          ]
                                        expression (lib/shape.ml[426,14638+27]..[426,14638+40])
                                          Pexp_apply
                                          expression (lib/shape.ml[426,14638+27]..[426,14638+36])
                                            Pexp_ident "read_back" (lib/shape.ml[426,14638+27]..[426,14638+36])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[426,14638+37]..[426,14638+40])
                                                Pexp_ident "nfu" (lib/shape.ml[426,14638+37]..[426,14638+40])
                                          ]
                                      ]
                              <case>
                                pattern (lib/shape.ml[427,14680+6]..[427,14680+28])
                                  Ppat_construct "NAbs" (lib/shape.ml[427,14680+6]..[427,14680+10])
                                  Some
                                    []
                                    pattern (lib/shape.ml[427,14680+11]..[427,14680+28])
                                      Ppat_tuple
                                      [
                                        pattern (lib/shape.ml[427,14680+12]..[427,14680+16])
                                          Ppat_var "_env" (lib/shape.ml[427,14680+12]..[427,14680+16])
                                        pattern (lib/shape.ml[427,14680+18]..[427,14680+19])
                                          Ppat_var "x" (lib/shape.ml[427,14680+18]..[427,14680+19])
                                        pattern (lib/shape.ml[427,14680+21]..[427,14680+23])
                                          Ppat_var "_t" (lib/shape.ml[427,14680+21]..[427,14680+23])
                                        pattern (lib/shape.ml[427,14680+25]..[427,14680+27])
                                          Ppat_var "nf" (lib/shape.ml[427,14680+25]..[427,14680+27])
                                      ]
                                expression (lib/shape.ml[428,14712+8]..[428,14712+34])
                                  Pexp_construct "Abs" (lib/shape.ml[428,14712+8]..[428,14712+11])
                                  Some
                                    expression (lib/shape.ml[428,14712+11]..[428,14712+34])
                                      Pexp_tuple
                                      [
                                        expression (lib/shape.ml[428,14712+12]..[428,14712+13])
                                          Pexp_ident "x" (lib/shape.ml[428,14712+12]..[428,14712+13])
                                        expression (lib/shape.ml[428,14712+15]..[428,14712+33])
                                          Pexp_apply
                                          expression (lib/shape.ml[428,14712+15]..[428,14712+30])
                                            Pexp_ident "read_back_force" (lib/shape.ml[428,14712+15]..[428,14712+30])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[428,14712+31]..[428,14712+33])
                                                Pexp_ident "nf" (lib/shape.ml[428,14712+31]..[428,14712+33])
                                          ]
                                      ]
                              <case>
                                pattern (lib/shape.ml[429,14747+6]..[429,14747+18])
                                  Ppat_construct "NStruct" (lib/shape.ml[429,14747+6]..[429,14747+13])
                                  Some
                                    []
                                    pattern (lib/shape.ml[429,14747+14]..[429,14747+18])
                                      Ppat_var "nstr" (lib/shape.ml[429,14747+14]..[429,14747+18])
                                expression (lib/shape.ml[430,14769+8]..[430,14769+50])
                                  Pexp_construct "Struct" (lib/shape.ml[430,14769+8]..[430,14769+14])
                                  Some
                                    expression (lib/shape.ml[430,14769+15]..[430,14769+50])
                                      Pexp_apply
                                      expression (lib/shape.ml[430,14769+16]..[430,14769+28])
                                        Pexp_ident "Item.Map.map" (lib/shape.ml[430,14769+16]..[430,14769+28])
                                      [
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[430,14769+29]..[430,14769+44])
                                            Pexp_ident "read_back_force" (lib/shape.ml[430,14769+29]..[430,14769+44])
                                        <arg>
                                        Nolabel
                                          expression (lib/shape.ml[430,14769+45]..[430,14769+49])
                                            Pexp_ident "nstr" (lib/shape.ml[430,14769+45]..[430,14769+49])
                                      ]
                              <case>
                                pattern (lib/shape.ml[431,14820+6]..[431,14820+22])
                                  Ppat_construct "NProj" (lib/shape.ml[431,14820+6]..[431,14820+11])
                                  Some
                                    []
                                    pattern (lib/shape.ml[431,14820+12]..[431,14820+22])
                                      Ppat_tuple
                                      [
                                        pattern (lib/shape.ml[431,14820+13]..[431,14820+15])
                                          Ppat_var "nf" (lib/shape.ml[431,14820+13]..[431,14820+15])
                                        pattern (lib/shape.ml[431,14820+17]..[431,14820+21])
                                          Ppat_var "item" (lib/shape.ml[431,14820+17]..[431,14820+21])
                                      ]
                                expression (lib/shape.ml[432,14846+8]..[432,14846+33])
                                  Pexp_construct "Proj" (lib/shape.ml[432,14846+8]..[432,14846+12])
                                  Some
                                    expression (lib/shape.ml[432,14846+13]..[432,14846+33])
                                      Pexp_tuple
                                      [
                                        expression (lib/shape.ml[432,14846+14]..[432,14846+26])
                                          Pexp_apply
                                          expression (lib/shape.ml[432,14846+14]..[432,14846+23])
                                            Pexp_ident "read_back" (lib/shape.ml[432,14846+14]..[432,14846+23])
                                          [
                                            <arg>
                                            Nolabel
                                              expression (lib/shape.ml[432,14846+24]..[432,14846+26])
                                                Pexp_ident "nf" (lib/shape.ml[432,14846+24]..[432,14846+26])
                                          ]
                                        expression (lib/shape.ml[432,14846+28]..[432,14846+32])
                                          Pexp_ident "item" (lib/shape.ml[432,14846+28]..[432,14846+32])
                                      ]
                              <case>
                                pattern (lib/shape.ml[433,14880+6]..[433,14880+11])
                                  Ppat_construct "NLeaf" (lib/shape.ml[433,14880+6]..[433,14880+11])
                                  None
                                expression (lib/shape.ml[433,14880+15]..[433,14880+19])
                                  Pexp_construct "Leaf" (lib/shape.ml[433,14880+15]..[433,14880+19])
                                  None
                              <case>
                                pattern (lib/shape.ml[434,14900+6]..[434,14900+18])
                                  Ppat_construct "NComp_unit" (lib/shape.ml[434,14900+6]..[434,14900+16])
                                  Some
                                    []
                                    pattern (lib/shape.ml[434,14900+17]..[434,14900+18])
                                      Ppat_var "s" (lib/shape.ml[434,14900+17]..[434,14900+18])
                                expression (lib/shape.ml[434,14900+22]..[434,14900+33])
                                  Pexp_construct "Comp_unit" (lib/shape.ml[434,14900+22]..[434,14900+31])
                                  Some
                                    expression (lib/shape.ml[434,14900+32]..[434,14900+33])
                                      Pexp_ident "s" (lib/shape.ml[434,14900+32]..[434,14900+33])
                              <case>
                                pattern (lib/shape.ml[435,14934+6]..[435,14934+18])
                                  Ppat_construct "NoFuelLeft" (lib/shape.ml[435,14934+6]..[435,14934+16])
                                  Some
                                    []
                                    pattern (lib/shape.ml[435,14934+17]..[435,14934+18])
                                      Ppat_var "t" (lib/shape.ml[435,14934+17]..[435,14934+18])
                                expression (lib/shape.ml[435,14934+22]..[435,14934+23])
                                  Pexp_ident "t" (lib/shape.ml[435,14934+22]..[435,14934+23])
                            ]
              ]
            structure_item (lib/shape.ml[437,14959+2]..[449,15286+34])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[437,14959+6]..[437,14959+12])
                    Ppat_var "reduce" (lib/shape.ml[437,14959+6]..[437,14959+12])
                  expression (lib/shape.ml[437,14959+13]..[449,15286+34]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[437,14959+13]..[437,14959+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[437,14959+13]..[437,14959+23])
                          Ppat_var "global_env" (lib/shape.ml[437,14959+13]..[437,14959+23])
                      Pparam_val (lib/shape.ml[437,14959+24]..[437,14959+25])
                        Nolabel
                        None
                        pattern (lib/shape.ml[437,14959+24]..[437,14959+25])
                          Ppat_var "t" (lib/shape.ml[437,14959+24]..[437,14959+25])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[438,14987+4]..[449,15286+34])
                        Pexp_let Nonrec
                        [
                          <def>
                            pattern (lib/shape.ml[438,14987+8]..[438,14987+12])
                              Ppat_var "fuel" (lib/shape.ml[438,14987+8]..[438,14987+12])
                            expression (lib/shape.ml[438,14987+15]..[438,14987+30])
                              Pexp_apply
                              expression (lib/shape.ml[438,14987+15]..[438,14987+18])
                                Pexp_ident "ref" (lib/shape.ml[438,14987+15]..[438,14987+18])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[438,14987+19]..[438,14987+30])
                                    Pexp_ident "Params.fuel" (lib/shape.ml[438,14987+19]..[438,14987+30])
                              ]
                        ]
                        expression (lib/shape.ml[439,15021+4]..[449,15286+34])
                          Pexp_let Nonrec
                          [
                            <def>
                              pattern (lib/shape.ml[439,15021+8]..[439,15021+25])
                                Ppat_var "reduce_memo_table" (lib/shape.ml[439,15021+8]..[439,15021+25])
                              expression (lib/shape.ml[439,15021+28]..[439,15021+45])
                                Pexp_apply
                                expression (lib/shape.ml[439,15021+28]..[439,15021+42])
                                  Pexp_ident "Hashtbl.create" (lib/shape.ml[439,15021+28]..[439,15021+42])
                                [
                                  <arg>
                                  Nolabel
                                    expression (lib/shape.ml[439,15021+43]..[439,15021+45])
                                      Pexp_constant PConst_int (42,None)
                                ]
                          ]
                          expression (lib/shape.ml[440,15070+4]..[449,15286+34])
                            Pexp_let Nonrec
                            [
                              <def>
                                pattern (lib/shape.ml[440,15070+8]..[440,15070+28])
                                  Ppat_var "read_back_memo_table" (lib/shape.ml[440,15070+8]..[440,15070+28])
                                expression (lib/shape.ml[440,15070+31]..[440,15070+48])
                                  Pexp_apply
                                  expression (lib/shape.ml[440,15070+31]..[440,15070+45])
                                    Pexp_ident "Hashtbl.create" (lib/shape.ml[440,15070+31]..[440,15070+45])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[440,15070+46]..[440,15070+48])
                                        Pexp_constant PConst_int (42,None)
                                  ]
                            ]
                            expression (lib/shape.ml[441,15122+4]..[449,15286+34])
                              Pexp_let Nonrec
                              [
                                <def>
                                  pattern (lib/shape.ml[441,15122+8]..[441,15122+17])
                                    Ppat_var "local_env" (lib/shape.ml[441,15122+8]..[441,15122+17])
                                  expression (lib/shape.ml[441,15122+20]..[441,15122+35])
                                    Pexp_ident "Ident.Map.empty" (lib/shape.ml[441,15122+20]..[441,15122+35])
                              ]
                              expression (lib/shape.ml[442,15161+4]..[449,15286+34])
                                Pexp_let Nonrec
                                [
                                  <def>
                                    pattern (lib/shape.ml[442,15161+8]..[442,15161+11])
                                      Ppat_var "env" (lib/shape.ml[442,15161+8]..[442,15161+11])
                                    expression (lib/shape.ml[442,15161+14]..[448,15277+5])
                                      Pexp_record
                                      [
                                        "fuel" (lib/shape.ml[443,15177+6]..[443,15177+10]) ghost
                                          expression (lib/shape.ml[443,15177+6]..[443,15177+10])
                                            Pexp_ident "fuel" (lib/shape.ml[443,15177+6]..[443,15177+10])
                                        "global_env" (lib/shape.ml[444,15189+6]..[444,15189+16]) ghost
                                          expression (lib/shape.ml[444,15189+6]..[444,15189+16])
                                            Pexp_ident "global_env" (lib/shape.ml[444,15189+6]..[444,15189+16])
                                        "reduce_memo_table" (lib/shape.ml[445,15207+6]..[445,15207+23]) ghost
                                          expression (lib/shape.ml[445,15207+6]..[445,15207+23])
                                            Pexp_ident "reduce_memo_table" (lib/shape.ml[445,15207+6]..[445,15207+23])
                                        "read_back_memo_table" (lib/shape.ml[446,15232+6]..[446,15232+26]) ghost
                                          expression (lib/shape.ml[446,15232+6]..[446,15232+26])
                                            Pexp_ident "read_back_memo_table" (lib/shape.ml[446,15232+6]..[446,15232+26])
                                        "local_env" (lib/shape.ml[447,15260+6]..[447,15260+15]) ghost
                                          expression (lib/shape.ml[447,15260+6]..[447,15260+15])
                                            Pexp_ident "local_env" (lib/shape.ml[447,15260+6]..[447,15260+15])
                                      ]
                                      None
                                ]
                                expression (lib/shape.ml[449,15286+4]..[449,15286+34])
                                  Pexp_apply
                                  expression (lib/shape.ml[449,15286+18]..[449,15286+20])
                                    Pexp_ident "|>" (lib/shape.ml[449,15286+18]..[449,15286+20])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[449,15286+4]..[449,15286+17])
                                        Pexp_apply
                                        expression (lib/shape.ml[449,15286+4]..[449,15286+11])
                                          Pexp_ident "reduce_" (lib/shape.ml[449,15286+4]..[449,15286+11])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[449,15286+12]..[449,15286+15])
                                              Pexp_ident "env" (lib/shape.ml[449,15286+12]..[449,15286+15])
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[449,15286+16]..[449,15286+17])
                                              Pexp_ident "t" (lib/shape.ml[449,15286+16]..[449,15286+17])
                                        ]
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[449,15286+21]..[449,15286+34])
                                        Pexp_apply
                                        expression (lib/shape.ml[449,15286+21]..[449,15286+30])
                                          Pexp_ident "read_back" (lib/shape.ml[449,15286+21]..[449,15286+30])
                                        [
                                          <arg>
                                          Nolabel
                                            expression (lib/shape.ml[449,15286+31]..[449,15286+34])
                                              Pexp_ident "env" (lib/shape.ml[449,15286+31]..[449,15286+34])
                                        ]
                                  ]
              ]
          ]
  structure_item (lib/shape.ml[452,15326+0]..[463,15812+6])
    Pstr_module
    "Local_reduce" (lib/shape.ml[452,15326+7]..[452,15326+19])
      module_expr (lib/shape.ml[458,15663+2]..[463,15812+6])
        Pmod_apply
        module_expr (lib/shape.ml[458,15663+2]..[458,15663+13])
          Pmod_ident "Make_reduce" (lib/shape.ml[458,15663+2]..[458,15663+13])
        module_expr (lib/shape.ml[458,15663+14]..[463,15812+5])
          Pmod_structure
          [
            structure_item (lib/shape.ml[459,15684+4]..[459,15684+19])
              Pstr_type Rec
              [
                type_declaration "env" (lib/shape.ml[459,15684+9]..[459,15684+12]) (lib/shape.ml[459,15684+4]..[459,15684+19])
                  ptype_params =
                    []
                  ptype_cstrs =
                    []
                  ptype_kind =
                    Ptype_abstract
                  ptype_private = Public
                  ptype_manifest =
                    Some
                      core_type (lib/shape.ml[459,15684+15]..[459,15684+19])
                        Ptyp_constr "unit" (lib/shape.ml[459,15684+15]..[459,15684+19])
                        []
              ]
            structure_item (lib/shape.ml[460,15704+4]..[460,15704+17])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[460,15704+8]..[460,15704+12])
                    Ppat_var "fuel" (lib/shape.ml[460,15704+8]..[460,15704+12])
                  expression (lib/shape.ml[460,15704+15]..[460,15704+17])
                    Pexp_constant PConst_int (10,None)
              ]
            structure_item (lib/shape.ml[461,15722+4]..[461,15722+43])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[461,15722+8]..[461,15722+23])
                    Ppat_var "read_unit_shape" (lib/shape.ml[461,15722+8]..[461,15722+23])
                  expression (lib/shape.ml[461,15722+24]..[461,15722+43]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[461,15722+24]..[461,15722+36])
                        Labelled "unit_name"
                        None
                        pattern (lib/shape.ml[461,15722+35]..[461,15722+36])
                          Ppat_any
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[461,15722+39]..[461,15722+43])
                        Pexp_construct "None" (lib/shape.ml[461,15722+39]..[461,15722+43])
                        None
              ]
            structure_item (lib/shape.ml[462,15766+4]..[462,15766+45])
              Pstr_value Nonrec
              [
                <def>
                  pattern (lib/shape.ml[462,15766+8]..[462,15766+18])
                    Ppat_var "find_shape" (lib/shape.ml[462,15766+8]..[462,15766+18])
                  expression (lib/shape.ml[462,15766+19]..[462,15766+45]) ghost
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[462,15766+19]..[462,15766+23])
                        Nolabel
                        None
                        pattern (lib/shape.ml[462,15766+19]..[462,15766+23])
                          Ppat_var "_env" (lib/shape.ml[462,15766+19]..[462,15766+23])
                      Pparam_val (lib/shape.ml[462,15766+24]..[462,15766+27])
                        Nolabel
                        None
                        pattern (lib/shape.ml[462,15766+24]..[462,15766+27])
                          Ppat_var "_id" (lib/shape.ml[462,15766+24]..[462,15766+27])
                    ]
                    None
                    Pfunction_body
                      expression (lib/shape.ml[462,15766+30]..[462,15766+45])
                        Pexp_apply
                        expression (lib/shape.ml[462,15766+30]..[462,15766+35])
                          Pexp_ident "raise" (lib/shape.ml[462,15766+30]..[462,15766+35])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[462,15766+36]..[462,15766+45])
                              Pexp_construct "Not_found" (lib/shape.ml[462,15766+36]..[462,15766+45])
                              None
                        ]
              ]
          ]
  structure_item (lib/shape.ml[465,15820+0]..[466,15845+30])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[465,15820+4]..[465,15820+16])
          Ppat_var "local_reduce" (lib/shape.ml[465,15820+4]..[465,15820+16])
        expression (lib/shape.ml[465,15820+17]..[466,15845+30]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[465,15820+17]..[465,15820+22])
              Nolabel
              None
              pattern (lib/shape.ml[465,15820+17]..[465,15820+22])
                Ppat_var "shape" (lib/shape.ml[465,15820+17]..[465,15820+22])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[466,15845+2]..[466,15845+30])
              Pexp_apply
              expression (lib/shape.ml[466,15845+2]..[466,15845+21])
                Pexp_ident "Local_reduce.reduce" (lib/shape.ml[466,15845+2]..[466,15845+21])
              [
                <arg>
                Nolabel
                  expression (lib/shape.ml[466,15845+22]..[466,15845+24])
                    Pexp_construct "()" (lib/shape.ml[466,15845+22]..[466,15845+24])
                    None
                <arg>
                Nolabel
                  expression (lib/shape.ml[466,15845+25]..[466,15845+30])
                    Pexp_ident "shape" (lib/shape.ml[466,15845+25]..[466,15845+30])
              ]
    ]
  structure_item (lib/shape.ml[468,15877+0]..[468,15877+60])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[468,15877+4]..[468,15877+13])
          Ppat_var "dummy_mod" (lib/shape.ml[468,15877+4]..[468,15877+13])
        expression (lib/shape.ml[468,15877+16]..[468,15877+60])
          Pexp_record
          [
            "uid" (lib/shape.ml[468,15877+18]..[468,15877+21])
              expression (lib/shape.ml[468,15877+24]..[468,15877+28])
                Pexp_construct "None" (lib/shape.ml[468,15877+24]..[468,15877+28])
                None
            "desc" (lib/shape.ml[468,15877+30]..[468,15877+34])
              expression (lib/shape.ml[468,15877+37]..[468,15877+58])
                Pexp_construct "Struct" (lib/shape.ml[468,15877+37]..[468,15877+43])
                Some
                  expression (lib/shape.ml[468,15877+44]..[468,15877+58])
                    Pexp_ident "Item.Map.empty" (lib/shape.ml[468,15877+44]..[468,15877+58])
          ]
          None
    ]
  structure_item (lib/shape.ml[470,15939+0]..[481,16381+15])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[470,15939+4]..[470,15939+11])
          Ppat_var "of_path" (lib/shape.ml[470,15939+4]..[470,15939+11])
        expression (lib/shape.ml[470,15939+12]..[481,16381+15]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[470,15939+12]..[470,15939+23])
              Labelled "find_shape"
              None
              pattern (lib/shape.ml[470,15939+13]..[470,15939+23])
                Ppat_var "find_shape" (lib/shape.ml[470,15939+13]..[470,15939+23])
            Pparam_val (lib/shape.ml[470,15939+24]..[470,15939+34])
              Labelled "namespace"
              None
              pattern (lib/shape.ml[470,15939+25]..[470,15939+34])
                Ppat_var "namespace" (lib/shape.ml[470,15939+25]..[470,15939+34])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[471,15976+2]..[481,16381+15])
              Pexp_let Rec
              [
                <def>
                  pattern (lib/shape.ml[471,15976+10]..[471,15976+13])
                    Ppat_var "aux" (lib/shape.ml[471,15976+10]..[471,15976+13])
                  core_type (lib/shape.ml[471,15976+16]..[471,15976+51])
                    Ptyp_arrow
                    Nolabel
                    core_type (lib/shape.ml[471,15976+16]..[471,15976+36])
                      Ptyp_constr "Sig_component_kind.t" (lib/shape.ml[471,15976+16]..[471,15976+36])
                      []
                    core_type (lib/shape.ml[471,15976+40]..[471,15976+51])
                      Ptyp_arrow
                      Nolabel
                      core_type (lib/shape.ml[471,15976+40]..[471,15976+46])
                        Ptyp_constr "Path.t" (lib/shape.ml[471,15976+40]..[471,15976+46])
                        []
                      core_type (lib/shape.ml[471,15976+50]..[471,15976+51])
                        Ptyp_constr "t" (lib/shape.ml[471,15976+50]..[471,15976+51])
                        []
                  expression (lib/shape.ml[471,15976+54]..[479,16366+9])
                    Pexp_function
                    [
                      Pparam_val (lib/shape.ml[471,15976+58]..[471,15976+60])
                        Nolabel
                        None
                        pattern (lib/shape.ml[471,15976+58]..[471,15976+60])
                          Ppat_var "ns" (lib/shape.ml[471,15976+58]..[471,15976+60])
                    ]
                    None
                    Pfunction_cases (lib/shape.ml[471,15976+64]..[479,16366+9])
                      [
                        <case>
                          pattern (lib/shape.ml[472,16049+6]..[472,16049+15])
                            Ppat_construct "Pident" (lib/shape.ml[472,16049+6]..[472,16049+12])
                            Some
                              []
                              pattern (lib/shape.ml[472,16049+13]..[472,16049+15])
                                Ppat_var "id" (lib/shape.ml[472,16049+13]..[472,16049+15])
                          expression (lib/shape.ml[472,16049+19]..[472,16049+35])
                            Pexp_apply
                            expression (lib/shape.ml[472,16049+19]..[472,16049+29])
                              Pexp_ident "find_shape" (lib/shape.ml[472,16049+19]..[472,16049+29])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[472,16049+30]..[472,16049+32])
                                  Pexp_ident "ns" (lib/shape.ml[472,16049+30]..[472,16049+32])
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[472,16049+33]..[472,16049+35])
                                  Pexp_ident "id" (lib/shape.ml[472,16049+33]..[472,16049+35])
                            ]
                        <case>
                          pattern (lib/shape.ml[473,16085+6]..[473,16085+23])
                            Ppat_construct "Pdot" (lib/shape.ml[473,16085+6]..[473,16085+10])
                            Some
                              []
                              pattern (lib/shape.ml[473,16085+11]..[473,16085+23])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[473,16085+12]..[473,16085+16])
                                    Ppat_var "path" (lib/shape.ml[473,16085+12]..[473,16085+16])
                                  pattern (lib/shape.ml[473,16085+18]..[473,16085+22])
                                    Ppat_var "name" (lib/shape.ml[473,16085+18]..[473,16085+22])
                                ]
                          expression (lib/shape.ml[473,16085+27]..[473,16085+60])
                            Pexp_apply
                            expression (lib/shape.ml[473,16085+27]..[473,16085+31])
                              Pexp_ident "proj" (lib/shape.ml[473,16085+27]..[473,16085+31])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[473,16085+32]..[473,16085+49])
                                  Pexp_apply
                                  expression (lib/shape.ml[473,16085+33]..[473,16085+36])
                                    Pexp_ident "aux" (lib/shape.ml[473,16085+33]..[473,16085+36])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[473,16085+37]..[473,16085+43])
                                        Pexp_construct "Module" (lib/shape.ml[473,16085+37]..[473,16085+43])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[473,16085+44]..[473,16085+48])
                                        Pexp_ident "path" (lib/shape.ml[473,16085+44]..[473,16085+48])
                                  ]
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[473,16085+50]..[473,16085+60])
                                  Pexp_tuple
                                  [
                                    expression (lib/shape.ml[473,16085+51]..[473,16085+55])
                                      Pexp_ident "name" (lib/shape.ml[473,16085+51]..[473,16085+55])
                                    expression (lib/shape.ml[473,16085+57]..[473,16085+59])
                                      Pexp_ident "ns" (lib/shape.ml[473,16085+57]..[473,16085+59])
                                  ]
                            ]
                        <case>
                          pattern (lib/shape.ml[474,16146+6]..[474,16146+21])
                            Ppat_construct "Papply" (lib/shape.ml[474,16146+6]..[474,16146+12])
                            Some
                              []
                              pattern (lib/shape.ml[474,16146+13]..[474,16146+21])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[474,16146+14]..[474,16146+16])
                                    Ppat_var "p1" (lib/shape.ml[474,16146+14]..[474,16146+16])
                                  pattern (lib/shape.ml[474,16146+18]..[474,16146+20])
                                    Ppat_var "p2" (lib/shape.ml[474,16146+18]..[474,16146+20])
                                ]
                          expression (lib/shape.ml[474,16146+25]..[474,16146+65])
                            Pexp_apply
                            expression (lib/shape.ml[474,16146+25]..[474,16146+28])
                              Pexp_ident "app" (lib/shape.ml[474,16146+25]..[474,16146+28])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[474,16146+29]..[474,16146+44])
                                  Pexp_apply
                                  expression (lib/shape.ml[474,16146+30]..[474,16146+33])
                                    Pexp_ident "aux" (lib/shape.ml[474,16146+30]..[474,16146+33])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16146+34]..[474,16146+40])
                                        Pexp_construct "Module" (lib/shape.ml[474,16146+34]..[474,16146+40])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16146+41]..[474,16146+43])
                                        Pexp_ident "p1" (lib/shape.ml[474,16146+41]..[474,16146+43])
                                  ]
                              <arg>
                              Labelled "arg"
                                expression (lib/shape.ml[474,16146+50]..[474,16146+65])
                                  Pexp_apply
                                  expression (lib/shape.ml[474,16146+51]..[474,16146+54])
                                    Pexp_ident "aux" (lib/shape.ml[474,16146+51]..[474,16146+54])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16146+55]..[474,16146+61])
                                        Pexp_construct "Module" (lib/shape.ml[474,16146+55]..[474,16146+61])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[474,16146+62]..[474,16146+64])
                                        Pexp_ident "p2" (lib/shape.ml[474,16146+62]..[474,16146+64])
                                  ]
                            ]
                        <case>
                          pattern (lib/shape.ml[475,16212+6]..[475,16212+29])
                            Ppat_construct "Pextra_ty" (lib/shape.ml[475,16212+6]..[475,16212+15])
                            Some
                              []
                              pattern (lib/shape.ml[475,16212+16]..[475,16212+29])
                                Ppat_tuple
                                [
                                  pattern (lib/shape.ml[475,16212+17]..[475,16212+21])
                                    Ppat_var "path" (lib/shape.ml[475,16212+17]..[475,16212+21])
                                  pattern (lib/shape.ml[475,16212+23]..[475,16212+28])
                                    Ppat_var "extra" (lib/shape.ml[475,16212+23]..[475,16212+28])
                                ]
                          expression (lib/shape.ml[475,16212+33]..[479,16366+9])
                            Pexp_match
                            expression (lib/shape.ml[476,16251+14]..[476,16251+19])
                              Pexp_ident "extra" (lib/shape.ml[476,16251+14]..[476,16251+19])
                            [
                              <case>
                                pattern (lib/shape.ml[477,16276+10]..[477,16276+20])
                                  Ppat_construct "Pcstr_ty" (lib/shape.ml[477,16276+10]..[477,16276+18])
                                  Some
                                    []
                                    pattern (lib/shape.ml[477,16276+19]..[477,16276+20])
                                      Ppat_any
                                expression (lib/shape.ml[477,16276+24]..[477,16276+37])
                                  Pexp_apply
                                  expression (lib/shape.ml[477,16276+24]..[477,16276+27])
                                    Pexp_ident "aux" (lib/shape.ml[477,16276+24]..[477,16276+27])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[477,16276+28]..[477,16276+32])
                                        Pexp_construct "Type" (lib/shape.ml[477,16276+28]..[477,16276+32])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[477,16276+33]..[477,16276+37])
                                        Pexp_ident "path" (lib/shape.ml[477,16276+33]..[477,16276+37])
                                  ]
                              <case>
                                pattern (lib/shape.ml[478,16314+10]..[478,16314+17])
                                  Ppat_construct "Pext_ty" (lib/shape.ml[478,16314+10]..[478,16314+17])
                                  None
                                expression (lib/shape.ml[478,16314+21]..[478,16314+51])
                                  Pexp_apply
                                  expression (lib/shape.ml[478,16314+21]..[478,16314+24])
                                    Pexp_ident "aux" (lib/shape.ml[478,16314+21]..[478,16314+24])
                                  [
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[478,16314+25]..[478,16314+46])
                                        Pexp_construct "Extension_constructor" (lib/shape.ml[478,16314+25]..[478,16314+46])
                                        None
                                    <arg>
                                    Nolabel
                                      expression (lib/shape.ml[478,16314+47]..[478,16314+51])
                                        Pexp_ident "path" (lib/shape.ml[478,16314+47]..[478,16314+51])
                                  ]
                            ]
                      ]
              ]
              expression (lib/shape.ml[481,16381+2]..[481,16381+15])
                Pexp_apply
                expression (lib/shape.ml[481,16381+2]..[481,16381+5])
                  Pexp_ident "aux" (lib/shape.ml[481,16381+2]..[481,16381+5])
                [
                  <arg>
                  Nolabel
                    expression (lib/shape.ml[481,16381+6]..[481,16381+15])
                      Pexp_ident "namespace" (lib/shape.ml[481,16381+6]..[481,16381+15])
                ]
    ]
  structure_item (lib/shape.ml[483,16398+0]..[485,16499+24])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[483,16398+4]..[483,16398+23])
          Ppat_var "for_persistent_unit" (lib/shape.ml[483,16398+4]..[483,16398+23])
        expression (lib/shape.ml[483,16398+24]..[485,16499+24]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[483,16398+24]..[483,16398+25])
              Nolabel
              None
              pattern (lib/shape.ml[483,16398+24]..[483,16398+25])
                Ppat_var "s" (lib/shape.ml[483,16398+24]..[483,16398+25])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[484,16426+2]..[485,16499+24])
              Pexp_record
              [
                "uid" (lib/shape.ml[484,16426+4]..[484,16426+7])
                  expression (lib/shape.ml[484,16426+10]..[484,16426+71])
                    Pexp_construct "Some" (lib/shape.ml[484,16426+10]..[484,16426+14])
                    Some
                      expression (lib/shape.ml[484,16426+15]..[484,16426+71])
                        Pexp_apply
                        expression (lib/shape.ml[484,16426+16]..[484,16426+42])
                          Pexp_ident "Uid.of_compilation_unit_id" (lib/shape.ml[484,16426+16]..[484,16426+42])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[484,16426+43]..[484,16426+70])
                              Pexp_apply
                              expression (lib/shape.ml[484,16426+44]..[484,16426+67])
                                Pexp_ident "Ident.create_persistent" (lib/shape.ml[484,16426+44]..[484,16426+67])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[484,16426+68]..[484,16426+69])
                                    Pexp_ident "s" (lib/shape.ml[484,16426+68]..[484,16426+69])
                              ]
                        ]
                "desc" (lib/shape.ml[485,16499+4]..[485,16499+8])
                  expression (lib/shape.ml[485,16499+11]..[485,16499+22])
                    Pexp_construct "Comp_unit" (lib/shape.ml[485,16499+11]..[485,16499+20])
                    Some
                      expression (lib/shape.ml[485,16499+21]..[485,16499+22])
                        Pexp_ident "s" (lib/shape.ml[485,16499+21]..[485,16499+22])
              ]
              None
    ]
  structure_item (lib/shape.ml[487,16525+0]..[487,16525+49])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[487,16525+4]..[487,16525+19])
          Ppat_var "leaf_for_unpack" (lib/shape.ml[487,16525+4]..[487,16525+19])
        expression (lib/shape.ml[487,16525+22]..[487,16525+49])
          Pexp_record
          [
            "uid" (lib/shape.ml[487,16525+24]..[487,16525+27])
              expression (lib/shape.ml[487,16525+30]..[487,16525+34])
                Pexp_construct "None" (lib/shape.ml[487,16525+30]..[487,16525+34])
                None
            "desc" (lib/shape.ml[487,16525+36]..[487,16525+40])
              expression (lib/shape.ml[487,16525+43]..[487,16525+47])
                Pexp_construct "Leaf" (lib/shape.ml[487,16525+43]..[487,16525+47])
                None
          ]
          None
    ]
  structure_item (lib/shape.ml[489,16576+0]..[492,16661+10])
    Pstr_value Nonrec
    [
      <def>
        pattern (lib/shape.ml[489,16576+4]..[489,16576+19])
          Ppat_var "set_uid_if_none" (lib/shape.ml[489,16576+4]..[489,16576+19])
        expression (lib/shape.ml[489,16576+20]..[492,16661+10]) ghost
          Pexp_function
          [
            Pparam_val (lib/shape.ml[489,16576+20]..[489,16576+21])
              Nolabel
              None
              pattern (lib/shape.ml[489,16576+20]..[489,16576+21])
                Ppat_var "t" (lib/shape.ml[489,16576+20]..[489,16576+21])
            Pparam_val (lib/shape.ml[489,16576+22]..[489,16576+25])
              Nolabel
              None
              pattern (lib/shape.ml[489,16576+22]..[489,16576+25])
                Ppat_var "uid" (lib/shape.ml[489,16576+22]..[489,16576+25])
          ]
          None
          Pfunction_body
            expression (lib/shape.ml[490,16604+2]..[492,16661+10])
              Pexp_match
              expression (lib/shape.ml[490,16604+8]..[490,16604+13])
                Pexp_field
                expression (lib/shape.ml[490,16604+8]..[490,16604+9])
                  Pexp_ident "t" (lib/shape.ml[490,16604+8]..[490,16604+9])
                "uid" (lib/shape.ml[490,16604+10]..[490,16604+13])
              [
                <case>
                  pattern (lib/shape.ml[491,16623+4]..[491,16623+8])
                    Ppat_construct "None" (lib/shape.ml[491,16623+4]..[491,16623+8])
                    None
                  expression (lib/shape.ml[491,16623+12]..[491,16623+37])
                    Pexp_record
                    [
                      "uid" (lib/shape.ml[491,16623+21]..[491,16623+24])
                        expression (lib/shape.ml[491,16623+27]..[491,16623+35])
                          Pexp_construct "Some" (lib/shape.ml[491,16623+27]..[491,16623+31])
                          Some
                            expression (lib/shape.ml[491,16623+32]..[491,16623+35])
                              Pexp_ident "uid" (lib/shape.ml[491,16623+32]..[491,16623+35])
                    ]
                    Some
                      expression (lib/shape.ml[491,16623+14]..[491,16623+15])
                        Pexp_ident "t" (lib/shape.ml[491,16623+14]..[491,16623+15])
                <case>
                  pattern (lib/shape.ml[492,16661+4]..[492,16661+5])
                    Ppat_any
                  expression (lib/shape.ml[492,16661+9]..[492,16661+10])
                    Pexp_ident "t" (lib/shape.ml[492,16661+9]..[492,16661+10])
              ]
    ]
  structure_item (lib/shape.ml[494,16673+0]..[538,18160+3])
    Pstr_module
    "Map" (lib/shape.ml[494,16673+7]..[494,16673+10])
      module_expr (lib/shape.ml[494,16673+13]..[538,18160+3])
        Pmod_structure
        [
          structure_item (lib/shape.ml[495,16693+2]..[495,16693+16])
            Pstr_type Rec
            [
              type_declaration "shape" (lib/shape.ml[495,16693+7]..[495,16693+12]) (lib/shape.ml[495,16693+2]..[495,16693+16])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (lib/shape.ml[495,16693+15]..[495,16693+16])
                      Ptyp_constr "t" (lib/shape.ml[495,16693+15]..[495,16693+16])
                      []
            ]
          structure_item (lib/shape.ml[496,16710+2]..[496,16710+30])
            Pstr_type Nonrec
            [
              type_declaration "t" (lib/shape.ml[496,16710+14]..[496,16710+15]) (lib/shape.ml[496,16710+2]..[496,16710+30])
                ptype_params =
                  []
                ptype_cstrs =
                  []
                ptype_kind =
                  Ptype_abstract
                ptype_private = Public
                ptype_manifest =
                  Some
                    core_type (lib/shape.ml[496,16710+18]..[496,16710+30])
                      Ptyp_constr "Item.Map.t" (lib/shape.ml[496,16710+20]..[496,16710+30])
                      [
                        core_type (lib/shape.ml[496,16710+18]..[496,16710+19])
                          Ptyp_constr "t" (lib/shape.ml[496,16710+18]..[496,16710+19])
                          []
                      ]
            ]
          structure_item (lib/shape.ml[498,16742+2]..[498,16742+28])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[498,16742+6]..[498,16742+11])
                  Ppat_var "empty" (lib/shape.ml[498,16742+6]..[498,16742+11])
                expression (lib/shape.ml[498,16742+14]..[498,16742+28])
                  Pexp_ident "Item.Map.empty" (lib/shape.ml[498,16742+14]..[498,16742+28])
            ]
          structure_item (lib/shape.ml[500,16772+2]..[500,16772+50])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[500,16772+6]..[500,16772+9])
                  Ppat_var "add" (lib/shape.ml[500,16772+6]..[500,16772+9])
                expression (lib/shape.ml[500,16772+10]..[500,16772+50]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[500,16772+10]..[500,16772+11])
                      Nolabel
                      None
                      pattern (lib/shape.ml[500,16772+10]..[500,16772+11])
                        Ppat_var "t" (lib/shape.ml[500,16772+10]..[500,16772+11])
                    Pparam_val (lib/shape.ml[500,16772+12]..[500,16772+16])
                      Nolabel
                      None
                      pattern (lib/shape.ml[500,16772+12]..[500,16772+16])
                        Ppat_var "item" (lib/shape.ml[500,16772+12]..[500,16772+16])
                    Pparam_val (lib/shape.ml[500,16772+17]..[500,16772+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[500,16772+17]..[500,16772+22])
                        Ppat_var "shape" (lib/shape.ml[500,16772+17]..[500,16772+22])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[500,16772+25]..[500,16772+50])
                      Pexp_apply
                      expression (lib/shape.ml[500,16772+25]..[500,16772+37])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[500,16772+25]..[500,16772+37])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[500,16772+38]..[500,16772+42])
                            Pexp_ident "item" (lib/shape.ml[500,16772+38]..[500,16772+42])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[500,16772+43]..[500,16772+48])
                            Pexp_ident "shape" (lib/shape.ml[500,16772+43]..[500,16772+48])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[500,16772+49]..[500,16772+50])
                            Pexp_ident "t" (lib/shape.ml[500,16772+49]..[500,16772+50])
                      ]
            ]
          structure_item (lib/shape.ml[502,16824+2]..[502,16824+68])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[502,16824+6]..[502,16824+15])
                  Ppat_var "add_value" (lib/shape.ml[502,16824+6]..[502,16824+15])
                expression (lib/shape.ml[502,16824+16]..[502,16824+68]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[502,16824+16]..[502,16824+17])
                      Nolabel
                      None
                      pattern (lib/shape.ml[502,16824+16]..[502,16824+17])
                        Ppat_var "t" (lib/shape.ml[502,16824+16]..[502,16824+17])
                    Pparam_val (lib/shape.ml[502,16824+18]..[502,16824+20])
                      Nolabel
                      None
                      pattern (lib/shape.ml[502,16824+18]..[502,16824+20])
                        Ppat_var "id" (lib/shape.ml[502,16824+18]..[502,16824+20])
                    Pparam_val (lib/shape.ml[502,16824+21]..[502,16824+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[502,16824+21]..[502,16824+24])
                        Ppat_var "uid" (lib/shape.ml[502,16824+21]..[502,16824+24])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[502,16824+27]..[502,16824+68])
                      Pexp_apply
                      expression (lib/shape.ml[502,16824+27]..[502,16824+39])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[502,16824+27]..[502,16824+39])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[502,16824+40]..[502,16824+55])
                            Pexp_apply
                            expression (lib/shape.ml[502,16824+41]..[502,16824+51])
                              Pexp_ident "Item.value" (lib/shape.ml[502,16824+41]..[502,16824+51])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[502,16824+52]..[502,16824+54])
                                  Pexp_ident "id" (lib/shape.ml[502,16824+52]..[502,16824+54])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[502,16824+56]..[502,16824+66])
                            Pexp_apply
                            expression (lib/shape.ml[502,16824+57]..[502,16824+61])
                              Pexp_ident "leaf" (lib/shape.ml[502,16824+57]..[502,16824+61])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[502,16824+62]..[502,16824+65])
                                  Pexp_ident "uid" (lib/shape.ml[502,16824+62]..[502,16824+65])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[502,16824+67]..[502,16824+68])
                            Pexp_ident "t" (lib/shape.ml[502,16824+67]..[502,16824+68])
                      ]
            ]
          structure_item (lib/shape.ml[503,16893+2]..[505,16959+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[503,16893+6]..[503,16893+20])
                  Ppat_var "add_value_proj" (lib/shape.ml[503,16893+6]..[503,16893+20])
                expression (lib/shape.ml[503,16893+21]..[505,16959+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[503,16893+21]..[503,16893+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[503,16893+21]..[503,16893+22])
                        Ppat_var "t" (lib/shape.ml[503,16893+21]..[503,16893+22])
                    Pparam_val (lib/shape.ml[503,16893+23]..[503,16893+25])
                      Nolabel
                      None
                      pattern (lib/shape.ml[503,16893+23]..[503,16893+25])
                        Ppat_var "id" (lib/shape.ml[503,16893+23]..[503,16893+25])
                    Pparam_val (lib/shape.ml[503,16893+26]..[503,16893+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[503,16893+26]..[503,16893+31])
                        Ppat_var "shape" (lib/shape.ml[503,16893+26]..[503,16893+31])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[504,16927+4]..[505,16959+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[504,16927+8]..[504,16927+12])
                            Ppat_var "item" (lib/shape.ml[504,16927+8]..[504,16927+12])
                          expression (lib/shape.ml[504,16927+15]..[504,16927+28])
                            Pexp_apply
                            expression (lib/shape.ml[504,16927+15]..[504,16927+25])
                              Pexp_ident "Item.value" (lib/shape.ml[504,16927+15]..[504,16927+25])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[504,16927+26]..[504,16927+28])
                                  Pexp_ident "id" (lib/shape.ml[504,16927+26]..[504,16927+28])
                            ]
                      ]
                      expression (lib/shape.ml[505,16959+4]..[505,16959+41])
                        Pexp_apply
                        expression (lib/shape.ml[505,16959+4]..[505,16959+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[505,16959+4]..[505,16959+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[505,16959+17]..[505,16959+21])
                              Pexp_ident "item" (lib/shape.ml[505,16959+17]..[505,16959+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[505,16959+22]..[505,16959+39])
                              Pexp_apply
                              expression (lib/shape.ml[505,16959+23]..[505,16959+27])
                                Pexp_ident "proj" (lib/shape.ml[505,16959+23]..[505,16959+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[505,16959+28]..[505,16959+33])
                                    Pexp_ident "shape" (lib/shape.ml[505,16959+28]..[505,16959+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[505,16959+34]..[505,16959+38])
                                    Pexp_ident "item" (lib/shape.ml[505,16959+34]..[505,16959+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[505,16959+40]..[505,16959+41])
                              Pexp_ident "t" (lib/shape.ml[505,16959+40]..[505,16959+41])
                        ]
            ]
          structure_item (lib/shape.ml[507,17002+2]..[507,17002+67])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[507,17002+6]..[507,17002+14])
                  Ppat_var "add_type" (lib/shape.ml[507,17002+6]..[507,17002+14])
                expression (lib/shape.ml[507,17002+15]..[507,17002+67]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[507,17002+15]..[507,17002+16])
                      Nolabel
                      None
                      pattern (lib/shape.ml[507,17002+15]..[507,17002+16])
                        Ppat_var "t" (lib/shape.ml[507,17002+15]..[507,17002+16])
                    Pparam_val (lib/shape.ml[507,17002+17]..[507,17002+19])
                      Nolabel
                      None
                      pattern (lib/shape.ml[507,17002+17]..[507,17002+19])
                        Ppat_var "id" (lib/shape.ml[507,17002+17]..[507,17002+19])
                    Pparam_val (lib/shape.ml[507,17002+20]..[507,17002+23])
                      Nolabel
                      None
                      pattern (lib/shape.ml[507,17002+20]..[507,17002+23])
                        Ppat_var "uid" (lib/shape.ml[507,17002+20]..[507,17002+23])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[507,17002+26]..[507,17002+67])
                      Pexp_apply
                      expression (lib/shape.ml[507,17002+26]..[507,17002+38])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[507,17002+26]..[507,17002+38])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[507,17002+39]..[507,17002+54])
                            Pexp_apply
                            expression (lib/shape.ml[507,17002+40]..[507,17002+50])
                              Pexp_ident "Item.type_" (lib/shape.ml[507,17002+40]..[507,17002+50])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[507,17002+51]..[507,17002+53])
                                  Pexp_ident "id" (lib/shape.ml[507,17002+51]..[507,17002+53])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[507,17002+55]..[507,17002+65])
                            Pexp_apply
                            expression (lib/shape.ml[507,17002+56]..[507,17002+60])
                              Pexp_ident "leaf" (lib/shape.ml[507,17002+56]..[507,17002+60])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[507,17002+61]..[507,17002+64])
                                  Pexp_ident "uid" (lib/shape.ml[507,17002+61]..[507,17002+64])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[507,17002+66]..[507,17002+67])
                            Pexp_ident "t" (lib/shape.ml[507,17002+66]..[507,17002+67])
                      ]
            ]
          structure_item (lib/shape.ml[508,17070+2]..[510,17135+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[508,17070+6]..[508,17070+19])
                  Ppat_var "add_type_proj" (lib/shape.ml[508,17070+6]..[508,17070+19])
                expression (lib/shape.ml[508,17070+20]..[510,17135+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[508,17070+20]..[508,17070+21])
                      Nolabel
                      None
                      pattern (lib/shape.ml[508,17070+20]..[508,17070+21])
                        Ppat_var "t" (lib/shape.ml[508,17070+20]..[508,17070+21])
                    Pparam_val (lib/shape.ml[508,17070+22]..[508,17070+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[508,17070+22]..[508,17070+24])
                        Ppat_var "id" (lib/shape.ml[508,17070+22]..[508,17070+24])
                    Pparam_val (lib/shape.ml[508,17070+25]..[508,17070+30])
                      Nolabel
                      None
                      pattern (lib/shape.ml[508,17070+25]..[508,17070+30])
                        Ppat_var "shape" (lib/shape.ml[508,17070+25]..[508,17070+30])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[509,17103+4]..[510,17135+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[509,17103+8]..[509,17103+12])
                            Ppat_var "item" (lib/shape.ml[509,17103+8]..[509,17103+12])
                          expression (lib/shape.ml[509,17103+15]..[509,17103+28])
                            Pexp_apply
                            expression (lib/shape.ml[509,17103+15]..[509,17103+25])
                              Pexp_ident "Item.type_" (lib/shape.ml[509,17103+15]..[509,17103+25])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[509,17103+26]..[509,17103+28])
                                  Pexp_ident "id" (lib/shape.ml[509,17103+26]..[509,17103+28])
                            ]
                      ]
                      expression (lib/shape.ml[510,17135+4]..[510,17135+41])
                        Pexp_apply
                        expression (lib/shape.ml[510,17135+4]..[510,17135+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[510,17135+4]..[510,17135+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[510,17135+17]..[510,17135+21])
                              Pexp_ident "item" (lib/shape.ml[510,17135+17]..[510,17135+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[510,17135+22]..[510,17135+39])
                              Pexp_apply
                              expression (lib/shape.ml[510,17135+23]..[510,17135+27])
                                Pexp_ident "proj" (lib/shape.ml[510,17135+23]..[510,17135+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[510,17135+28]..[510,17135+33])
                                    Pexp_ident "shape" (lib/shape.ml[510,17135+28]..[510,17135+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[510,17135+34]..[510,17135+38])
                                    Pexp_ident "item" (lib/shape.ml[510,17135+34]..[510,17135+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[510,17135+40]..[510,17135+41])
                              Pexp_ident "t" (lib/shape.ml[510,17135+40]..[510,17135+41])
                        ]
            ]
          structure_item (lib/shape.ml[512,17178+2]..[512,17178+68])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[512,17178+6]..[512,17178+16])
                  Ppat_var "add_module" (lib/shape.ml[512,17178+6]..[512,17178+16])
                expression (lib/shape.ml[512,17178+17]..[512,17178+68]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[512,17178+17]..[512,17178+18])
                      Nolabel
                      None
                      pattern (lib/shape.ml[512,17178+17]..[512,17178+18])
                        Ppat_var "t" (lib/shape.ml[512,17178+17]..[512,17178+18])
                    Pparam_val (lib/shape.ml[512,17178+19]..[512,17178+21])
                      Nolabel
                      None
                      pattern (lib/shape.ml[512,17178+19]..[512,17178+21])
                        Ppat_var "id" (lib/shape.ml[512,17178+19]..[512,17178+21])
                    Pparam_val (lib/shape.ml[512,17178+22]..[512,17178+27])
                      Nolabel
                      None
                      pattern (lib/shape.ml[512,17178+22]..[512,17178+27])
                        Ppat_var "shape" (lib/shape.ml[512,17178+22]..[512,17178+27])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[512,17178+30]..[512,17178+68])
                      Pexp_apply
                      expression (lib/shape.ml[512,17178+30]..[512,17178+42])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[512,17178+30]..[512,17178+42])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[512,17178+43]..[512,17178+60])
                            Pexp_apply
                            expression (lib/shape.ml[512,17178+44]..[512,17178+56])
                              Pexp_ident "Item.module_" (lib/shape.ml[512,17178+44]..[512,17178+56])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[512,17178+57]..[512,17178+59])
                                  Pexp_ident "id" (lib/shape.ml[512,17178+57]..[512,17178+59])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[512,17178+61]..[512,17178+66])
                            Pexp_ident "shape" (lib/shape.ml[512,17178+61]..[512,17178+66])
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[512,17178+67]..[512,17178+68])
                            Pexp_ident "t" (lib/shape.ml[512,17178+67]..[512,17178+68])
                      ]
            ]
          structure_item (lib/shape.ml[513,17247+2]..[515,17316+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[513,17247+6]..[513,17247+21])
                  Ppat_var "add_module_proj" (lib/shape.ml[513,17247+6]..[513,17247+21])
                expression (lib/shape.ml[513,17247+22]..[515,17316+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[513,17247+22]..[513,17247+23])
                      Nolabel
                      None
                      pattern (lib/shape.ml[513,17247+22]..[513,17247+23])
                        Ppat_var "t" (lib/shape.ml[513,17247+22]..[513,17247+23])
                    Pparam_val (lib/shape.ml[513,17247+24]..[513,17247+26])
                      Nolabel
                      None
                      pattern (lib/shape.ml[513,17247+24]..[513,17247+26])
                        Ppat_var "id" (lib/shape.ml[513,17247+24]..[513,17247+26])
                    Pparam_val (lib/shape.ml[513,17247+27]..[513,17247+32])
                      Nolabel
                      None
                      pattern (lib/shape.ml[513,17247+27]..[513,17247+32])
                        Ppat_var "shape" (lib/shape.ml[513,17247+27]..[513,17247+32])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[514,17282+4]..[515,17316+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[514,17282+8]..[514,17282+12])
                            Ppat_var "item" (lib/shape.ml[514,17282+8]..[514,17282+12])
                          expression (lib/shape.ml[514,17282+15]..[514,17282+30])
                            Pexp_apply
                            expression (lib/shape.ml[514,17282+15]..[514,17282+27])
                              Pexp_ident "Item.module_" (lib/shape.ml[514,17282+15]..[514,17282+27])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[514,17282+28]..[514,17282+30])
                                  Pexp_ident "id" (lib/shape.ml[514,17282+28]..[514,17282+30])
                            ]
                      ]
                      expression (lib/shape.ml[515,17316+4]..[515,17316+41])
                        Pexp_apply
                        expression (lib/shape.ml[515,17316+4]..[515,17316+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[515,17316+4]..[515,17316+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[515,17316+17]..[515,17316+21])
                              Pexp_ident "item" (lib/shape.ml[515,17316+17]..[515,17316+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[515,17316+22]..[515,17316+39])
                              Pexp_apply
                              expression (lib/shape.ml[515,17316+23]..[515,17316+27])
                                Pexp_ident "proj" (lib/shape.ml[515,17316+23]..[515,17316+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[515,17316+28]..[515,17316+33])
                                    Pexp_ident "shape" (lib/shape.ml[515,17316+28]..[515,17316+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[515,17316+34]..[515,17316+38])
                                    Pexp_ident "item" (lib/shape.ml[515,17316+34]..[515,17316+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[515,17316+40]..[515,17316+41])
                              Pexp_ident "t" (lib/shape.ml[515,17316+40]..[515,17316+41])
                        ]
            ]
          structure_item (lib/shape.ml[517,17359+2]..[518,17392+51])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[517,17359+6]..[517,17359+21])
                  Ppat_var "add_module_type" (lib/shape.ml[517,17359+6]..[517,17359+21])
                expression (lib/shape.ml[517,17359+22]..[518,17392+51]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[517,17359+22]..[517,17359+23])
                      Nolabel
                      None
                      pattern (lib/shape.ml[517,17359+22]..[517,17359+23])
                        Ppat_var "t" (lib/shape.ml[517,17359+22]..[517,17359+23])
                    Pparam_val (lib/shape.ml[517,17359+24]..[517,17359+26])
                      Nolabel
                      None
                      pattern (lib/shape.ml[517,17359+24]..[517,17359+26])
                        Ppat_var "id" (lib/shape.ml[517,17359+24]..[517,17359+26])
                    Pparam_val (lib/shape.ml[517,17359+27]..[517,17359+30])
                      Nolabel
                      None
                      pattern (lib/shape.ml[517,17359+27]..[517,17359+30])
                        Ppat_var "uid" (lib/shape.ml[517,17359+27]..[517,17359+30])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[518,17392+4]..[518,17392+51])
                      Pexp_apply
                      expression (lib/shape.ml[518,17392+4]..[518,17392+16])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[518,17392+4]..[518,17392+16])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[518,17392+17]..[518,17392+38])
                            Pexp_apply
                            expression (lib/shape.ml[518,17392+18]..[518,17392+34])
                              Pexp_ident "Item.module_type" (lib/shape.ml[518,17392+18]..[518,17392+34])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[518,17392+35]..[518,17392+37])
                                  Pexp_ident "id" (lib/shape.ml[518,17392+35]..[518,17392+37])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[518,17392+39]..[518,17392+49])
                            Pexp_apply
                            expression (lib/shape.ml[518,17392+40]..[518,17392+44])
                              Pexp_ident "leaf" (lib/shape.ml[518,17392+40]..[518,17392+44])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[518,17392+45]..[518,17392+48])
                                  Pexp_ident "uid" (lib/shape.ml[518,17392+45]..[518,17392+48])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[518,17392+50]..[518,17392+51])
                            Pexp_ident "t" (lib/shape.ml[518,17392+50]..[518,17392+51])
                      ]
            ]
          structure_item (lib/shape.ml[519,17444+2]..[521,17522+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[519,17444+6]..[519,17444+26])
                  Ppat_var "add_module_type_proj" (lib/shape.ml[519,17444+6]..[519,17444+26])
                expression (lib/shape.ml[519,17444+27]..[521,17522+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[519,17444+27]..[519,17444+28])
                      Nolabel
                      None
                      pattern (lib/shape.ml[519,17444+27]..[519,17444+28])
                        Ppat_var "t" (lib/shape.ml[519,17444+27]..[519,17444+28])
                    Pparam_val (lib/shape.ml[519,17444+29]..[519,17444+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[519,17444+29]..[519,17444+31])
                        Ppat_var "id" (lib/shape.ml[519,17444+29]..[519,17444+31])
                    Pparam_val (lib/shape.ml[519,17444+32]..[519,17444+37])
                      Nolabel
                      None
                      pattern (lib/shape.ml[519,17444+32]..[519,17444+37])
                        Ppat_var "shape" (lib/shape.ml[519,17444+32]..[519,17444+37])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[520,17484+4]..[521,17522+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[520,17484+8]..[520,17484+12])
                            Ppat_var "item" (lib/shape.ml[520,17484+8]..[520,17484+12])
                          expression (lib/shape.ml[520,17484+15]..[520,17484+34])
                            Pexp_apply
                            expression (lib/shape.ml[520,17484+15]..[520,17484+31])
                              Pexp_ident "Item.module_type" (lib/shape.ml[520,17484+15]..[520,17484+31])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[520,17484+32]..[520,17484+34])
                                  Pexp_ident "id" (lib/shape.ml[520,17484+32]..[520,17484+34])
                            ]
                      ]
                      expression (lib/shape.ml[521,17522+4]..[521,17522+41])
                        Pexp_apply
                        expression (lib/shape.ml[521,17522+4]..[521,17522+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[521,17522+4]..[521,17522+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[521,17522+17]..[521,17522+21])
                              Pexp_ident "item" (lib/shape.ml[521,17522+17]..[521,17522+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[521,17522+22]..[521,17522+39])
                              Pexp_apply
                              expression (lib/shape.ml[521,17522+23]..[521,17522+27])
                                Pexp_ident "proj" (lib/shape.ml[521,17522+23]..[521,17522+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[521,17522+28]..[521,17522+33])
                                    Pexp_ident "shape" (lib/shape.ml[521,17522+28]..[521,17522+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[521,17522+34]..[521,17522+38])
                                    Pexp_ident "item" (lib/shape.ml[521,17522+34]..[521,17522+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[521,17522+40]..[521,17522+41])
                              Pexp_ident "t" (lib/shape.ml[521,17522+40]..[521,17522+41])
                        ]
            ]
          structure_item (lib/shape.ml[523,17565+2]..[524,17594+61])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[523,17565+6]..[523,17565+17])
                  Ppat_var "add_extcons" (lib/shape.ml[523,17565+6]..[523,17565+17])
                expression (lib/shape.ml[523,17565+18]..[524,17594+61]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[523,17565+18]..[523,17565+19])
                      Nolabel
                      None
                      pattern (lib/shape.ml[523,17565+18]..[523,17565+19])
                        Ppat_var "t" (lib/shape.ml[523,17565+18]..[523,17565+19])
                    Pparam_val (lib/shape.ml[523,17565+20]..[523,17565+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[523,17565+20]..[523,17565+22])
                        Ppat_var "id" (lib/shape.ml[523,17565+20]..[523,17565+22])
                    Pparam_val (lib/shape.ml[523,17565+23]..[523,17565+26])
                      Nolabel
                      None
                      pattern (lib/shape.ml[523,17565+23]..[523,17565+26])
                        Ppat_var "uid" (lib/shape.ml[523,17565+23]..[523,17565+26])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[524,17594+4]..[524,17594+61])
                      Pexp_apply
                      expression (lib/shape.ml[524,17594+4]..[524,17594+16])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[524,17594+4]..[524,17594+16])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[524,17594+17]..[524,17594+48])
                            Pexp_apply
                            expression (lib/shape.ml[524,17594+18]..[524,17594+44])
                              Pexp_ident "Item.extension_constructor" (lib/shape.ml[524,17594+18]..[524,17594+44])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[524,17594+45]..[524,17594+47])
                                  Pexp_ident "id" (lib/shape.ml[524,17594+45]..[524,17594+47])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[524,17594+49]..[524,17594+59])
                            Pexp_apply
                            expression (lib/shape.ml[524,17594+50]..[524,17594+54])
                              Pexp_ident "leaf" (lib/shape.ml[524,17594+50]..[524,17594+54])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[524,17594+55]..[524,17594+58])
                                  Pexp_ident "uid" (lib/shape.ml[524,17594+55]..[524,17594+58])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[524,17594+60]..[524,17594+61])
                            Pexp_ident "t" (lib/shape.ml[524,17594+60]..[524,17594+61])
                      ]
            ]
          structure_item (lib/shape.ml[525,17656+2]..[527,17740+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[525,17656+6]..[525,17656+22])
                  Ppat_var "add_extcons_proj" (lib/shape.ml[525,17656+6]..[525,17656+22])
                expression (lib/shape.ml[525,17656+23]..[527,17740+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[525,17656+23]..[525,17656+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[525,17656+23]..[525,17656+24])
                        Ppat_var "t" (lib/shape.ml[525,17656+23]..[525,17656+24])
                    Pparam_val (lib/shape.ml[525,17656+25]..[525,17656+27])
                      Nolabel
                      None
                      pattern (lib/shape.ml[525,17656+25]..[525,17656+27])
                        Ppat_var "id" (lib/shape.ml[525,17656+25]..[525,17656+27])
                    Pparam_val (lib/shape.ml[525,17656+28]..[525,17656+33])
                      Nolabel
                      None
                      pattern (lib/shape.ml[525,17656+28]..[525,17656+33])
                        Ppat_var "shape" (lib/shape.ml[525,17656+28]..[525,17656+33])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[526,17692+4]..[527,17740+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[526,17692+8]..[526,17692+12])
                            Ppat_var "item" (lib/shape.ml[526,17692+8]..[526,17692+12])
                          expression (lib/shape.ml[526,17692+15]..[526,17692+44])
                            Pexp_apply
                            expression (lib/shape.ml[526,17692+15]..[526,17692+41])
                              Pexp_ident "Item.extension_constructor" (lib/shape.ml[526,17692+15]..[526,17692+41])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[526,17692+42]..[526,17692+44])
                                  Pexp_ident "id" (lib/shape.ml[526,17692+42]..[526,17692+44])
                            ]
                      ]
                      expression (lib/shape.ml[527,17740+4]..[527,17740+41])
                        Pexp_apply
                        expression (lib/shape.ml[527,17740+4]..[527,17740+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[527,17740+4]..[527,17740+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[527,17740+17]..[527,17740+21])
                              Pexp_ident "item" (lib/shape.ml[527,17740+17]..[527,17740+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[527,17740+22]..[527,17740+39])
                              Pexp_apply
                              expression (lib/shape.ml[527,17740+23]..[527,17740+27])
                                Pexp_ident "proj" (lib/shape.ml[527,17740+23]..[527,17740+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[527,17740+28]..[527,17740+33])
                                    Pexp_ident "shape" (lib/shape.ml[527,17740+28]..[527,17740+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[527,17740+34]..[527,17740+38])
                                    Pexp_ident "item" (lib/shape.ml[527,17740+34]..[527,17740+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[527,17740+40]..[527,17740+41])
                              Pexp_ident "t" (lib/shape.ml[527,17740+40]..[527,17740+41])
                        ]
            ]
          structure_item (lib/shape.ml[529,17783+2]..[529,17783+69])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[529,17783+6]..[529,17783+15])
                  Ppat_var "add_class" (lib/shape.ml[529,17783+6]..[529,17783+15])
                expression (lib/shape.ml[529,17783+16]..[529,17783+69]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[529,17783+16]..[529,17783+17])
                      Nolabel
                      None
                      pattern (lib/shape.ml[529,17783+16]..[529,17783+17])
                        Ppat_var "t" (lib/shape.ml[529,17783+16]..[529,17783+17])
                    Pparam_val (lib/shape.ml[529,17783+18]..[529,17783+20])
                      Nolabel
                      None
                      pattern (lib/shape.ml[529,17783+18]..[529,17783+20])
                        Ppat_var "id" (lib/shape.ml[529,17783+18]..[529,17783+20])
                    Pparam_val (lib/shape.ml[529,17783+21]..[529,17783+24])
                      Nolabel
                      None
                      pattern (lib/shape.ml[529,17783+21]..[529,17783+24])
                        Ppat_var "uid" (lib/shape.ml[529,17783+21]..[529,17783+24])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[529,17783+27]..[529,17783+69])
                      Pexp_apply
                      expression (lib/shape.ml[529,17783+27]..[529,17783+39])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[529,17783+27]..[529,17783+39])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[529,17783+40]..[529,17783+56])
                            Pexp_apply
                            expression (lib/shape.ml[529,17783+41]..[529,17783+52])
                              Pexp_ident "Item.class_" (lib/shape.ml[529,17783+41]..[529,17783+52])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[529,17783+53]..[529,17783+55])
                                  Pexp_ident "id" (lib/shape.ml[529,17783+53]..[529,17783+55])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[529,17783+57]..[529,17783+67])
                            Pexp_apply
                            expression (lib/shape.ml[529,17783+58]..[529,17783+62])
                              Pexp_ident "leaf" (lib/shape.ml[529,17783+58]..[529,17783+62])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[529,17783+63]..[529,17783+66])
                                  Pexp_ident "uid" (lib/shape.ml[529,17783+63]..[529,17783+66])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[529,17783+68]..[529,17783+69])
                            Pexp_ident "t" (lib/shape.ml[529,17783+68]..[529,17783+69])
                      ]
            ]
          structure_item (lib/shape.ml[530,17853+2]..[532,17920+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[530,17853+6]..[530,17853+20])
                  Ppat_var "add_class_proj" (lib/shape.ml[530,17853+6]..[530,17853+20])
                expression (lib/shape.ml[530,17853+21]..[532,17920+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[530,17853+21]..[530,17853+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[530,17853+21]..[530,17853+22])
                        Ppat_var "t" (lib/shape.ml[530,17853+21]..[530,17853+22])
                    Pparam_val (lib/shape.ml[530,17853+23]..[530,17853+25])
                      Nolabel
                      None
                      pattern (lib/shape.ml[530,17853+23]..[530,17853+25])
                        Ppat_var "id" (lib/shape.ml[530,17853+23]..[530,17853+25])
                    Pparam_val (lib/shape.ml[530,17853+26]..[530,17853+31])
                      Nolabel
                      None
                      pattern (lib/shape.ml[530,17853+26]..[530,17853+31])
                        Ppat_var "shape" (lib/shape.ml[530,17853+26]..[530,17853+31])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[531,17887+4]..[532,17920+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[531,17887+8]..[531,17887+12])
                            Ppat_var "item" (lib/shape.ml[531,17887+8]..[531,17887+12])
                          expression (lib/shape.ml[531,17887+15]..[531,17887+29])
                            Pexp_apply
                            expression (lib/shape.ml[531,17887+15]..[531,17887+26])
                              Pexp_ident "Item.class_" (lib/shape.ml[531,17887+15]..[531,17887+26])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[531,17887+27]..[531,17887+29])
                                  Pexp_ident "id" (lib/shape.ml[531,17887+27]..[531,17887+29])
                            ]
                      ]
                      expression (lib/shape.ml[532,17920+4]..[532,17920+41])
                        Pexp_apply
                        expression (lib/shape.ml[532,17920+4]..[532,17920+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[532,17920+4]..[532,17920+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[532,17920+17]..[532,17920+21])
                              Pexp_ident "item" (lib/shape.ml[532,17920+17]..[532,17920+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[532,17920+22]..[532,17920+39])
                              Pexp_apply
                              expression (lib/shape.ml[532,17920+23]..[532,17920+27])
                                Pexp_ident "proj" (lib/shape.ml[532,17920+23]..[532,17920+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[532,17920+28]..[532,17920+33])
                                    Pexp_ident "shape" (lib/shape.ml[532,17920+28]..[532,17920+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[532,17920+34]..[532,17920+38])
                                    Pexp_ident "item" (lib/shape.ml[532,17920+34]..[532,17920+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[532,17920+40]..[532,17920+41])
                              Pexp_ident "t" (lib/shape.ml[532,17920+40]..[532,17920+41])
                        ]
            ]
          structure_item (lib/shape.ml[534,17963+2]..[534,17963+78])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[534,17963+6]..[534,17963+20])
                  Ppat_var "add_class_type" (lib/shape.ml[534,17963+6]..[534,17963+20])
                expression (lib/shape.ml[534,17963+21]..[534,17963+78]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[534,17963+21]..[534,17963+22])
                      Nolabel
                      None
                      pattern (lib/shape.ml[534,17963+21]..[534,17963+22])
                        Ppat_var "t" (lib/shape.ml[534,17963+21]..[534,17963+22])
                    Pparam_val (lib/shape.ml[534,17963+23]..[534,17963+25])
                      Nolabel
                      None
                      pattern (lib/shape.ml[534,17963+23]..[534,17963+25])
                        Ppat_var "id" (lib/shape.ml[534,17963+23]..[534,17963+25])
                    Pparam_val (lib/shape.ml[534,17963+26]..[534,17963+29])
                      Nolabel
                      None
                      pattern (lib/shape.ml[534,17963+26]..[534,17963+29])
                        Ppat_var "uid" (lib/shape.ml[534,17963+26]..[534,17963+29])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[534,17963+32]..[534,17963+78])
                      Pexp_apply
                      expression (lib/shape.ml[534,17963+32]..[534,17963+44])
                        Pexp_ident "Item.Map.add" (lib/shape.ml[534,17963+32]..[534,17963+44])
                      [
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[534,17963+45]..[534,17963+65])
                            Pexp_apply
                            expression (lib/shape.ml[534,17963+46]..[534,17963+61])
                              Pexp_ident "Item.class_type" (lib/shape.ml[534,17963+46]..[534,17963+61])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[534,17963+62]..[534,17963+64])
                                  Pexp_ident "id" (lib/shape.ml[534,17963+62]..[534,17963+64])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[534,17963+66]..[534,17963+76])
                            Pexp_apply
                            expression (lib/shape.ml[534,17963+67]..[534,17963+71])
                              Pexp_ident "leaf" (lib/shape.ml[534,17963+67]..[534,17963+71])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[534,17963+72]..[534,17963+75])
                                  Pexp_ident "uid" (lib/shape.ml[534,17963+72]..[534,17963+75])
                            ]
                        <arg>
                        Nolabel
                          expression (lib/shape.ml[534,17963+77]..[534,17963+78])
                            Pexp_ident "t" (lib/shape.ml[534,17963+77]..[534,17963+78])
                      ]
            ]
          structure_item (lib/shape.ml[535,18042+2]..[537,18118+41])
            Pstr_value Nonrec
            [
              <def>
                pattern (lib/shape.ml[535,18042+6]..[535,18042+25])
                  Ppat_var "add_class_type_proj" (lib/shape.ml[535,18042+6]..[535,18042+25])
                expression (lib/shape.ml[535,18042+26]..[537,18118+41]) ghost
                  Pexp_function
                  [
                    Pparam_val (lib/shape.ml[535,18042+26]..[535,18042+27])
                      Nolabel
                      None
                      pattern (lib/shape.ml[535,18042+26]..[535,18042+27])
                        Ppat_var "t" (lib/shape.ml[535,18042+26]..[535,18042+27])
                    Pparam_val (lib/shape.ml[535,18042+28]..[535,18042+30])
                      Nolabel
                      None
                      pattern (lib/shape.ml[535,18042+28]..[535,18042+30])
                        Ppat_var "id" (lib/shape.ml[535,18042+28]..[535,18042+30])
                    Pparam_val (lib/shape.ml[535,18042+31]..[535,18042+36])
                      Nolabel
                      None
                      pattern (lib/shape.ml[535,18042+31]..[535,18042+36])
                        Ppat_var "shape" (lib/shape.ml[535,18042+31]..[535,18042+36])
                  ]
                  None
                  Pfunction_body
                    expression (lib/shape.ml[536,18081+4]..[537,18118+41])
                      Pexp_let Nonrec
                      [
                        <def>
                          pattern (lib/shape.ml[536,18081+8]..[536,18081+12])
                            Ppat_var "item" (lib/shape.ml[536,18081+8]..[536,18081+12])
                          expression (lib/shape.ml[536,18081+15]..[536,18081+33])
                            Pexp_apply
                            expression (lib/shape.ml[536,18081+15]..[536,18081+30])
                              Pexp_ident "Item.class_type" (lib/shape.ml[536,18081+15]..[536,18081+30])
                            [
                              <arg>
                              Nolabel
                                expression (lib/shape.ml[536,18081+31]..[536,18081+33])
                                  Pexp_ident "id" (lib/shape.ml[536,18081+31]..[536,18081+33])
                            ]
                      ]
                      expression (lib/shape.ml[537,18118+4]..[537,18118+41])
                        Pexp_apply
                        expression (lib/shape.ml[537,18118+4]..[537,18118+16])
                          Pexp_ident "Item.Map.add" (lib/shape.ml[537,18118+4]..[537,18118+16])
                        [
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[537,18118+17]..[537,18118+21])
                              Pexp_ident "item" (lib/shape.ml[537,18118+17]..[537,18118+21])
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[537,18118+22]..[537,18118+39])
                              Pexp_apply
                              expression (lib/shape.ml[537,18118+23]..[537,18118+27])
                                Pexp_ident "proj" (lib/shape.ml[537,18118+23]..[537,18118+27])
                              [
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[537,18118+28]..[537,18118+33])
                                    Pexp_ident "shape" (lib/shape.ml[537,18118+28]..[537,18118+33])
                                <arg>
                                Nolabel
                                  expression (lib/shape.ml[537,18118+34]..[537,18118+38])
                                    Pexp_ident "item" (lib/shape.ml[537,18118+34]..[537,18118+38])
                              ]
                          <arg>
                          Nolabel
                            expression (lib/shape.ml[537,18118+40]..[537,18118+41])
                              Pexp_ident "t" (lib/shape.ml[537,18118+40]..[537,18118+41])
                        ]
            ]
        ]
]

module Uid =
  struct
    type t =
      | Compilation_unit of string 
      | Item of {
      comp_unit: string ;
      id: int } 
      | Internal 
      | Predef of string 
    let id = ref (-1)
    let reinit () = id := (-1)
    let mk ~current_unit =
      incr id; Item { comp_unit = current_unit; id = (!id) }
    let of_compilation_unit_id id =
      if not (Ident.persistent id)
      then
        Misc.fatal_errorf "Types.Uid.of_compilation_unit_id %S"
          (Ident.name id);
      Compilation_unit (Ident.name id)
    let of_predef_id id =
      if not (Ident.is_predef id)
      then Misc.fatal_errorf "Types.Uid.of_predef_id %S" (Ident.name id);
      Predef (Ident.name id)
    let internal_not_actually_unique = Internal
    let for_actual_declaration = function | Item _ -> true | _ -> false
  end
module Sig_component_kind =
  struct
    type t =
      | Value 
      | Type 
      | Module 
      | Module_type 
      | Extension_constructor 
      | Class 
      | Class_type 
    let to_string =
      function
      | Value -> "value"
      | Type -> "type"
      | Module -> "module"
      | Module_type -> "module type"
      | Extension_constructor -> "extension constructor"
      | Class -> "class"
      | Class_type -> "class type"
    let can_appear_in_types =
      function
      | Value | Extension_constructor -> false
      | Type | Module | Module_type | Class | Class_type -> true
  end
module Item =
  struct
    module T =
      struct
        type t = (string * Sig_component_kind.t)
        let compare = compare
        let make str ns = (str, ns)
        let value id = ((Ident.name id), Sig_component_kind.Value)
        let type_ id = ((Ident.name id), Sig_component_kind.Type)
        let module_ id = ((Ident.name id), Sig_component_kind.Module)
        let module_type id =
          ((Ident.name id), Sig_component_kind.Module_type)
        let extension_constructor id =
          ((Ident.name id), Sig_component_kind.Extension_constructor)
        let class_ id = ((Ident.name id), Sig_component_kind.Class)
        let class_type id = ((Ident.name id), Sig_component_kind.Class_type)
        let print fmt (name, ns) =
          Format.fprintf fmt "%S[%s]" name (Sig_component_kind.to_string ns)
      end
    include T
    module Map = (Map.Make)(T)
  end
type var = Ident.t
type t = {
  uid: Uid.t option ;
  desc: desc }
and desc =
  | Var of var 
  | Abs of var * t 
  | App of t * t 
  | Struct of t Item.Map.t 
  | Leaf 
  | Proj of t * Item.t 
  | Comp_unit of string 
let print fmt =
  let print_uid_opt =
    Format.pp_print_option (fun fmt -> Format.fprintf fmt "<%a>" Uid.print) in
  let rec aux fmt { uid; desc } =
    match desc with
    | Var id -> Format.fprintf fmt "%a%a" Ident.print id print_uid_opt uid
    | Abs (id, t) ->
        let rec collect_idents =
          function
          | { uid = None; desc = Abs (id, t) } ->
              let (ids, body) = collect_idents t in ((id :: ids), body)
          | body -> ([], body) in
        let (other_idents, body) = collect_idents t in
        let pp_idents fmt idents =
          let pp_sep fmt () = Format.fprintf fmt ",@ " in
          Format.pp_print_list ~pp_sep Ident.print fmt idents in
        Format.fprintf fmt "Abs@[%a@,(@[%a,@ @[%a@]@])@]" print_uid_opt uid
          pp_idents (id :: other_idents) aux body
    | App (t1, t2) ->
        Format.fprintf fmt "@[%a(@,%a)%a@]" aux t1 aux t2 print_uid_opt uid
    | Leaf ->
        Format.fprintf fmt "<%a>" (Format.pp_print_option Uid.print) uid
    | Proj (t, item) ->
        (match uid with
         | None -> Format.fprintf fmt "@[%a@ .@ %a@]" aux t Item.print item
         | Some uid ->
             Format.fprintf fmt "@[(%a@ .@ %a)<%a>@]" aux t Item.print item
               Uid.print uid)
    | Comp_unit name -> Format.fprintf fmt "CU %s" name
    | Struct map ->
        let print_map fmt =
          Item.Map.iter
            (fun item t ->
               Format.fprintf fmt "@[<hv 2>%a ->@ %a;@]@," Item.print item
                 aux t) in
        Format.fprintf fmt "{@[<v>%a@,%a@]}" print_uid_opt uid print_map map in
  Format.fprintf fmt "@[%a@]@;" aux
let fresh_var ?(name= "shape-var") uid =
  let var = Ident.create_local name in
  (var, { uid = (Some uid); desc = (Var var) })
let for_unnamed_functor_param = Ident.create_local "()"
let var uid id = { uid = (Some uid); desc = (Var id) }
let abs ?uid var body = { uid; desc = (Abs (var, body)) }
let str ?uid map = { uid; desc = (Struct map) }
let leaf uid = { uid = (Some uid); desc = Leaf }
let proj ?uid t item =
  match t.desc with
  | Leaf -> t
  | Struct map -> (try Item.Map.find item map with | Not_found -> t)
  | _ -> { uid; desc = (Proj (t, item)) }
let app ?uid f ~arg = { uid; desc = (App (f, arg)) }
let decompose_abs t =
  match t.desc with | Abs (x, t) -> Some (x, t) | _ -> None
module Make_reduce(Params:sig
                            type env
                            val fuel : int
                            val read_unit_shape :
                              unit_name:string -> t option
                            val find_shape : env -> Ident.t -> t
                          end) =
  struct
    type nf = {
      uid: Uid.t option ;
      desc: nf_desc }
    and nf_desc =
      | NVar of var 
      | NApp of nf * nf 
      | NAbs of local_env * var * t * delayed_nf 
      | NStruct of delayed_nf Item.Map.t 
      | NProj of nf * Item.t 
      | NLeaf 
      | NComp_unit of string 
      | NoFuelLeft of desc 
    and delayed_nf =
      | Thunk of local_env * t 
    and local_env = delayed_nf option Ident.Map.t
    let improve_uid uid (nf : nf) =
      match nf.uid with | Some _ -> nf | None -> { nf with uid }
    let in_memo_table memo_table memo_key f arg =
      match Hashtbl.find memo_table memo_key with
      | res -> res
      | exception Not_found ->
          let res = f arg in (Hashtbl.replace memo_table memo_key res; res)
    type env =
      {
      fuel: int ref ;
      global_env: Params.env ;
      local_env: local_env ;
      reduce_memo_table: ((local_env * t), nf) Hashtbl.t ;
      read_back_memo_table: (nf, t) Hashtbl.t }
    let bind env var shape =
      { env with local_env = (Ident.Map.add var shape env.local_env) }
    let rec reduce_ env t =
      let memo_key = ((env.local_env), t) in
      in_memo_table env.reduce_memo_table memo_key (reduce__ env) t
    and reduce__ ({ fuel; global_env; local_env;_} as env) (t : t) =
      let reduce env t = reduce_ env t in
      let delay_reduce env t = Thunk ((env.local_env), t) in
      let force (Thunk (local_env, t)) = reduce { env with local_env } t in
      let return desc : nf= { uid = (t.uid); desc } in
      if (!fuel) < 0
      then return (NoFuelLeft (t.desc))
      else
        (match t.desc with
         | Comp_unit unit_name ->
             (match Params.read_unit_shape ~unit_name with
              | Some t -> reduce env t
              | None -> return (NComp_unit unit_name))
         | App (f, arg) ->
             let f = reduce env f in
             (match f.desc with
              | NAbs (clos_env, var, body, _body_nf) ->
                  let arg = delay_reduce env arg in
                  let env =
                    bind { env with local_env = clos_env } var (Some arg) in
                  (reduce env body) |> (improve_uid t.uid)
              | _ -> let arg = reduce env arg in return (NApp (f, arg)))
         | Proj (str, item) ->
             let str = reduce env str in
             let nored () = return (NProj (str, item)) in
             (match str.desc with
              | NStruct items ->
                  (match Item.Map.find item items with
                   | exception Not_found -> nored ()
                   | nf -> (force nf) |> (improve_uid t.uid))
              | _ -> nored ())
         | Abs (var, body) ->
             let body_nf = delay_reduce (bind env var None) body in
             return (NAbs (local_env, var, body, body_nf))
         | Var id ->
             (match Ident.Map.find id local_env with
              | None -> return (NVar id)
              | Some def -> force def
              | exception Not_found ->
                  (match Params.find_shape global_env id with
                   | exception Not_found -> return (NVar id)
                   | res when res = t -> return (NVar id)
                   | res -> (decr fuel; reduce env res)))
         | Leaf -> return NLeaf
         | Struct m ->
             let mnf = Item.Map.map (delay_reduce env) m in
             return (NStruct mnf))
    let rec read_back env (nf : nf) : t=
      in_memo_table env.read_back_memo_table nf (read_back_ env) nf
    and read_back_ env (nf : nf) : t=
      { uid = (nf.uid); desc = (read_back_desc env nf.desc) }
    and read_back_desc env desc =
      let read_back nf = read_back env nf in
      let read_back_force (Thunk (local_env, t)) =
        read_back (reduce_ { env with local_env } t) in
      match desc with
      | NVar v -> Var v
      | NApp (nft, nfu) -> App ((read_back nft), (read_back nfu))
      | NAbs (_env, x, _t, nf) -> Abs (x, (read_back_force nf))
      | NStruct nstr -> Struct (Item.Map.map read_back_force nstr)
      | NProj (nf, item) -> Proj ((read_back nf), item)
      | NLeaf -> Leaf
      | NComp_unit s -> Comp_unit s
      | NoFuelLeft t -> t
    let reduce global_env t =
      let fuel = ref Params.fuel in
      let reduce_memo_table = Hashtbl.create 42 in
      let read_back_memo_table = Hashtbl.create 42 in
      let local_env = Ident.Map.empty in
      let env =
        {
          fuel;
          global_env;
          reduce_memo_table;
          read_back_memo_table;
          local_env
        } in
      (reduce_ env t) |> (read_back env)
  end
module Local_reduce =
  (Make_reduce)(struct
                  type env = unit
                  let fuel = 10
                  let read_unit_shape ~unit_name:_ = None
                  let find_shape _env _id = raise Not_found
                end)
let local_reduce shape = Local_reduce.reduce () shape
let dummy_mod = { uid = None; desc = (Struct Item.Map.empty) }
let of_path ~find_shape ~namespace =
  let rec aux : Sig_component_kind.t -> Path.t -> t =
    fun ns ->
      function
      | Pident id -> find_shape ns id
      | Pdot (path, name) -> proj (aux Module path) (name, ns)
      | Papply (p1, p2) -> app (aux Module p1) ~arg:(aux Module p2)
      | Pextra_ty (path, extra) ->
          (match extra with
           | Pcstr_ty _ -> aux Type path
           | Pext_ty -> aux Extension_constructor path) in
  aux namespace
let for_persistent_unit s =
  {
    uid = (Some (Uid.of_compilation_unit_id (Ident.create_persistent s)));
    desc = (Comp_unit s)
  }
let leaf_for_unpack = { uid = None; desc = Leaf }
let set_uid_if_none t uid =
  match t.uid with | None -> { t with uid = (Some uid) } | _ -> t
module Map =
  struct
    type shape = t
    type nonrec t = t Item.Map.t
    let empty = Item.Map.empty
    let add t item shape = Item.Map.add item shape t
    let add_value t id uid = Item.Map.add (Item.value id) (leaf uid) t
    let add_value_proj t id shape =
      let item = Item.value id in Item.Map.add item (proj shape item) t
    let add_type t id uid = Item.Map.add (Item.type_ id) (leaf uid) t
    let add_type_proj t id shape =
      let item = Item.type_ id in Item.Map.add item (proj shape item) t
    let add_module t id shape = Item.Map.add (Item.module_ id) shape t
    let add_module_proj t id shape =
      let item = Item.module_ id in Item.Map.add item (proj shape item) t
    let add_module_type t id uid =
      Item.Map.add (Item.module_type id) (leaf uid) t
    let add_module_type_proj t id shape =
      let item = Item.module_type id in Item.Map.add item (proj shape item) t
    let add_extcons t id uid =
      Item.Map.add (Item.extension_constructor id) (leaf uid) t
    let add_extcons_proj t id shape =
      let item = Item.extension_constructor id in
      Item.Map.add item (proj shape item) t
    let add_class t id uid = Item.Map.add (Item.class_ id) (leaf uid) t
    let add_class_proj t id shape =
      let item = Item.class_ id in Item.Map.add item (proj shape item) t
    let add_class_type t id uid =
      Item.Map.add (Item.class_type id) (leaf uid) t
    let add_class_type_proj t id shape =
      let item = Item.class_type id in Item.Map.add item (proj shape item) t
  end
